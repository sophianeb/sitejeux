if (undefined === window.Kameleoon){Kameleoon={processOmniture:function(a){Kameleoon.API.processOmniture(a)}};Kameleoon.API={load:function(){Kameleoon.Analyst.load()},runWhenElementPresent:function(a,c,g,b){if(typeof g==="undefined"){g=true}var d=Kameleoon.Utils.querySelectorAll(a);if(!Kameleoon.Internals.runtime.querySelectorAllHasError){if(0<d.length){Kameleoon.Utils.runProtectedFunction(function(){c(d)})}else{if(!Kameleoon.Internals.runtime.pageLoaded){if(Kameleoon.Internals.runtime.cantUseMutationObserver||!g){var f=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(f);Kameleoon.API.runWhenElementPresent.apply(Kameleoon,[a,c,g,b])},b?b:250)}else{var e={};e.selector=a;e.targetFunction=c;e.useAntiFlicker=g;Kameleoon.Internals.runtime.waitingElementPresentObjects.push(e)}}}}},runWhenConditionTrue:function(b,c,a){if(b()){Kameleoon.Utils.runProtectedFunction(c)}else{if(!Kameleoon.Internals.runtime.pageLoaded){var d=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(d);Kameleoon.API.runWhenConditionTrue.apply(Kameleoon,[b,c,a])},a?a:200)}}},processRedirect:function(c,b){if(window.location.href!=c){if(Kameleoon.Internals.configuration.googleAnalytics&&Kameleoon.Internals.runtime.gathererRun&&(1==Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length)){c=Kameleoon.Utils.addParameterToURL(c,"utm_referrer="+encodeURIComponent(document.referrer),Kameleoon.Internals.configuration.googleAnalyticsAllowAnchor)}if(Kameleoon.Internals.configuration.adobeOmniture&&Kameleoon.Internals.configuration.adobeOmniture.anchorReferrer&&Kameleoon.Internals.runtime.gathererRun&&(1==Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length)){c=Kameleoon.Utils.addParameterToURL(c,"sc_referrer="+encodeURIComponent(document.referrer),true)}if(b){c=Kameleoon.Utils.addParameterToURL(c,"kameleoonAVTE-"+Kameleoon.API.currentContainer.id+"="+Kameleoon.API.currentContainer.registeredVariation.id,true);c=Kameleoon.Utils.addParameterToURL(c,"kameleoonRedirect-"+Kameleoon.API.currentContainer.id+"="+Kameleoon.API.currentContainer.registeredVariationId,true)}var a=Kameleoon.Internals.runtime.parameters;if(a.kameleoonHeatMap){c+=(c.indexOf("?")==-1)?"?":"&";c+="kameleoonHeatMap="+a.kameleoonHeatMap;c+="&kameleoonProgressiveLoading="+a.kameleoonProgressiveLoading;c+="&kameleoonExperimentId="+a.kameleoonExperimentId;c+="&kameleoonPageWidth="+a.kameleoonPageWidth;c+="&kameleoonAccountLocale="+a.kameleoonAccountLocale;c+="&kameleoonVariationId="+a.kameleoonVariationId;c+="&kameleoonHeatMapRedirect=true"}if(window.location.href!=c&&!a.kameleoonHeatMapRedirect){Kameleoon.Utils.createLocalData("kameleoonRedirect-"+Kameleoon.API.currentContainer.id,Kameleoon.API.currentContainer.registeredVariationId,1,null,null,false,null,true);Kameleoon.API.forceNoFlicker("*");Kameleoon.Internals.runtime.Analyst.applyRedirect=true;window.location.replace(c)}}},triggerEvent:function(a){Kameleoon.API.runWhenConditionTrue(function(){return Kameleoon.Internals.runtime.setupAfterLocalDataRetrieval===true},function(){Kameleoon.API.events.push(a);Kameleoon.Analyst.processAllContainers();Kameleoon.Analyst.processAllTargetingSegments();if(Kameleoon.Internals.runtime.simulationMode){Kameleoon.Loader.enableSimulationPanel()}},100)},processConversion:function(b,c,a){this.processConversions(b,c,false,a)},cancelConversion:function(b,c,a){this.processConversions(b,c,true,a)},processConversions:function(f,a,c,h){for(var g=0,b=Kameleoon.Internals.configuration.goals.length;g<b;++g){var k=Kameleoon.Internals.configuration.goals[g];if((f==k.id)||(f==k.name)){var d=[];if(null==h){d.push({goal:k,revenue:a,negative:c})}if(!k.linkedExperimentId){for(var e=0;e<b;++e){var m=Kameleoon.Internals.configuration.goals[e];if(null!=m.linkedExperimentId&&((null==h&&m.masterGoalId==k.id)||(null!=h&&(m.linkedExperimentId==h||Kameleoon.Analyst.findExperiment(m.linkedExperimentId).name==h)))){d.push({goal:m,revenue:a,negative:c})}}}Kameleoon.Analyst.processConversions(d);break}}},processOmniture:function(a){},forceNoFlicker:function(c){var b=document.createElement("style");b.setAttribute("id","kameleoonPageLoading");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("media","screen");var a=c+" { visibility: hidden !important; background-image: none !important; }";if(b.styleSheet){b.styleSheet.cssText=a}else{b.appendChild(document.createTextNode(a))}Kameleoon.Internals.runtime.headNode.appendChild(b)},refresh:function(){Kameleoon.Analyst.refreshForScreenResize()},loadScriptSequentially:function(b){if(b){var a=document.createElement("script");a.src=b;a.setAttribute("onload","Kameleoon.API.loadScriptSequentially();");Kameleoon.Internals.runtime.waitingScripts.push(a);if(1==Kameleoon.Internals.runtime.waitingScripts.length){Kameleoon.Internals.runtime.headNode.appendChild(Kameleoon.Internals.runtime.waitingScripts[0])}}else{Kameleoon.Internals.runtime.waitingScripts.shift();if(0<Kameleoon.Internals.runtime.waitingScripts.length){Kameleoon.Internals.runtime.headNode.appendChild(Kameleoon.Internals.runtime.waitingScripts[0])}}},processPageLoaded:function(){Kameleoon.Internals.runtime.pageLoaded=true;Kameleoon.Utils.removeBlockingStyleSheet();for(var b=0,a=Kameleoon.Internals.runtime.variations.length;b<a;++b){if(Kameleoon.Internals.runtime["enginePollerForVariation"+Kameleoon.Internals.runtime.variations[b].id]){window.clearInterval(Kameleoon.Internals.runtime["enginePollerForVariation"+Kameleoon.Internals.runtime.variations[b].id]);Kameleoon.Internals.runtime["enginePollerForVariation"+Kameleoon.Internals.runtime.variations[b].id]=null}}},setCustomData:function(d,g,f){if(Kameleoon.Internals.runtime.gathererRun){var c=null;for(var e=0,b=Kameleoon.Internals.runtime.Gatherer.configuration.customData.length;e<b;++e){var a=Kameleoon.Internals.runtime.Gatherer.configuration.customData[e];if((a!=null)&&(a.name==d)){c=e;break}}if(c!=null){if(f==null){f=false}Kameleoon.Gatherer.trackCustomData([c],[g],[f])}}},registerProductPage:function(h,p,c,i){if(h!=null&&h.length>0){var a=p,g=null,m=null,f=null,e=null,d=null,k=null,o=null,j=null,n=null;if(null!=p&&"object"==typeof p){a=p.name;g=p.categoryId;c=p.category;m=p.pictureHref;i=p.price;f=p.available;e=p.brand;d=p.child;k=p.gender;o=p.sizes;j=p.type;n=p.feature}i=parseFloat(i);if(isNaN(i)){i=null}if((!Kameleoon.Internals.runtime.simulationMode)&&(!Kameleoon.Internals.runtime.proxyMode)){Kameleoon.Analyst.validateTrackingRequest(function(){var q=k=="m"||k=="M"?true:k=="f"||k=="F"?false:null;Kameleoon.Utils.performBeaconServerCall(Kameleoon.Analyst.obtainProductTrackingRequestPrefix(h.toString())+"event=productPage&siteCode="+Kameleoon.Internals.configuration.siteCode+"&ean="+encodeURIComponent(h.toString())+(a==null?"":"&name="+encodeURIComponent(a.toString()))+(g==null?"":"&categoryId="+encodeURIComponent(g.toString()))+(c==null?"":"&category="+encodeURIComponent(c.toString()))+"&href="+encodeURIComponent(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())+(m==null?"":"&pictureHref="+encodeURIComponent(m.toString()))+(i==null?"":"&price="+i)+(f==null?"":"&available="+f)+(e==null?"":"&brand="+e)+(d==null?"":"&child="+d)+(q==null?"":"&male="+q)+(o==null?"":"&sizes="+encodeURIComponent(JSON.stringify(o)))+(j==null?"":"&type="+j)+(n==null?"":"&feature="+n),null,null)}.bind(this))}if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackProduct(h)}if(Kameleoon.Internals.configuration.useRees46&&null!=window.r46){r46("track","view",h)}Kameleoon.Internals.runtime.product={ean:h,name:a,categoryId:g,category:c,pictureHref:m,price:i,available:f,brand:e,child:d,gender:k,sizes:o,type:j,feature:n};Kameleoon.API.currentProduct=Kameleoon.Utils.clone(Kameleoon.Internals.runtime.product);if(Kameleoon.Internals.configuration.fetchProductCompetitorPrices){var b=function(r){var q=Kameleoon.Utils.JSONParse(r);Kameleoon.Internals.runtime.product.competitorPrices=q;Kameleoon.API.currentProduct.competitorPrices=q}.bind(this);var l=sessionStorage.getItem("kameleoonProductCompetitorPrices_"+h);if(l==null){Kameleoon.Utils.performBeaconServerCall("//api-product."+Kameleoon.Internals.configuration.DOMAIN+"/productCompetitorPrices?siteCode="+Kameleoon.Internals.configuration.siteCode+"&ean="+encodeURIComponent(h),function(){if((this.readyState==4)&&(this.status==200)){l=this.responseText;sessionStorage.setItem("kameleoonProductCompetitorPrices_"+h,l);b(l)}},null)}else{b(l)}}}},registerProductAddToCart:function(b,a){if(b!=null&&b.length>0){a=parseInt(a);if(isNaN(a)){a=0}if(a>0){if((!Kameleoon.Internals.runtime.simulationMode)&&(!Kameleoon.Internals.runtime.proxyMode)){Kameleoon.Analyst.validateTrackingRequest(function(){Kameleoon.Utils.performBeaconServerCall(Kameleoon.Analyst.obtainProductTrackingRequestPrefix(b.toString())+"event=productAddToCart&siteCode="+Kameleoon.Internals.configuration.siteCode+"&ean="+encodeURIComponent(b.toString())+"&quantity="+a,null,null);if(Kameleoon.Internals.configuration.useRees46&&null!=window.r46){r46("track","cart",{id:b,amount:a})}}.bind(this))}}}},registerProductBuy:function(b,a){if(b!=null&&b.length>0){a=parseInt(a);if(isNaN(a)){a=0}if(a>0){if((!Kameleoon.Internals.runtime.simulationMode)&&(!Kameleoon.Internals.runtime.proxyMode)){Kameleoon.Analyst.validateTrackingRequest(function(){Kameleoon.Utils.performBeaconServerCall(Kameleoon.Analyst.obtainProductTrackingRequestPrefix(b.toString())+"event=productBuy&siteCode="+Kameleoon.Internals.configuration.siteCode+"&ean="+encodeURIComponent(b.toString())+"&quantity="+a,null,null)}.bind(this))}}}},registerProductsBuy:function(d){var c=[];for(var a=0;a<d.length;++a){var b=d[a];c.push({id:b.ean,amount:b.quantity});this.registerProductBuy(b.ean,b.quantity)}if(Kameleoon.Internals.configuration.useRees46&&null!=window.r46){r46("track","purchase",{products:c})}},registerProductCategory:function(a){if(Kameleoon.Internals.configuration.useRees46&&null!=window.r46){r46("track","category",a)}},registerRemoveProductCart:function(b,a){if(Kameleoon.Internals.configuration.useRees46&&null!=window.r46){r46("track","remove_from_cart",{id:b,amount:a})}},getMetrics:function(a,c){if(Kameleoon.Internals.runtime.gathererRun){switch(a){case"pages":return Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length;case"time":var b=new Date().getTime()-Kameleoon.Internals.runtime.Visitor.currentVisit.timeStarted;if("s"==c){return Math.floor(b/1000)}return b;default:return null}}return null},retrieveData:function(a,b){Kameleoon.Utils.performBeaconServerCall("//api-data."+Kameleoon.Internals.configuration.DOMAIN+"/data?siteCode="+Kameleoon.Internals.configuration.siteCode+"&key="+a,function(){if(this.readyState==4){var c={};if(this.status==200){c=Kameleoon.Utils.JSONParse(this.responseText)}b&&b(c)}},null)},getRecommendedProducts:function(b,c,d,a){if(null!=window.r46){r46("recommend",b,c,d,a)}}};Kameleoon.Analyst={CODE_ALPHABET:"abcdefghijklmnopqrstuvwxyz0123456789",load:function(){if(null!=window.kameleoonFetchInternalsURL){Kameleoon.Utils.performBeaconServerCall(window.kameleoonFetchInternalsURL,function(){if((this.readyState==4)&&(this.status==200)){eval(this.responseText);window.kameleoonFetchInternalsURL=null;Kameleoon.Analyst.load()}});return}var currentTime=new Date().getTime();if(Kameleoon.Internals.runtime!=null){if(Kameleoon.Internals.runtime.eventListeners!=null){for(var i=0,l=Kameleoon.Internals.runtime.eventListeners.length;i<l;++i){var eventListener=Kameleoon.Internals.runtime.eventListeners[i];eventListener.element.removeEventListener(eventListener.eventType,eventListener.actionFunction,eventListener.useCapture)}}if(Kameleoon.Internals.runtime.timeoutIds!=null){for(var timeoutId in Kameleoon.Internals.runtime.timeoutIds){Kameleoon.Utils.clearTimeout(timeoutId)}}if(Kameleoon.Internals.runtime.intervalIds!=null){for(var intervalId in Kameleoon.Internals.runtime.intervalIds){Kameleoon.Utils.clearInterval(intervalId)}}if(Kameleoon.Internals.runtime.mutationObserver!=null){Kameleoon.Internals.runtime.mutationObserver.disconnect()}if(Kameleoon.Internals.runtime.Analyst!=null){if((Kameleoon.Internals.runtime.Analyst.targetingPanel!=null)&&(Kameleoon.Internals.runtime.Analyst.targetingPanel.parentNode!=null)){Kameleoon.Internals.runtime.Analyst.targetingPanel.parentNode.removeChild(Kameleoon.Internals.runtime.Analyst.targetingPanel)}if((Kameleoon.Internals.runtime.Analyst.targetingPanelHideButton!=null)&&(Kameleoon.Internals.runtime.Analyst.targetingPanelHideButton.parentNode!=null)){Kameleoon.Internals.runtime.Analyst.targetingPanelHideButton.parentNode.removeChild(Kameleoon.Internals.runtime.Analyst.targetingPanelHideButton)}if((Kameleoon.Internals.runtime.Analyst.targetingPanelShowButton!=null)&&(Kameleoon.Internals.runtime.Analyst.targetingPanelShowButton.parentNode!=null)){Kameleoon.Internals.runtime.Analyst.targetingPanelShowButton.parentNode.removeChild(Kameleoon.Internals.runtime.Analyst.targetingPanelShowButton)}}}var kameleoonInternalsConfigurationSave=Kameleoon.Internals.configuration;Kameleoon.Internals={};Object.defineProperty(Kameleoon.Internals,"runtime",{enumerable:true,get:function(){return runtime},set:function(value){if(Kameleoon.Internals.configuration==null){runtime=value}}});Kameleoon.Internals.runtime={};Kameleoon.Internals.runtime.loadTime=currentTime;Kameleoon.Internals.configuration=kameleoonInternalsConfigurationSave;Kameleoon.API.pageCallbacks=null;Kameleoon.API.activityCallbacks=null;Kameleoon.API.interestsCallbacks=null;Kameleoon.API.searchCallbacks=null;Kameleoon.API.conversionCallbacks=null;Kameleoon.API.mentalistActionCallbacks=null;Kameleoon.API.targetingSegmentCallbacks=null;Kameleoon.API.experimentCallbacks=null;Kameleoon.API.personalizationCallbacks=null;Kameleoon.API.weatherCallbacks=null;Kameleoon.API.customDatumCallbacks=null;Kameleoon.API.tabCountCallbacks=null;Kameleoon.API.productCallbacks=null;Kameleoon.API.geolocationCallbacks=null;Kameleoon.API.numberClicksCallbacks=null;Kameleoon.API.adBlockerCallbacks=null;Kameleoon.API.ipCallbacks=null;Kameleoon.API.externalSolutionDataCallbacks=null;Kameleoon.API.mentalistPredictionTargetingCallbacks=null;Kameleoon.API.startOfVisitCallbacks=null;var elements;elements=Kameleoon.Utils.querySelectorAll("[id^=kameleoonElement]");for(var i=0,l=elements.length;i<l;++i){var element=elements[i];element.parentNode.removeChild(element)}elements=Kameleoon.Utils.querySelectorAll("[id^=kameleoonScenarioLayerBase]");for(var i=0,l=elements.length;i<l;++i){var element=elements[i];element.parentNode.removeChild(element)}elements=Kameleoon.Utils.querySelectorAll("[id^=kameleoonStyleSheet]");for(var i=0,l=elements.length;i<l;++i){var element=elements[i];element.parentNode.removeChild(element)}elements=Kameleoon.Utils.querySelectorAll("[id^=kameleoonId]");for(var i=0,l=elements.length;i<l;++i){var element=elements[i];element.removeAttribute("id")}elements=Kameleoon.Utils.querySelectorAll("[class^=kameleoonClass]");for(var i=0,l=elements.length;i<l;++i){var element=elements[i];element.removeAttribute("class")}var variationSelectionPopup=document.getElementById("kameleoonVariationSelectionPopup");if(variationSelectionPopup!=null){variationSelectionPopup.parentNode.removeChild(variationSelectionPopup)}Kameleoon.Utils.domReady(function(){Kameleoon.Internals.runtime.domReady=true});if(false==window.kameleoonLightIframe){Kameleoon.Internals.configuration.useWideDomainSupport=false;if(window.kameleoonIframeURL){Kameleoon.Utils.setTimeout(function(){var iframeNode=document.createElement("iframe");iframeNode.src=window.kameleoonIframeURL;iframeNode.id="kameleoonExternalIframe";iframeNode.style="float: left !important; opacity: 0.0 !important; width: 0px !important; height: 0px !important;";iframeNode.onload=function(){iframeNode.parentNode.removeChild(iframeNode)};document.head.appendChild(iframeNode)},5000)}}if(!Kameleoon.Internals.configuration.useWideDomainSupport){try{if(window.localStorage){localStorage.setItem("kameleoonPrivateMode","false");localStorage.removeItem("kameleoonPrivateMode")}else{Kameleoon.Internals.runtime.noLocalStorage=true}}catch(e){Kameleoon.Internals.runtime.noLocalStorage=true}}try{var cookieEnabled;Kameleoon.Utils.createLocalData("kameleoonTestCookie","test",null,"CURRENT_HOST","COOKIE",false,null,true);if(Kameleoon.Utils.readLocalData("kameleoonTestCookie","COOKIE",false)!="test"){cookieEnabled=false}else{cookieEnabled=true;Kameleoon.Utils.eraseLocalData("kameleoonTestCookie","CURRENT_HOST","COOKIE")}if(!cookieEnabled){Kameleoon.Internals.runtime.noCookie=true}}catch(e){Kameleoon.Internals.runtime.noCookie=true}if(window.kameleoonDisplayPage){if(null==Kameleoon.Internals.configuration.behaviorWhenTimeout||document.getElementById("kameleoonLoadingStyleSheet")){window.clearTimeout(window.kameleoonDisplayPageTimeOut)}else{if(!Kameleoon.Internals.runtime.noLocalStorage&&null==window.kameleoonEndLoadTime){switch(Kameleoon.Internals.configuration.behaviorWhenTimeout){case"VISIT":sessionStorage.setItem("kameleoonDisableForVisit","true");break;case"PAGE":Kameleoon.Internals.runtime.kameleoonDisableForPage=true;break}}}try{window.kameleoonDisplayPage(true)}catch(e){}}Kameleoon.Utils.addEventListener(window,"message",Kameleoon.Utils.processMessageEvent,false);if(navigator.userAgent.indexOf("Chrome/62")!=-1){var currentScroll={x:window.scrollX,y:window.scrollY};document.documentElement.style.display="none";var fixVisibility=document.documentElement.offsetHeight;document.documentElement.style.display="block";window.scrollTo(currentScroll.x,currentScroll.y)}if(Kameleoon.Internals.runtime.noLocalStorage||Kameleoon.Internals.runtime.noCookie||sessionStorage.getItem("kameleoonDisableForVisit")||Kameleoon.Internals.runtime.kameleoonDisableForPage){return}this.setupKameleoon()},setupKameleoon:function(){if(Kameleoon.Internals.configuration.variations!=null){Kameleoon.Internals.runtime.variations=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.variations)}if(Kameleoon.Internals.configuration.experiments!=null){Kameleoon.Internals.runtime.experiments=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.experiments)}if(Kameleoon.Internals.configuration.personalizations!=null){Kameleoon.Internals.runtime.personalizations=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.personalizations)}if(Kameleoon.Internals.configuration.targetingSegments!=null){Kameleoon.Internals.runtime.targetingSegments=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.targetingSegments)}Kameleoon.Internals.runtime.addedIDs=[];Kameleoon.Internals.runtime.addedClasses=[];Kameleoon.Internals.runtime.cantUseMutationObserver=(typeof MutationObserver!=="function"||Kameleoon.Internals.configuration.disableDomMutationObserver);if(Kameleoon.Internals.runtime.Analyst==null){Kameleoon.Internals.runtime.Analyst={}}if(Kameleoon.Internals.runtime.requestedVariations==null){Kameleoon.Internals.runtime.requestedVariations={}}Kameleoon.Internals.runtime.mouseDownEvent=("ontouchend" in document.documentElement?"touchend":"mousedown");Kameleoon.Internals.runtime.touchMoveEvent=false;if("touchend"==Kameleoon.Internals.runtime.mouseDownEvent){Kameleoon.Utils.addEventListener(document,"touchmove",function(e){Kameleoon.Internals.runtime.touchMoveEvent=true});Kameleoon.Utils.addEventListener(document,"touchstart",function(e){Kameleoon.Internals.runtime.touchMoveEvent=false})}if((window.kameleoonStartLoadTime!=null)&&(Kameleoon.Internals.configuration.kameleoonByteLength!=null)){if(window.kameleoonEndLoadTime==null){window.kameleoonEndLoadTime=new Date().getTime()}var kameleoonLoadTime=(window.kameleoonEndLoadTime-window.kameleoonStartLoadTime)-25;Kameleoon.Internals.runtime.bandwithBytesPerMillisecond=Kameleoon.Internals.configuration.kameleoonByteLength/kameleoonLoadTime}Kameleoon.Internals.runtime.JS_EDITOR_URL=Kameleoon.Internals.configuration.BASE_EDITOR_URL+"script/editor.js";Kameleoon.Internals.runtime.PAGE_LOADING_POLL_DELAY=75;Kameleoon.Internals.runtime.PAGE_LOADED_POLL_DELAY=250;Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_APPID="c47db1e8ab50752e5f42c72f175b5210";Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_WEATHER_URL="//api.openweathermap.org/data/2.5/weather?APPID="+Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_APPID+"&";Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_WEATHER_FORECAST_URL="//api.openweathermap.org/data/2.5/forecast?APPID="+Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_APPID+"&";Kameleoon.Internals.runtime.deviceType=(bowser.tablet?"TABLET":(bowser.mobile?"PHONE":"DESKTOP"));Kameleoon.Internals.runtime.mobileDevice=(Kameleoon.Internals.runtime.deviceType=="TABLET")||(Kameleoon.Internals.runtime.deviceType=="PHONE");Kameleoon.Internals.runtime.linux=bowser.linux;Kameleoon.Internals.runtime.mac=bowser.mac;Kameleoon.Internals.runtime.windows=bowser.windows;Kameleoon.Internals.runtime.android=bowser.android;Kameleoon.Internals.runtime.ios=bowser.ios;Kameleoon.Internals.runtime.windowsphone=bowser.windowsphone;Kameleoon.Internals.runtime.gecko=bowser.gecko;Kameleoon.Internals.runtime.webkit=bowser.webkit;Kameleoon.Internals.runtime.browserName=(bowser.name==""?null:bowser.name);Kameleoon.Internals.runtime.browserVersion=(bowser.version==""?null:parseFloat(bowser.version));Kameleoon.Internals.runtime.msie=bowser.msie;Kameleoon.Internals.runtime.msedge=bowser.msedge;Kameleoon.Internals.runtime.chrome=bowser.chrome;Kameleoon.Internals.runtime.firefox=bowser.firefox;Kameleoon.Internals.runtime.safari=bowser.safari;Kameleoon.Internals.runtime.opera=bowser.opera;Kameleoon.Internals.runtime.modernMsie=Kameleoon.Internals.runtime.msie&&(Kameleoon.Internals.runtime.browserVersion>=10);Kameleoon.Internals.runtime.unsupportedBrowser=(Kameleoon.Internals.runtime.msie&&(Kameleoon.Internals.runtime.browserVersion<9))||(Kameleoon.Internals.runtime.opera&&(Kameleoon.Internals.runtime.browserVersion<13));if(Kameleoon.Internals.configuration.useWideDomainSupport&&Kameleoon.Internals.runtime.safari){Kameleoon.Internals.configuration.useLocalStorage=false}Kameleoon.Internals.runtime.parameters=Kameleoon.Utils.parseParameters();Kameleoon.Internals.runtime.kameleoonVisibility=document.visibilityState;Kameleoon.Internals.runtime.conversionsEvent=new Kameleoon.Utils.Event();Kameleoon.Internals.runtime.targetingsEvent=new Kameleoon.Utils.Event();Kameleoon.Internals.runtime.memorizedTargetingsEvent=Kameleoon.Internals.runtime.targetingsEvent.memorize();var kameleoonOptout=Kameleoon.Internals.runtime.parameters.kameleoonOptout;if(kameleoonOptout!=null){var optoutValue=parseInt(kameleoonOptout);Kameleoon.Utils.createLocalData("kameleoonOptout",true,isNaN(optoutValue)?45:optoutValue,null,"COOKIE",false,null,true)}if(Kameleoon.Internals.configuration.checkTraffic){if(!Kameleoon.Utils.readLocalData("kameleoonTraffic","COOKIE",false)){var requestPrefix="//tlp-"+this.obtainTrackerNodeCodeDeterministic(Kameleoon.Internals.configuration.siteCode)+"."+Kameleoon.Internals.configuration.DOMAIN+"/counter.gif?";this.validateTrackingRequest(function(){Kameleoon.Utils.performBeaconServerCall(requestPrefix+"siteCode="+Kameleoon.Internals.configuration.siteCode+"&totalTraffic=true")}.bind(this));Kameleoon.Utils.createLocalData("kameleoonTraffic","true",30,null,"COOKIE",false)}}if(this.shouldAbortSetup()){return}if(Kameleoon.Internals.configuration.goals==null){Kameleoon.Internals.configuration.goals=[]}for(var i=0,l=Kameleoon.Internals.configuration.goals.length;i<l;++i){var goal=Kameleoon.Internals.configuration.goals[i];if(!goal.linkedExperimentId){for(var j=0;j<l;++j){var secondaryGoal=Kameleoon.Internals.configuration.goals[j];if(secondaryGoal.linkedExperimentId&&(secondaryGoal.masterGoalId==goal.id)){for(var key in goal){if((key!="id")&&(key!="mentalistInput")&&(key!="mentalistWeight")&&(key!="masterGoalId")&&(key!="masterGoalName")&&(key!="linkedExperimentId")){secondaryGoal[key]=goal[key]}}}}}}if((Kameleoon.Mentalist!=null)&&(!Kameleoon.Mentalist.computeIsSecure())){Kameleoon.Mentalist=null}Kameleoon.Internals.runtime.headNode=document.getElementsByTagName("head")[0];Kameleoon.Internals.runtime.waitingScripts=[];Kameleoon.Internals.runtime.pageElementSets=[];Kameleoon.Internals.runtime.waitingElementPresentObjects=[];Kameleoon.Internals.runtime.editorMode=("true"==Kameleoon.Internals.runtime.parameters.kameleoon);Kameleoon.Internals.runtime.proxyMode=(("proxy."+Kameleoon.Internals.configuration.DOMAIN)===window.location.hostname);Kameleoon.Internals.runtime.disableCache=("true"==Kameleoon.Internals.runtime.parameters.kameleoonDisableCache)||Kameleoon.Internals.runtime.parameters.kameleoonVariationId;Kameleoon.Internals.runtime.kameleoonSelectionIframeMode=("true"==Kameleoon.Internals.runtime.parameters.kameleoonSelectionIframeMode);Kameleoon.Internals.configuration.activePersonalizations=[];Kameleoon.Internals.configuration.displayedPersonalizations=[];var personalizationEmailingScript=Kameleoon.Internals.configuration.personalizationEmailingScript;if(null!=personalizationEmailingScript){eval(personalizationEmailingScript)}for(var i=0,l=Kameleoon.Internals.runtime.personalizations.length;i<l;++i){var personalization=Kameleoon.Internals.runtime.personalizations[i];personalization.targeting=undefined}Kameleoon.Internals.runtime.pageStartTime=new Date().getTime();Kameleoon.Internals.runtime.virtualRootElement=document.createElement("div");Kameleoon.Internals.runtime.apiPersonalizations=new Kameleoon.Analyst.APIPersonalizations();if(window.parent!=window){try{Kameleoon.Internals.runtime.editorMode=Kameleoon.Internals.runtime.editorMode||(window.parent.location.search&&-1!=window.parent.location.search.indexOf("kameleoon=true"))}catch(e){}}Kameleoon.Utils.addEventListener(window,"message",Kameleoon.Utils.processMessageEvent,false);if(!Kameleoon.Internals.configuration.useWideDomainSupport){window.addEventListener("storage",function(event){var keysSplit=null==event.key?[""]:event.key.split("-");var key=keysSplit[0];if(-1!=key.indexOf("kameleoon")){var value;if(null==event.newValue){value=null}else{try{value=Kameleoon.Utils.LOCAL_STORAGE_OBFUSCATED_KEYS[key]?event.newValue:JSON.parse(event.newValue).value}catch(e){return}}var objectToProcess={};switch(key){case"kameleoonExperiment":objectToProcess.type=key;var experimentIdAsString=keysSplit[1];objectToProcess.experimentId=isNaN(experimentIdAsString)?experimentIdAsString:parseInt(experimentIdAsString);var registeredVariationId;if(value==null){registeredVariationId=null}else{var registeredVariationIdAsString=value.split("/")[0];registeredVariationId=isNaN(registeredVariationIdAsString)?registeredVariationIdAsString:parseInt(registeredVariationIdAsString)}objectToProcess.registeredVariationId=registeredVariationId;break;case"kameleoonPersonalizations":objectToProcess.type=key;objectToProcess.active=value==null?null:value.split("/")[0]=="true";break;case"kameleoonData":case"kameleoonDataSimulation":objectToProcess.type=key;objectToProcess.value=value==null?null:value;break;case"kameleoonLocalDataConsent":objectToProcess.type=key;objectToProcess.saveLocalDataAllowed=value==null?null:value;break}if(null!=objectToProcess.type){Kameleoon.Utils.processStorageData(objectToProcess)}}}.bind(this),false)}if(Kameleoon.Internals.configuration.abtestingSetup||Kameleoon.Internals.configuration.personalizationSetup){if(Kameleoon.Internals.runtime.parameters.kameleoonVariationId){Kameleoon.Internals.runtime.experiments=[]}else{for(var i=0,l=Kameleoon.Internals.runtime.experiments.length;i<l;++i){Kameleoon.Internals.runtime.experiments[i].targeting=undefined}}Kameleoon.API.events=[];Kameleoon.API.experiments=Kameleoon.Internals.runtime.experiments;this.obtainSimulationModeData()}else{this.setupAfterLocalDataRetrieval()}Kameleoon.API.experiments.forEach(function(e){if(e.targetingSegment&&e.targetingSegment.targetingTree!=null){e.flatTargetingSegment=Kameleoon.Utils.flattenTargetingTree(e.targetingSegment.targetingTree)}});Kameleoon.API.personalizations.forEach(function(p){if(p.targetingSegment&&p.targetingSegment.targetingTree!=null){p.flatTargetingSegment=Kameleoon.Utils.flattenTargetingTree(p.targetingSegment.targetingTree)}});if(Kameleoon.Internals.configuration.singlePageSupport){Kameleoon.Internals.runtime.href=window.location.href;Kameleoon.Utils.setInterval(function(){if(Kameleoon.Internals.runtime!=null){var oldKameleoonInternalsHref=Kameleoon.Internals.runtime.href;Kameleoon.Internals.runtime.href=window.location.href;if(oldKameleoonInternalsHref!=Kameleoon.Internals.runtime.href){Kameleoon.Analyst.load.apply(Kameleoon.Analyst,[])}}},100)}},APIPersonalizations:function(){var c=[];var b,a;var e=function(){b=Kameleoon.Internals.runtime.personalizations;Kameleoon.API.activePersonalizations=[];Kameleoon.API.displayedPersonalizations=[];d()};var d=function(){a=Kameleoon.API.personalizations=[];a=Kameleoon.Utils.api.mapAll(c,b,a);Kameleoon.API.displayedPersonalizations=Kameleoon.Internals.configuration.displayedPersonalizations;Kameleoon.API.activePersonalizations=Kameleoon.Internals.configuration.activePersonalizations};var f=function(){Kameleoon.API.displayedPersonalizations=Kameleoon.Internals.configuration.displayedPersonalizations;Kameleoon.API.activePersonalizations=Kameleoon.Internals.configuration.activePersonalizations};e();return{update:f,updateAll:d}},shouldAbortSetup:function(){if(Kameleoon.Internals.runtime.parameters.kameleoonDisabled||Kameleoon.Internals.configuration.kameleoonDisabled){return true}if(Kameleoon.Internals.runtime.unsupportedBrowser){return true}if(Kameleoon.Utils.readLocalData("kameleoonOptout","COOKIE",false)){return true}var shouldAbort=undefined;if(Kameleoon.Internals.configuration.abortCustomScript){try{shouldAbort=eval("(function() {"+Kameleoon.Internals.configuration.abortCustomScript+"})();")}catch(exception){shouldAbort=false}}if(shouldAbort){return true}return false},obtainSimulationModeData:function(){if(Kameleoon.Internals.runtime.parameters["kameleoon-simulation"]){Kameleoon.Internals.runtime.newSimulationModeData=true;if(0==Kameleoon.Internals.runtime.parameters["kameleoon-simulation"].indexOf("server-call-")){Kameleoon.Utils.performBeaconServerCall("https://"+Kameleoon.Internals.configuration.API_HOST_NAME+"."+Kameleoon.Internals.configuration.DOMAIN+"/simulation?siteCode="+Kameleoon.Internals.configuration.siteCode+"&simulationCode="+Kameleoon.Internals.runtime.parameters["kameleoon-simulation"].substring(12),function(){if((this.readyState==4)&&(this.status==200)){eval(this.responseText)}},null);return}Kameleoon.Internals.runtime.simulationModeData=Kameleoon.Utils.JSONParse(Kameleoon.Internals.runtime.parameters["kameleoon-simulation"])}this.setupLocalData()},setupLocalData:function(){if(Kameleoon.Internals.configuration.useWideDomainSupport){Kameleoon.Internals.runtime.externalIframe=document.getElementById("kameleoonExternalIframe");Kameleoon.Internals.runtime.postMessageOrigin=Kameleoon.Internals.configuration.customIFrameOrigin?Kameleoon.Internals.configuration.customIFrameOrigin:Kameleoon.Internals.configuration.IFRAME_ORIGIN;Kameleoon.Internals.runtime.postMessageCallbacks={};if(Kameleoon.Internals.configuration.externalIframeData==null){Kameleoon.Utils.postMessageToExternalIframe(Kameleoon.Utils.JSONStringify({type:"retrieve",callbackId:Kameleoon.Utils.addPostMessageCallback(function(a){this.setupLocalDataCallback(a)}.bind(this))}))}else{this.setupLocalDataCallback(Kameleoon.Internals.configuration.externalIframeData);delete (Kameleoon.Internals.configuration.externalIframeData)}}else{this.setupLocalDataCallback(null)}},loadKameleoonFull:function(c){if(Kameleoon.Internals.configuration.kameleoonFull!=null){this.updateAndEvaluateKameleoonFull(Kameleoon.Internals.configuration.kameleoonFull,c)}else{if(Kameleoon.Internals.configuration.useWideDomainSupport){Kameleoon.Utils.postMessageToExternalIframe(Kameleoon.Utils.JSONStringify({type:"kameleoonfull",staticHostName:Kameleoon.Internals.configuration.STATIC_HOST_NAME,domain:Kameleoon.Internals.configuration.DOMAIN,betaCode:Kameleoon.Internals.configuration.betaCode,cache:Kameleoon.Utils.obtainRandomString(16),callbackId:Kameleoon.Utils.addPostMessageCallback(function(d){Kameleoon.Analyst.updateAndEvaluateKameleoonFull(d,c)})}))}else{var b=sessionStorage.getItem("kameleoonFull");var a=sessionStorage.getItem("kameleoonFullTime");if((null==b)||(null==a)||(new Date().getTime()-parseInt(a)>=12*60*60*1000)){Kameleoon.Utils.performBeaconServerCall("//"+Kameleoon.Internals.configuration.STATIC_HOST_NAME+"."+Kameleoon.Internals.configuration.DOMAIN+"/kameleoon-full"+(Kameleoon.Internals.configuration.betaCode?"-beta":"")+".js?cache="+Kameleoon.Utils.obtainRandomString(16),function(){if((undefined===this.readyState)||((this.readyState==4)&&(this.status==200))){sessionStorage.setItem("kameleoonFull",this.responseText);sessionStorage.setItem("kameleoonFullTime",new Date().getTime());Kameleoon.Analyst.updateAndEvaluateKameleoonFull(this.responseText,c)}})}else{this.updateAndEvaluateKameleoonFull(b,c)}}}},updateAndEvaluateKameleoonFull:function(kameleoonFull,callback){Kameleoon.Internals.configuration.kameleoonFull=kameleoonFull;eval(kameleoonFull);callback&&callback()},allowSaveLocalData:function(){document.removeEventListener(Kameleoon.Internals.runtime.mouseDownEvent,Kameleoon.Analyst.allowSaveLocalData,false);window.removeEventListener("scroll",Kameleoon.Analyst.allowSaveLocalData,false);Kameleoon.Internals.runtime.saveLocalDataAllowed=true;Kameleoon.Utils.createLocalData("kameleoonLocalDataConsent",true,380,null,"LS",false,null,true);var a=(Kameleoon.Internals.runtime.localDataMap==null?null:Kameleoon.Internals.runtime.localDataMap.LS);var c=(Kameleoon.Internals.runtime.localDataMap==null?null:Kameleoon.Internals.runtime.localDataMap.COOKIE);if(a!=null){for(var b in a){Kameleoon.Utils.createLocalData(a[b].name,a[b].value,a[b].days,a[b].domain,a[b].forceLocalAccess,a[b].jsonFormat,null,true)}}if(c!=null){for(var b in c){Kameleoon.Utils.createLocalData(c[b].name,c[b].value,c[b].days,c[b].domain,c[b].forceLocalAccess,c[b].jsonFormat,null,true)}}Kameleoon.Internals.runtime.localDataMap=null;Kameleoon.Analyst.processRequestsToValidate()},setupLocalDataCallback:function(q){Kameleoon.Utils.removeBlockingStyleSheet();Kameleoon.Internals.runtime.saveLocalDataAllowed=q?q.kameleoonLocalDataConsent:Kameleoon.Utils.readLocalData("kameleoonLocalDataConsent","LS",true);if(Kameleoon.Internals.configuration.localDataLegalControl&&(null==Kameleoon.Internals.runtime.saveLocalDataAllowed)&&((Kameleoon.Internals.configuration.localDataConsentCookieName==null)||(Kameleoon.Utils.readLocalData(Kameleoon.Internals.configuration.localDataConsentCookieName,"COOKIE",false)==null))){Kameleoon.Internals.runtime.saveLocalDataAllowed=false;Kameleoon.Utils.addEventListener(document,Kameleoon.Internals.runtime.mouseDownEvent,this.allowSaveLocalData,false);Kameleoon.Utils.addEventListener(window,"scroll",this.allowSaveLocalData,false)}else{Kameleoon.Internals.runtime.saveLocalDataAllowed=true}if(Kameleoon.Internals.runtime.newSimulationModeData){Kameleoon.Utils.createLocalData("kameleoonSimulationMode",Kameleoon.Internals.runtime.simulationModeData,1/24,null,"LS",true);Kameleoon.Utils.createLocalData("kameleoonSimulationModeShortURL",Kameleoon.Internals.runtime.simulationModeShortURL,1/24,null,"LS",true)}else{Kameleoon.Internals.runtime.simulationModeData=q?q.kameleoonSimulationMode:Kameleoon.Utils.readLocalData("kameleoonSimulationMode","LS",true);Kameleoon.Internals.runtime.simulationModeShortURL=q?q.kameleoonSimulationModeShortURL:Kameleoon.Utils.readLocalData("kameleoonSimulationModeShortURL","LS",true)}if(Kameleoon.Internals.runtime.simulationModeData){Kameleoon.Internals.runtime.simulationMode=true;Kameleoon.Internals.runtime.disableCache=true;this.loadKameleoonFull(function(){Kameleoon.Analyst.processSimulations.apply(Kameleoon.Analyst)})}if(Kameleoon.Internals.runtime.parameters.kameleoonVariationId){var E=Kameleoon.Internals.runtime.parameters.kameleoonVariationId;var H=q?q["kameleoonVariation"+E]:Kameleoon.Utils.readLocalData("kameleoonVariation"+E,"LS",true);if(null!=H){sessionStorage.setItem("kameleoonVariation"+E,H);Kameleoon.Utils.createLocalData("kameleoonVariation"+E,H,0,null,"LS")}var g={id:"",name:"Visualization",forceTargeting:true,forceExposition:true,associatedVariation:{name:"",id:E}};Kameleoon.Internals.runtime.variations=[{id:"reference",name:"Reference",builtCssCodeLevel2:"",elementSets:[]}];Kameleoon.Internals.runtime.personalizations.push(g);g.displayedVariation={id:E};this.loadVariationDataForPrevisualization(g)}for(var A=0,x=Kameleoon.Internals.runtime.experiments.length;A<x;++A){var h=Kameleoon.Internals.runtime.experiments[A];var b=false;var G=q&&Kameleoon.Internals.configuration.useLocalStorage?q["kameleoonRedirect-"+h.id]:Kameleoon.Utils.readLocalData("kameleoonRedirect-"+h.id,null,false);G=G?G:Kameleoon.Internals.runtime.parameters["kameleoonRedirect-"+h.id];h.previousRequestRedirected=G?true:false;if(G){h.registeredVariationId=G;h.assignmentTime=new Date().getTime()}var o=q&&Kameleoon.Internals.configuration.useLocalStorage?q["kameleoonExperiment-"+h.id]:Kameleoon.Utils.readLocalData("kameleoonExperiment-"+h.id,null,false);for(var I in Kameleoon.Internals.runtime.parameters){if(0==I.indexOf("kameleoonAVTE-"+h.id)){o=Kameleoon.Internals.runtime.parameters[I]+"/"+new Date().getTime()+"/"+false;b=true}}if(o){var u=o.split("/");h.registeredVariationId=u[0];h.assignmentTime=u[1];h.counterActive=(u[2]=="true"&&(new Date().getTime()-h.assignmentTime<2592000000))?true:false}else{h.counterActive=false}if(h.registeredVariationId&&-1!=h.registeredVariationId.toString().indexOf("-mentalist")){h.registeredVariationId=h.registeredVariationId.replace("-mentalist","");h.mentalistEnabled=true}if(b){Kameleoon.Analyst.writeExperimentLocalData(h)}}if(Kameleoon.Internals.runtime.personalizations.length>0){this.changePersonalizationStatus(q==null?localStorage:q);var c;var o=q&&Kameleoon.Internals.configuration.useLocalStorage?q.kameleoonPersonalizations:Kameleoon.Utils.readLocalData("kameleoonPersonalizations");if(o){var u=o.split("/");c=(u[0]=="true")?true:false}else{if(Math.random()<Kameleoon.Internals.configuration.personalizationsDeviation){c=true}else{c=false}o=c+"/"+new Date().getTime();Kameleoon.Utils.createLocalData("kameleoonPersonalizations",o,380,null,null,false)}if(Kameleoon.API.visitor==null){Kameleoon.API.visitor={}}Kameleoon.API.visitor.personalizationsActive=c}var d;var f=Kameleoon.Internals.runtime.simulationMode&&!Kameleoon.Internals.runtime.newSimulationModeData;if(q){try{var v=f&&q.kameleoonDataSimulation!=null?"kameleoonDataSimulation":"kameleoonData";var n=q[v];if(!Kameleoon.Utils.LOCAL_STORAGE_OBFUSCATED_KEYS[v]){d=n}else{var p=Kameleoon.Utils.unobfuscateString(n);d=p&&Kameleoon.Utils.JSONParse(p)||{}}}catch(D){d=null}}else{d=(f?Kameleoon.Utils.readLocalData("kameleoonDataSimulation","LS",true):null)||Kameleoon.Utils.readLocalData("kameleoonData","LS",true)}Kameleoon.Internals.runtime.storedData=d||{};Kameleoon.Analyst.setupAfterLocalDataRetrieval();var a={simulation:true};for(var A=0,x=Kameleoon.Internals.runtime.experiments.length;A<x;++A){a[Kameleoon.Internals.runtime.experiments[A].id]=true}for(var A=0,x=Kameleoon.Internals.configuration.pausedExperiments.length;A<x;++A){a[Kameleoon.Internals.configuration.pausedExperiments[A]]=true}var k=[];var z=document.cookie.split(new RegExp("; *"));for(var A=0,x=z.length;A<x;++A){var B=z[A].substring(0,z[A].indexOf("="));var s=B.indexOf("kameleoonExperiment-");if(s==0){var C=B.substring("kameleoonExperiment-".length);if(a[C]==null){k.push(B)}}}var t=window.location.hostname.split(".");for(var A=0,x=k.length;A<x;++A){var F=k[A];var r="";for(var y=0,w=t.length;y<w;y++){if(y>0){r="."+r}r=t[w-y-1]+r;Kameleoon.Utils.eraseLocalData(F,r,"COOKIE")}}},setupAfterLocalDataRetrieval:function(){Kameleoon.Internals.runtime.setupAfterLocalDataRetrieval=true;if((!Kameleoon.Internals.runtime.simulationMode)&&Kameleoon.Internals.runtime.parameters.kameleoonHeatMap&&Kameleoon.Internals.runtime.parameters.kameleoonVariationId){Kameleoon.Utils.performBeaconServerCall("https://"+Kameleoon.Internals.configuration.API_HOST_NAME+"."+Kameleoon.Internals.configuration.DOMAIN+"/heatmap",function(){if((this.readyState==4)&&(this.status==200)){eval(this.responseText);Kameleoon.API.getHeatMap()}},null)}if(Kameleoon.Analyst.processScriptActivityTracking){Kameleoon.Analyst.processScriptActivityTracking()}if(Kameleoon.Internals.configuration.abtestingSetup||Kameleoon.Internals.configuration.personalizationSetup){if(Kameleoon.Gatherer&&Kameleoon.Internals.configuration.Gatherer){Kameleoon.Gatherer.run();Kameleoon.Internals.runtime.gathererRun=true}else{Kameleoon.Utils.saveStoredData(null)}Kameleoon.Internals.runtime.adblockCheckIntervalId=Kameleoon.Utils.setInterval(function(){var adBlockerDiv=document.getElementById("adBlockerCheck");if((adBlockerDiv==null)&&(document.body!=null)){adBlockerDiv=document.createElement("div");adBlockerDiv.id="adBlockerCheck";adBlockerDiv.className="ad-placement";document.body.appendChild(adBlockerDiv)}if((adBlockerDiv!=null)&&(Kameleoon.Utils.obtainComputedStyle(adBlockerDiv).display=="none")){Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime.adblockCheckIntervalId);Kameleoon.Internals.runtime.adblock=true}}.bind(this),50);Kameleoon.Internals.runtime.adblockCheckTimeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(Kameleoon.Internals.runtime.adblockCheckTimeoutId);var adBlockerDiv=document.getElementById("adBlockerCheck");if(adBlockerDiv!=null){adBlockerDiv.parentNode.removeChild(adBlockerDiv)}if(Kameleoon.Internals.runtime.adblock==null){Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime.adblockCheckIntervalId);Kameleoon.Internals.runtime.adblock=false}else{if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackAdBlocker()}}}.bind(this),2000);Kameleoon.Internals.runtime.ghosteryCheckIntervalId=Kameleoon.Utils.setInterval(function(){if(Kameleoon.Utils.querySelectorAll("[id^=ghostery-]").length>0){Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime.ghosteryCheckIntervalId);Kameleoon.Internals.runtime.ghostery=true}}.bind(this),50);Kameleoon.Internals.runtime.ghosteryCheckTimeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(Kameleoon.Internals.runtime.ghosteryCheckTimeoutId);if(Kameleoon.Internals.runtime.ghostery==null){Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime.ghosteryCheckIntervalId);Kameleoon.Internals.runtime.ghostery=false}else{if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackAdBlocker()}}}.bind(this),2000);if(Kameleoon.Internals.configuration.geolocation||Kameleoon.Internals.runtime.simulationMode){var registerGeolocation=function(geolocationString){Kameleoon.Internals.runtime.geolocation=Kameleoon.Utils.JSONParse(geolocationString);if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackGeolocation(Kameleoon.Internals.runtime.geolocation.country,Kameleoon.Internals.runtime.geolocation.region,Kameleoon.Internals.runtime.geolocation.city,Kameleoon.Internals.runtime.geolocation.postalCode,Kameleoon.Internals.runtime.geolocation.latitude,Kameleoon.Internals.runtime.geolocation.longitude)}if(Kameleoon.Internals.configuration.weather||Kameleoon.Internals.runtime.simulationMode){var registerWeather=function(weatherString){Kameleoon.Internals.runtime.weather=Kameleoon.Utils.JSONParse(weatherString);if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackWeather(Kameleoon.Internals.runtime.weather.main.temp,Kameleoon.Internals.runtime.weather.main.humidity,Kameleoon.Internals.runtime.weather.main.pressure,Kameleoon.Internals.runtime.weather.wind.speed,Kameleoon.Internals.runtime.weather.clouds.all,Kameleoon.Internals.runtime.weather.sys.sunrise*1000,Kameleoon.Internals.runtime.weather.sys.sunset*1000,Kameleoon.Internals.runtime.weather.weather&&Kameleoon.Internals.runtime.weather.weather[0]?Kameleoon.Internals.runtime.weather.weather[0].description:null)}}.bind(this);var weatherString=sessionStorage.getItem("KameleoonWeather");if(weatherString==null){if(null!=Kameleoon.Internals.runtime.geolocation.latitude&&null!=Kameleoon.Internals.runtime.geolocation.longitude){Kameleoon.Utils.performBeaconServerCall(Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_WEATHER_URL+"lat="+Kameleoon.Internals.runtime.geolocation.latitude+"&lon="+Kameleoon.Internals.runtime.geolocation.longitude,function(){if((this.readyState==4)&&(this.status==200)){weatherString=this.responseText;sessionStorage.setItem("KameleoonWeather",weatherString);registerWeather(weatherString)}},null)}}else{registerWeather(weatherString)}}if(Kameleoon.Internals.configuration.weatherForecast||Kameleoon.Internals.runtime.simulationMode){var registerWeatherForecast=function(weatherForecastString){Kameleoon.Internals.runtime.weatherForecast=Kameleoon.Utils.JSONParse(weatherForecastString)}.bind(this);var weatherForecastString=sessionStorage.getItem("KameleoonWeatherForecast");if(weatherForecastString==null){if(null!=Kameleoon.Internals.runtime.geolocation.latitude&&null!=Kameleoon.Internals.runtime.geolocation.longitude){Kameleoon.Utils.performBeaconServerCall(Kameleoon.Internals.runtime.OPEN_WEATHER_MAP_WEATHER_FORECAST_URL+"lat="+Kameleoon.Internals.runtime.geolocation.latitude+"&lon="+Kameleoon.Internals.runtime.geolocation.longitude,function(){if((this.readyState==4)&&(this.status==200)){weatherForecastString=this.responseText;sessionStorage.setItem("KameleoonWeatherForecast",weatherForecastString);registerWeatherForecast(weatherForecastString)}},null)}}else{registerWeatherForecast(weatherForecastString)}}}.bind(this);var geolocationString=sessionStorage.getItem("KameleoonGeolocation");if(geolocationString==null){Kameleoon.Utils.performBeaconServerCall("//tlp-"+this.obtainTrackerNodeCodeRandom()+".kameleoon.com/geolocation.gif",function(){if((this.readyState==4)&&((this.status==200)||(this.status==204))){geolocationString=Kameleoon.Utils.JSONStringify({country:this.getResponseHeader("geoip_country_name")||this.getResponseHeader("geoip_city_country_name"),region:this.getResponseHeader("geoip_region_name"),city:this.getResponseHeader("geoip_city"),postalCode:this.getResponseHeader("geoip_postal_code"),latitude:this.getResponseHeader("geoip_latitude"),longitude:this.getResponseHeader("geoip_longitude")});sessionStorage.setItem("KameleoonGeolocation",geolocationString);registerGeolocation(geolocationString)}},null)}else{registerGeolocation(geolocationString)}}if(Kameleoon.Internals.configuration.ip||Kameleoon.Internals.configuration.trackerExcludedIPRanges.length>0||Kameleoon.Internals.runtime.simulationMode){var registerIP=function(ipString){Kameleoon.Internals.runtime.ip=ipString;var ipIsTrackerAccepted=true;for(var i=0,l=Kameleoon.Internals.configuration.trackerExcludedIPRanges.length;i<l;++i){if(Kameleoon.Utils.ipAddressMatchesRange(ipString,Kameleoon.Internals.configuration.trackerExcludedIPRanges[i])){ipIsTrackerAccepted=false;break}}Kameleoon.Internals.runtime.ipIsTrackerAccepted=ipIsTrackerAccepted;this.processRequestsToValidate();if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackIP(Kameleoon.Internals.runtime.ip)}}.bind(this);var ipString=sessionStorage.getItem("KameleoonIP");if(ipString==null){Kameleoon.Utils.performBeaconServerCall("//tlp-"+this.obtainTrackerNodeCodeRandom()+".kameleoon.com/ip.gif",function(){if((this.readyState==4)&&((this.status==200)||(this.status==204))){ipString=this.getResponseHeader("ip");sessionStorage.setItem("KameleoonIP",ipString);registerIP(ipString)}},function(){Kameleoon.Internals.runtime.ipIsTrackerAccepted=true;Kameleoon.Analyst.processRequestsToValidate()},1000)}else{registerIP(ipString)}}Kameleoon.Internals.runtime.ysanceCheckIntervalId=Kameleoon.Utils.setInterval(function(){if(window.ytVisitorInformation!=null){Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime.ysanceCheckIntervalId)}}.bind(this),50);Kameleoon.Internals.runtime.ysanceCheckTimeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(Kameleoon.Internals.runtime.ysanceCheckTimeoutId);if(window.ytVisitorInformation==null){Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime.ysanceCheckIntervalId)}else{if(Kameleoon.Internals.runtime.gathererRun){var track=false;var valuesByKey={};if(window.ytVisitorInformation.segments!=null&&window.ytVisitorInformation.segments.length>0){valuesByKey.segments=window.ytVisitorInformation.segments;track=true}for(var key in window.ytVisitorInformation){if(key!="segments"){var value=window.ytVisitorInformation[key];if(value!=null){valuesByKey[key]=[value];track=true}}}if(track){Kameleoon.Gatherer.trackExternalSolutionData("YSANCE",valuesByKey)}}}}.bind(this),2000)}if(Kameleoon.Internals.runtime.experiments){for(var i=0,l=Kameleoon.Internals.runtime.experiments.length;i<l;++i){this.setupExperiment(Kameleoon.Internals.runtime.experiments[i])}}if(Kameleoon.Internals.runtime.personalizations){for(var i=0,l=Kameleoon.Internals.runtime.personalizations.length;i<l;++i){this.setupPersonalization(Kameleoon.Internals.runtime.personalizations[i])}}this.processAllContainers();this.processAllTargetingSegments();if(Kameleoon.Internals.runtime.experiments){var experimentsTracking=[];for(var i=0,l=Kameleoon.Internals.runtime.experiments.length;i<l;++i){var experiment=Kameleoon.Internals.runtime.experiments[i];if(true!==experiment.targeting&&experiment.redirectProcessed){this.performVariationAssignment(experiment,true);experimentsTracking.push(experiment)}else{if(experiment.preAssignVariation){this.performVariationAssignment(experiment,true)}}}this.performContainersTracking(experimentsTracking)}this.checkKameleoonGoals();Kameleoon.Utils.domReady(function(){if(!(true===Kameleoon.Internals.configuration.disableEditorLaunchViaKeys)){Kameleoon.Loader.enableKameleoonEditorListener()}if(Kameleoon.Internals.runtime.kameleoonSelectionIframeMode){var node=document.createElement("script");node.setAttribute("type","text/javascript");node.setAttribute("charset","utf-8");node.setAttribute("src","https://"+Kameleoon.Internals.configuration.API_HOST_NAME+"."+Kameleoon.Internals.configuration.DOMAIN+"/get-script?type=selection");Kameleoon.Internals.runtime.headNode.appendChild(node)}if(Kameleoon.Internals.runtime.editorMode&&!Kameleoon.Internals.runtime.editorEnabled&&Kameleoon.Internals.configuration.abtestingSetup){Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.enableKameleoonEditor.apply(Kameleoon.Loader)})}Kameleoon.Analyst.processGlobalScript.apply(Kameleoon.Analyst);if(Kameleoon.Internals.runtime.parameters.kameleoonVariationSelection||(Kameleoon.Internals.runtime.simulationMode&&!(Kameleoon.Internals.runtime.editorMode&&Kameleoon.Internals.runtime.editorEnabled))){Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.enableSimulationPanel()})}})},checkAndSetKameleoonTrackingTime:function(b,e){var a=sessionStorage.getItem("kameleoonTrackingTimes");var c=a==null?{}:Kameleoon.Utils.JSONParse(a);var d=20*60*1000;if(null==c[e]||null==c[e]["Experiment-"+b]||new Date().getTime()>=c[e]["Experiment-"+b]+d){if(null==c[e]){c[e]={}}c[e]["Experiment-"+b]=new Date().getTime();sessionStorage.setItem("kameleoonTrackingTimes",Kameleoon.Utils.JSONStringify(c));return true}return false},setupExperiment:function(a){if(a.previousRequestRedirected){a.redirectProcessed=true;if(Kameleoon.Internals.configuration.adobeOmniture){var b=Kameleoon.Internals.configuration.adobeOmniture.object?Kameleoon.Internals.configuration.adobeOmniture.object:"s";if(Kameleoon.Internals.runtime.parameters.sc_referrer){window[b].referrer=Kameleoon.Internals.runtime.parameters.sc_referrer}}Kameleoon.Utils.eraseLocalData("kameleoonRedirect-"+a.id,null,null)}},setupPersonalization:function(a){this.associateContainerAndVariation(a,"reference","DISPLAYED_VARIATION")},changePersonalizationStatus:function(object){for(var key in object){if(0==key.indexOf("kameleoonPersonalizationStatus-")){var personalizationId=parseInt(key.split("-")[1]);for(var i=0,l=Kameleoon.Internals.runtime.personalizations.length;i<l;++i){var personalization=Kameleoon.Internals.runtime.personalizations[i];if(personalizationId==personalization.id){var personalizationStatus=typeof object[key]=="object"?object[key]:JSON.parse(object[key]).value;personalization.forceTargeting=eval(personalizationStatus.targetingStringAndExpositionString[0]);personalization.forceExposition=eval(personalizationStatus.targetingStringAndExpositionString[1]);break}}}}},performVariationAssignment:function(experiment,onlyRegisteredVariation){if(experiment.displayedVariation&&!onlyRegisteredVariation){return}var registeredVariationId=experiment.registeredVariationId,assignmentTime=experiment.assignmentTime;if(registeredVariationId&&assignmentTime){for(var i=0,l=experiment.variations.length;i<l;++i){if(registeredVariationId==experiment.variations[i].id&&experiment.variations[i].respoolTime>assignmentTime||("none"==registeredVariationId&&experiment.untrackedRespoolTime>assignmentTime)){registeredVariationId=null;break}}}if("none"!=registeredVariationId&&!Kameleoon.Internals.runtime.simulationMode&&!this.findVariation(registeredVariationId)){registeredVariationId=null}if(!registeredVariationId||"true"==Kameleoon.Internals.runtime.parameters.kameleoonEraseCookies){var customVariationSelectionFunction=null;if(experiment.customVariationSelectionScript){try{eval(experiment.customVariationSelectionScript)}catch(exception){}}if(experiment.mentalistDeviation&&Kameleoon.Internals.runtime.gathererRun&&(Kameleoon.Mentalist!=null)){var deviationRandom=Math.random();if(deviationRandom<=experiment.mentalistDeviation){experiment.mentalistEnabled=true}}if(experiment.mentalistEnabled){var idList=[];for(var i=0,l=experiment.variations.length;i<l;++i){if("reference"!=experiment.variations[i].id){idList.push(experiment.variations[i].id)}}registeredVariationId=Kameleoon.Mentalist.computeBestActionToApply(idList);if(!registeredVariationId){registeredVariationId="reference"}}else{if(customVariationSelectionFunction){registeredVariationId=customVariationSelectionFunction(experiment)}else{var deviationRandom=this.obtainVariationAssignmentRandomNumber(experiment);var total=0;for(var i=0,l=experiment.variations.length;i<l;++i){total+=experiment.variations[i].deviation;if(deviationRandom<=total){registeredVariationId=experiment.variations[i].id;break}}registeredVariationId=registeredVariationId?registeredVariationId:"none"}}experiment.registeredVariationId=registeredVariationId;experiment.assignmentTime=new Date().getTime();this.writeExperimentLocalData(experiment)}this.associateContainerAndVariation(experiment,registeredVariationId,onlyRegisteredVariation?"REGISTERED_VARIATION":"BOTH")},obtainVariationAssignmentRandomNumber:function(c){var e=null;if(Kameleoon.Internals.runtime.gathererRun){for(var d=0,b=Kameleoon.Internals.runtime.Gatherer.configuration.customData.length;d<b;++d){var a=Kameleoon.Internals.runtime.Gatherer.configuration.customData[d];if((a!=null)&&a.mappingIdentifier){e=Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.countByValueByCustomDatum[d];if(e!=null){e=Object.keys(e)[0]}break}}}if(e==null){return Math.random()}return Kameleoon.Utils.seededRandom(c.id+"//"+e)},processAllContainers:function(){this.setMutationObserver();var a=[];if(Kameleoon.Internals.runtime.experiments){a=a.concat(Kameleoon.Internals.runtime.experiments)}if(Kameleoon.Internals.runtime.personalizations){a=a.concat(Kameleoon.Internals.runtime.personalizations)}this.processContainers(a)},processContainers:function(d){this.internalProcessContainers(d);if(!Kameleoon.Internals.runtime.domReady){var e=[];for(var c=0,b=d.length;c<b;++c){var a=d[c];if(!a.domReadyCallback){a.domReadyCallback=true;e.push(a)}}Kameleoon.Utils.domReady(function(){Kameleoon.Analyst.internalProcessContainers(e,true)})}},internalProcessContainers:function(h,d){var g=new Date().getTime();this.checkContainersTargeting(h);var f=[];for(var c=0,b=h.length;c<b;++c){var a=h[c];if(true===a.targeting){a.domReadyCallback=true;if(a.experimentContainer){this.performVariationAssignment(a,false);if(null!=a.registeredVariation){if(!this.checkCapping(true,a.id,a.registeredVariation.id,a.registeredVariation,g)){a.targeting=false}}}else{this.associateContainerAndVariation(a,a.exposition?a.associatedVariation.id:"reference","BOTH")}}if(true===a.targeting){if(a.displayedVariation&&a.displayedVariation.elementSets){if(a.experimentContainer){if(("reference"!=a.displayedVariation.id)||a.executeCodeForReference){if(a.cssCode&&(!a.cssCodeEvaluated)){this.addCSSStyleSheet(a.cssCode,a,null);a.cssCodeEvaluated=true}if(a.javaScriptCode&&(!a.javaScriptCodeEvaluated)){Kameleoon.Utils.callJavaScriptCode(a.javaScriptCode);a.javaScriptCodeEvaluated=true}}}if(!d){this.initVariationCommands(a.displayedVariation)}if(!a.trackingPerformed&&(a.experimentContainer||a.exposition||(!a.exposition&&a.notExposedReason=="CUSTOM_EXPOSITION_RATE"))){var e=document.createEvent("CustomEvent");e.initCustomEvent(a.experimentContainer?"Kameleoon::ExperimentTriggered":"Kameleoon::PersonalizationTriggered",false,false,{id:a.id,variationId:a.displayedVariation.id});window.dispatchEvent(e)}f.push(a)}}}this.performContainersTracking(f);Kameleoon.Internals.runtime.apiPersonalizations.updateAll()},processAllTargetingSegments:function(){if(Kameleoon.Internals.runtime.targetingSegments){this.processTargetingSegments(Kameleoon.Internals.runtime.targetingSegments)}},processTargetingSegments:function(b){this.internalProcessTargetingSegments(b);if(!Kameleoon.Internals.runtime.domReady){var a=[];for(var d=0,c=b.length;d<c;++d){var e=b[d];if(!e.domReadyCallback){e.domReadyCallback=true;a.push(e)}}Kameleoon.Utils.domReady(function(){Kameleoon.Analyst.internalProcessTargetingSegments(a,true)})}},internalProcessTargetingSegments:function(a,d){this.checkTargetingSegmentsTargeting(a);var f=[];for(var c=0,b=a.length;c<b;++c){var e=a[c];if(true===e.targeting){e.domReadyCallback=true;f.push(e)}}this.performTargetingSegmentsTracking(f)},loadVariationData:function(d,a){var h=d.displayedVariation.id;if(a){sessionStorage.removeItem("kameleoonVariation"+h);if(!Kameleoon.Internals.runtime.requestedVariations[h]){this.loadVariationFromServer(d,h,a)}Kameleoon.Internals.runtime.requestedVariations[h].simulation=true}else{var e=sessionStorage.getItem("kameleoonVariation"+h);if(e){Kameleoon.Internals.runtime.variations.push(Kameleoon.Utils.JSONParse(e));Kameleoon.Analyst.associateContainerAndVariation(d,h,"BOTH");return}if(!Kameleoon.Internals.runtime.requestedVariations[h]){this.loadVariationFromServer(d,h)}var c=d.id;var g=false;for(var f=0,b=Kameleoon.Internals.runtime.requestedVariations[h].containers.length;f<b;++f){if(c==Kameleoon.Internals.runtime.requestedVariations[h].containers[f].id){g=true;break}}if(!g){Kameleoon.Internals.runtime.requestedVariations[h].containers.push(d)}}},loadVariationDataForPrevisualization:function(a){var c=a.displayedVariation.id;var b=sessionStorage.getItem("kameleoonVariation"+c);if(b){Kameleoon.Internals.runtime.variations.push(Kameleoon.Utils.JSONParse(b));Kameleoon.Analyst.associateContainerAndVariation(a,c,"BOTH");return}if(!Kameleoon.Internals.runtime.requestedVariations[c]){this.loadVariationFromServer(a,c,true)}Kameleoon.Internals.runtime.requestedVariations[c].simulation=true},loadVariationFromServer:function(b,e,a){Kameleoon.Internals.runtime.requestedVariations[e]={containers:[]};if("reference"!=e){var c="//";if(a){c+=Kameleoon.Internals.configuration.STATIC_DIRECT_HOST_NAME}else{c+=Kameleoon.Internals.configuration.STATIC_HOST_NAME}c+="."+Kameleoon.Internals.configuration.DOMAIN+"/css/customers/"+Kameleoon.Internals.configuration.siteCode+"/"+Kameleoon.Internals.configuration.memberCode+"/";if(b.simulationMode&&b.multiVariateTest){c+="simulation/"+e+"-data.js"}else{c+=e+"/data.js"}if(Kameleoon.Internals.runtime.disableCache){c+="?cache="+Kameleoon.Utils.obtainRandomString(16)}Kameleoon.API.forceNoFlicker("*");var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("charset","utf-8");d.setAttribute("src",c);Kameleoon.Internals.runtime.headNode.appendChild(d)}},checkKameleoonGoals:function(){var g=[];for(var d=0,b=Kameleoon.Internals.configuration.goals.length;d<b;++d){var c=Kameleoon.Internals.configuration.goals[d];var e={goal:c};if("URL"==c.type){var a=new RegExp(c.url);if(a.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())){g.push(e)}}if("PAGE_VIEWS"==c.type){if(Kameleoon.Internals.runtime.gathererRun){var f=Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.timesStartedPages.length;if((c.minPageViews==null||f>=c.minPageViews)&&(c.maxPageViews==null||f<=c.maxPageViews)){g.push(e)}}}}if(g.length>0){this.processConversions(g)}Kameleoon.Internals.runtime.conversionsProcessingEngagement=[];for(var d=0,b=Kameleoon.Internals.configuration.goals.length;d<b;++d){var c=Kameleoon.Internals.configuration.goals[d];if("ENGAGEMENT"==c.type){Kameleoon.Internals.runtime.conversionsProcessingEngagement.push({goal:c})}}Kameleoon.Utils.addEventListener(document,Kameleoon.Internals.runtime.mouseDownEvent,function(h){Kameleoon.Analyst.processConversions(Kameleoon.Internals.runtime.conversionsProcessingEngagement)},true);Kameleoon.Utils.setInterval(function(){if(Kameleoon.Internals.runtime!=null&&Kameleoon.Internals.runtime.gathererRun){var n=[];for(var k=0,h=Kameleoon.Internals.configuration.goals.length;k<h;++k){var j=Kameleoon.Internals.configuration.goals[k];if("TIME_SPENT"==j.type){var m=Kameleoon.Internals.runtime.Visitor.currentVisit.timeLastActivity-Kameleoon.Internals.runtime.Visitor.currentVisit.timeStarted;if((j.minTimeSpent==null||m>=j.minTimeSpent)&&(j.maxTimeSpent==null||m<=j.maxTimeSpent)){n.push({goal:j})}}}if(n.length>0){this.processConversions(n)}}}.bind(this),1000);Kameleoon.Internals.runtime.conversionsProcessingScroll=[];for(var d=0,b=Kameleoon.Internals.configuration.goals.length;d<b;++d){var c=Kameleoon.Internals.configuration.goals[d];if("SCROLL"==c.type){Kameleoon.Internals.runtime.conversionsProcessingScroll.push({goal:c})}}Kameleoon.Utils.addEventListener(document,"scroll",function(n){if(document.body){var q=[];for(var m=0,h=Kameleoon.Internals.runtime.conversionsProcessingScroll.length;m<h;++m){var k=Kameleoon.Internals.runtime.conversionsProcessingScroll[m].goal;if(!k.sent){var j=null,p=null;switch(k.scrollTrackingType){case"PIXELS_HEIGHT":j=Math.ceil(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight;p=k.scrollTrackingValue;break;case"PERCENTAGE":j=(Math.ceil(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight)/document.body.scrollHeight*100;p=k.scrollTrackingValue;break;case"ELEMENT":j=window.innerHeight;var o=Kameleoon.Utils.querySelectorAll(k.selector.queryValue);if(o.length>0){p=o[0].getBoundingClientRect().top+o[0].offsetHeight}break}if(j!==null&&p!==null&&p<=j){q.push(Kameleoon.Internals.runtime.conversionsProcessingScroll[m]);Kameleoon.Internals.runtime.conversionsProcessingScroll[m].goal.sent=true}}}if(q.length>0){Kameleoon.Analyst.processConversions(q)}}},true)},processConversions:function(f){if(Kameleoon.Internals.runtime.gathererRun){var n=[];if(Kameleoon.Internals.runtime.experiments!=null){for(var h=0,c=Kameleoon.Internals.runtime.experiments.length;h<c;++h){var a=Kameleoon.Internals.runtime.experiments[h];var o=a.registeredVariationId;if((o!=null)&&(o!="none")){n.push(a.id)}}}var k=[];for(var g=0,b=f.length;g<b;++g){var e=f[g];var p=e.goal;var d=(e.negative===true);if((d||(("PAGE_VIEWS"!=p.type)&&("TIME_SPENT"!=p.type)&&("ENGAGEMENT"!=p.type))||(Kameleoon.Internals.runtime.Visitor.currentVisit.obtainNumberConversions(p.id)==0))&&((!p.linkedExperimentId)||(-1!=n.indexOf(p.linkedExperimentId)))){k.push({goalId:p.id,revenue:(e.revenue?e.revenue:0),negative:d})}}if(k.length>0){Kameleoon.Gatherer.trackConversions(k)}}},checkTargetingSegmentsTargeting:function(d){var c=[];for(var f=0,e=d.length;f<e;++f){var g=d[f];if(g.numberTargetingCheckings==null){g.numberTargetingCheckings=0}if(this.checkIfTargetingMustBeComputed(g.targeting,g.rescheduleTargeting||(0==g.numberTargetingCheckings),false)){c.push(g)}}d=c;for(var f=0,e=d.length;f<e;++f){var g=d[f];var b=this.checkTargetingTree(null,(g?g.targetingTree:null),false);g.targeting=b.targeting;g.rescheduleTargeting=b.rescheduleTargeting;g.mentalistPrediction=b.mentalistPrediction;g.numberTargetingCheckings++}var a=[];for(var f=0,e=d.length;f<e;++f){var g=d[f];if(this.checkIfTargetingMustBeComputed(g.targeting,g.rescheduleTargeting,false)){a.push(g)}}if(a.length>0){var h=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(h);Kameleoon.Analyst.processTargetingSegments.apply(Kameleoon.Analyst,[a])},Kameleoon.Internals.runtime.PAGE_LOADING_POLL_DELAY)}},checkContainersTargeting:function(g){var E=null;if(Kameleoon.Internals.runtime.simulationModeData){var L=Kameleoon.Internals.runtime.simulationModeData.targetingSegment;if(L){E=L.id}}if(Kameleoon.Internals.runtime.personalizations){for(var S=0,P=Kameleoon.Internals.runtime.personalizations.length;S<P;++S){var T=Kameleoon.Internals.runtime.personalizations[S];T.previousExposition=T.exposition}}var e=[];for(var S=0,P=g.length;S<P;++S){var H=g[S];if(H.numberTargetingCheckings==null){H.numberTargetingCheckings=0}if(this.checkIfTargetingMustBeComputed(H.targeting,H.rescheduleTargeting||(0==H.numberTargetingCheckings),(!H.experimentContainer)&&("CUMULATIVE_WEIGHT"==H.personalizationCheckConditionsRule))){e.push(H)}}g=e;for(var S=0,P=g.length;S<P;++S){var H=g[S];if(E!=null){if(E==H.targetingSegmentId||E==H.targetingSegment.id){H.forceTargeting=true}}if(true===H.forceTargeting){H.targeting=true}else{var K=(!H.experimentContainer)&&("CUMULATIVE_WEIGHT"==H.personalizationCheckConditionsRule);var y=this.checkTargetingTree(H,(H.targetingSegment?H.targetingSegment.targetingTree:null),K);if(K){switch(H.microtargetingMatchType){case"GREATER":H.targeting=y.weight>(H.cumulativeWeightOfConditions||0);break;case"EQUAL":H.targeting=y.weight==(H.cumulativeWeightOfConditions||0);break;case"LOWER":H.targeting=y.weight<H.cumulativeWeightOfConditions;break}}else{H.targeting=y.targeting}H.rescheduleTargeting=y.rescheduleTargeting;H.mentalistPrediction=y.mentalistPrediction;H.numberTargetingCheckings++}if(true===H.targeting){if(H.experimentContainer){Kameleoon.Internals.runtime.targetedExperiments=true}else{Kameleoon.Internals.runtime.targetedPersonalizations=true}}}var J=[];for(var S=0,P=g.length;S<P;++S){var H=g[S];if(!H.experimentContainer){if(true===H.targeting){J.push(H)}else{H.exposition=false;H.notExposedReason="TARGETING"}}}var x=function(W){var n=[];for(var m=0,j=Kameleoon.Internals.runtime.personalizations.length;m<j;++m){var k=Kameleoon.Internals.runtime.personalizations[m];if(W!=k.id){n.push(k)}}return n};var c=new Date();var V=c.getTime();for(var S=0,P=J.length;S<P;++S){var T=J[S];if(T.forceExposition!==undefined){T.exposition=T.forceExposition;if(false===T.exposition){T.notExposedReason="FORCED_TO_BE_FALSE"}}else{T.exposition=true;if((true===T.exposition)&&(!Kameleoon.Internals.runtime.simulationMode||null!=Kameleoon.Internals.runtime.simulationModeData.experiments)&&!Kameleoon.API.visitor.personalizationsActive){T.exposition=false;T.notExposedReason="INACTIVE_PERSONALIZATIONS"}if((true===T.exposition)&&T.globalCappingNumberVisitors&&(T.numberVisitorsExposed>=T.maxNumberVisitorsExposed)){T.exposition=false;T.notExposedReason="GLOBAL_CAPPING_NUMBER_VISITORS"}var G=T.scheduleItem;if((true===T.exposition)&&(null!=G)&&(0<G.length)){T.exposition=false;for(var R=0,N=G.length;R<N;++R){var C=G[R];if(((C.dateStart==null)||(V>=C.dateStart))&&((C.dateEnd==null)||(V<C.dateEnd))){var t=C.scheduleItemOptions;if((null==t)||(0==t.length)){T.exposition=true}else{for(var Q=0,M=t.length;Q<M;++Q){var u=t[Q];if(Kameleoon.Utils.isInsideHoursMinutesRange(u.hoursStart,u.minutesStart,u.hoursEnd,u.minutesEnd,c.getHours(),c.getMinutes())){var f=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"];switch(u.daysOfWeekForShow){case"EVERYDAY":T.exposition=true;break;case"WEEK_END":if(0==c.getDay()||6==c.getDay()){T.exposition=true}break;case"WEEK":if(0!=c.getDay()&&6!=c.getDay()){T.exposition=true}break;default:if(u.daysOfWeekForShow==f[c.getDay()]){T.exposition=true}break}}if(true===T.exposition){break}}}}if(true===T.exposition){break}}if(false===T.exposition){T.notExposedReason="SCHEDULING"}}if(true===T.exposition){switch(T.customExpositionRate){case 1:break;case 0:T.exposition=false;break;default:var U=Kameleoon.Utils.readLocalData("kameleoonPersonalizationTargeted-"+T.id,"COOKIE",false);if(U!=null){var O=U.split("/");T.exposition=(O[0]=="true")}else{T.exposition=(Math.random()<T.customExpositionRate);Kameleoon.Utils.createLocalData("kameleoonPersonalizationTargeted-"+T.id,T.exposition+"/"+new Date().getTime(),380,null,"COOKIE",false)}break}if(false===T.exposition){T.notExposedReason="CUSTOM_EXPOSITION_RATE"}}if((true===T.exposition)&&(!this.checkCapping(false,T.id,1,T,V))){T.exposition=false;T.notExposedReason="EXPOSITION_FREQUENCY"}var I=T.personalizationsInteractionConditions;if((true===T.exposition)&&(null!=I)&&(0<I.length)){for(var R=0,N=I.length;R<N;++R){var s=I[R];if(("SAME_PAGE"!=s.personalizationsInteractionVisitsConfiguration)&&(!Kameleoon.Internals.runtime.gathererRun)){continue}var p;var D;var v;switch(s.personalizationsInteractionConfiguration){case"NO_OTHER_PERSO":p=x(T.id);D=0;v=0;break;case"AT_LEAST_ONE_OTHER_PERSO":p=x(T.id);D=1;v=p.length;break;case"NUMBER_OF_OTHER_PERSOS":p=x(T.id);switch(s.personalizationsInteractionNumberOtherPersosMatchType){case"GREATER":D=s.personalizationsInteractionNumberOtherPersos+1;v=p.length;break;case"LOWER":D=0;v=s.personalizationsInteractionNumberOtherPersos-1;break;case"GREATER_THAN_EQUAL":D=s.personalizationsInteractionNumberOtherPersos;v=p.length;break;case"LOWER_THAN_EQUAL":D=0;v=s.personalizationsInteractionNumberOtherPersos;break;case"EQUAL":default:D=s.personalizationsInteractionNumberOtherPersos;v=s.personalizationsInteractionNumberOtherPersos;break}break;case"ALL_OTHER_PERSOS":p=x(T.id);D=p.length;v=p.length;break;case"ID_PERSO":p=[];for(var Q=0,M=Kameleoon.Internals.runtime.personalizations.length;Q<M;++Q){var h=Kameleoon.Internals.runtime.personalizations[Q];if(h.id==s.personalizationsInteractionIdPerso){p.push(h);break}}if(p.length==0){p.push({id:s.personalizationsInteractionIdPerso,previousExposition:false})}D=1;v=1;break;default:p=[];D=1;v=1;break}var B=0;for(var Q=0,M=p.length;Q<M;++Q){var q=p[Q];var a;switch(s.personalizationsInteractionVisitsConfiguration){case"SAME_PAGE":a=(true===q.previousExposition);break;case"CURRENT_VISIT":a=Kameleoon.Visitor.obtainContainerNumberActivations(q.id,1,null,null,true,false,false,false)>0;break;case"PREVIOUS_VISIT":a=Kameleoon.Visitor.obtainContainerNumberActivations(q.id,1,null,null,false,true,false,false)>0;break;case"ALL_VISITS":a=Kameleoon.Visitor.obtainContainerNumberActivations(q.id,1,null,null,true,true,false,false)>0;break;default:a=false;break}if(!s.personalizationsInteractionDisplayOthersPersos){a=!a}if(a){B++}}var F=(B>=D)&&(B<=v);if((F&&(!s.personalizationsInteractionDisplayPerso))||((!F)&&s.personalizationsInteractionDisplayPerso)){T.exposition=false;T.notExposedReason="INTERACTIONS";break}}}}}var A={};if(Kameleoon.Internals.runtime.personalizations){Kameleoon.Internals.runtime.personalizations.forEach(function(j){if(j.exposition){var k=j.personalizationConfiguration;var i=A[k];var l=j.priority;if(i==null||l>i){A[k]=l}}})}var r={};for(var S=0,P=g.length;S<P;++S){var H=g[S];if((!H.experimentContainer)&&(true===H.exposition)){var o=H.personalizationConfiguration;var b=A[o];var w=H.priority;if(b==null||w>=b){if(r[o]==null||w>b){r[o]=[]}r[o].push(H.id)}}}A=null;if(Kameleoon.Internals.configuration.disablePersonalizationsOfTheSameType){for(var o in r){r[o]=[r[o][Math.floor(Math.random()*r[o].length)]]}}for(var S=0,P=J.length;S<P;++S){var T=J[S];if((true===T.exposition)&&(true!==T.forceExposition)){if(r[T.personalizationConfiguration].indexOf(T.id)==-1){T.exposition=false;T.notExposedReason="PRIORITY"}}}r=null;var d=[];for(var S=0,P=g.length;S<P;++S){var H=g[S];if((false===H.targeting)||((!H.experimentContainer)&&(true===H.targeting)&&(false===H.exposition))){this.associateContainerAndVariation(H,"reference","DISPLAYED_VARIATION");this.removeCSSStyleSheet(H)}if(this.checkIfTargetingMustBeComputed(H.targeting,H.rescheduleTargeting,(!H.experimentContainer)&&("CUMULATIVE_WEIGHT"==H.personalizationCheckConditionsRule))){d.push(H)}}if(d.length>0){var z=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(z);Kameleoon.Analyst.processContainers.apply(Kameleoon.Analyst,[d])},Kameleoon.Internals.runtime.PAGE_LOADING_POLL_DELAY)}g.length&&Kameleoon.Internals.runtime.targetingsEvent.emit(g)},checkTargetingTree:function(a,h,d){var k;if(null==h){k={targeting:true,rescheduleTargeting:false,mentalistPrediction:{}};if(d){k.weight=0}}else{if(h.numberTargetingCheckings==null){h.numberTargetingCheckings=0}if(!this.checkIfTargetingMustBeComputed(h.targeting,h.rescheduleTargeting||(0==h.numberTargetingCheckings),d)){k={targeting:h.targeting,rescheduleTargeting:false,mentalistPrediction:h.mentalistPrediction};if(d){k.weight=h.weight}}else{if(null!=h.targetingCondition){k=this.checkTargetingCondition(a,h.targetingCondition)}else{var i=this.checkTargetingTree(a,h.leftChild,d);var b=false;if(!b){if(Kameleoon.Internals.runtime.simulationMode){b=true}}if(!b){if(d){b=true}}if(!b){switch(i.targeting){case true:if(!h.orOperator){b=true}break;case false:if(h.orOperator){b=true}break;case undefined:default:b=true;break}}var j=null;if(b){j=this.checkTargetingTree(a,h.rightChild,d)}var c;switch(i.targeting){case true:if(h.orOperator){c=true}else{switch(j.targeting){case true:c=true;break;case false:c=false;break;case undefined:default:c=undefined;break}}break;case false:if(h.orOperator){switch(j.targeting){case true:c=true;break;case false:c=false;break;case undefined:default:c=undefined;break}}else{c=false}break;case undefined:default:if(h.orOperator){switch(j.targeting){case true:c=true;break;case false:c=undefined;break;case undefined:default:c=undefined;break}}else{switch(j.targeting){case true:c=undefined;break;case false:c=false;break;case undefined:default:c=undefined;break}}break}var e={};for(var f in i.mentalistPrediction){e[f]=i.mentalistPrediction[f]}if(b){for(var f in j.mentalistPrediction){e[f]=j.mentalistPrediction[f]}}k={targeting:c,rescheduleTargeting:this.checkIfTargetingMustBeComputed(c,i.rescheduleTargeting||(b&&j.rescheduleTargeting),d),mentalistPrediction:e};if(d){var g;if(h.orOperator){g=Math.max(i.weight,j.weight)}else{g=i.weight+j.weight}k.weight=g}}h.targeting=k.targeting;h.rescheduleTargeting=k.rescheduleTargeting;h.mentalistPrediction=k.mentalistPrediction;if(d){h.weight=k.weight}}h.numberTargetingCheckings++}return k},checkTargetingCondition:function(c,h){var b;if(h.numberTargetingCheckings==null){h.numberTargetingCheckings=0}if(!this.checkIfTargetingMustBeComputed(h.targeting,h.rescheduleTargeting||(0==h.numberTargetingCheckings),undefined)){b={targeting:h.targeting,rescheduleTargeting:false,mentalistPrediction:h.mentalistPrediction}}else{var d=Kameleoon.Analyst["evaluateTargeting_"+h.type];var g;if(d!=null){g=d.bind(this)(h,c)}else{g=null}if(g==null){g={targeting:undefined,rescheduleTargeting:false}}var e=g.targeting;if(true!==h.include){if(undefined===e){if(g.excludedUndefinedIsTargeted===true){e=true}}else{e=!e}}var a={};if(g.mentalistPrediction!=null){for(var f in g.mentalistPrediction){a[f]=[g.mentalistPrediction[f],e]}}b={targeting:e,rescheduleTargeting:this.checkIfTargetingMustBeComputed(e,g.rescheduleTargeting,undefined),mentalistPrediction:a};h.targeting=b.targeting;h.rescheduleTargeting=b.rescheduleTargeting;h.mentalistPrediction=b.mentalistPrediction}if(b.targeting===true){b.weight=h.weight}else{b.weight=0}h.numberTargetingCheckings++;return b},checkIfTargetingMustBeComputed:function(b,c,a){var d=(true===c)&&((undefined===b)||((false===b)&&(true===a)));return d},checkCapping:function(d,a,e,b,c){if(Kameleoon.Internals.runtime.gathererRun&&((b.expositionFrequencySameVisit!=null)&&(Kameleoon.Visitor.obtainContainerNumberActivations(a,e,null,c,true,false,false,d)>=b.expositionFrequencySameVisit))||((b.expositionFrequencySameVisitor!=null)&&(b.expositionFrequencySameVisitorDelaySeconds!=null)&&(Kameleoon.Visitor.obtainContainerNumberActivations(a,e,c-(b.expositionFrequencySameVisitorDelaySeconds*1000),c,true,true,false,d)>=b.expositionFrequencySameVisitor))||(b.cappingPerVisitorNumberExpositions&&(Kameleoon.Visitor.obtainContainerNumberActivations(a,e,null,c,true,true,false,d)>=b.expositionFrequencySameVisitorMax))||(b.cappingPerVisitorNumberExposedVisits&&(Kameleoon.Visitor.obtainContainerNumberActivations(a,e,null,null,true,true,true,d)>=b.exposedVisitsSameVisitorMax))||(b.cappingPerVisitorConvertGoal&&(Kameleoon.Visitor.obtainNumberConversions(b.cappingPerVisitorGoalId)>0))||((b.expositionFrequencyDelaySecondsBetweenTwoExpositions!=null)&&(Kameleoon.Visitor.obtainContainerNumberActivations(a,e,c-(b.expositionFrequencyDelaySecondsBetweenTwoExpositions*1000),c,true,true,false,d)>=1))){return false}return true},initVariationCommands:function(e){if(!e||Kameleoon.Internals.runtime.editorMode||Kameleoon.Internals.runtime.kameleoonSelectionIframeMode){return}Kameleoon.API.currentContainer=e.container;if(e.redirections){var b=e.redirections;for(var d=0,a=b.length;d<a;++d){if(!b[d].scope||new RegExp(b[d].scope).test(window.location.href)){if(b[d].additionalParameters){if(-1==window.location.search.indexOf(b[d].string)){if("#"!=b[d].string[0]){Kameleoon.API.processRedirect(window.location.protocol+"//"+window.location.hostname+((!window.location.port)?"":":"+window.location.port)+window.location.pathname+(window.location.search+((-1==window.location.search.indexOf("?"))?"?":"&")+b[d].string)+window.location.hash)}else{window.location.replace(window.location.protocol+"//"+window.location.hostname+((!window.location.port)?"":":"+window.location.port)+window.location.pathname+window.location.search+b[d].string)}}}else{var f=b[d].string;if(b[d].keepParameters){f+=(-1!=f.indexOf("?"))?window.location.search.replace("?","&"):window.location.search}Kameleoon.API.processRedirect(f)}}}}if(e.forceNoFlicker&&!Kameleoon.Internals.runtime.domReady){var c="";for(var d=0,a=e.elementSets.length;d<a;++d){c+=((0!=d)?", ":"")+e.elementSets[d].selector}Kameleoon.API.forceNoFlicker(c)}if(!e.styleSheetAdded){this.addCSSStyleSheet(e.builtCssCodeLevel2,e.container,null);e.styleSheetAdded=true}if(e.javaScriptCode&&!e.javaScriptCode.afterDOMReady){this.applyJavascriptCode(e)}this.processVariationCommands(e)},processVariationCommands:function(b){if(!b){return}if(b.elementSets&&b.elementSets.length>0&&null==Kameleoon.Analyst.processElementSet){this.loadKameleoonFull(function(){this.processVariationCommands(b)}.bind(this));return}var a=b.container;if(b.javaScriptCode&&b.javaScriptCode.afterDOMReady&&!b.permanentRefreshActive){Kameleoon.Utils.domReady(function(){Kameleoon.Analyst.applyJavascriptCode(b)})}if(b.elementSets&&(!a||a.targeting)){b.elementSets.forEach(function(d){d.evaluated=true;Kameleoon.Analyst.processElementSet(d,b,false,b.permanentRefreshActive,b.editionMode)})}if(b.replaceData){var c=JSON.parse(b.replaceData);Kameleoon.Analyst.processReplaceData(c)}if(b.forceNoFlicker&&!b.permanentRefreshActive){Kameleoon.Utils.removeBlockingStyleSheet()}if(Kameleoon.Internals.runtime["enginePollerForVariation"+b.id]&&!b.permanentRefreshActive){window.clearInterval(Kameleoon.Internals.runtime["enginePollerForVariation"+b.id]);Kameleoon.Internals.runtime["enginePollerForVariation"+b.id]=null}if(!Kameleoon.Internals.runtime["enginePollerForVariation"+b.id]&&!Kameleoon.Internals.runtime.editorMode&&!Kameleoon.Internals.runtime.kameleoonSelectionIframeMode){b.permanentRefreshActive=true;if(!Kameleoon.Internals.runtime.listenVariations){Kameleoon.Internals.runtime.listenVariations=[]}Kameleoon.Internals.runtime.listenVariations.push(b);Kameleoon.Internals.runtime["enginePollerForVariation"+b.id]=true;if(Kameleoon.Internals.runtime.cantUseMutationObserver){Kameleoon.Internals.runtime["enginePollerForVariation"+b.id]=Kameleoon.Utils.setInterval(function(){Kameleoon.Analyst.processVariationCommands.apply(Kameleoon.Analyst,[b])},10)}}},applyJavascriptCode:function(a){if(a.javaScriptCode&&a.javaScriptCode.code&&!a.javaScriptCode.evaluated){Kameleoon.Utils.callJavaScriptCode(a.javaScriptCode.code);a.javaScriptCode.evaluated=true}},setMutationObserver:function(){if(Kameleoon.Internals.runtime.cantUseMutationObserver){return}Kameleoon.Analyst.fillInternalObjectsForMutationObserver();var b=document.documentElement,a;if(!Kameleoon.Internals.runtime.mutationObserver){Kameleoon.Internals.runtime.mutationObserver=new MutationObserver(function(c){c.forEach(function(f){var o=true,i=f.addedNodes,h=f.removedNodes,g=Kameleoon.Internals.runtime.listenVariations;Kameleoon.Analyst.removeMutationElementsFromInternalObjects(h);Kameleoon.Analyst.addMutationElementsToInternalObjects(i);var p=Array.prototype.slice.call(i);var l=Array.prototype.slice.call(h);var m=p.concat(l);for(var e=0;e<m.length;++e){var j=m[e];var n=j.parentNode;if((Kameleoon.Internals.runtime.editorMode||Kameleoon.Internals.runtime.kameleoonSelectionIframeMode)&&j&&j.id&&"string"==typeof j.id&&j.id.match("kameleoon")!==null){if(j.closest){if(j.closest(".KameleoonProtected")!==null){o=false}}}if(o&&j&&j.innerHTML&&f.type==="childList"){Kameleoon.Analyst.fillInternalObjectsForMutationObserver(j)}if(o&&j&&g){g.forEach(function(r){if(r.elementSets){r.elementSets.forEach(function(v){if((!(v.evaluated&&(v.options.autoGeneratedSelector||v.options.idSelector||v.options.domOperation)))&&Kameleoon.Analyst.checkIDsForSelector(v)&&Kameleoon.Analyst.checkClassesForSelector(v)&&Kameleoon.Analyst.checkContainsTextesForSelector(v,j)){if(!r.container||r.container.targeting){v.evaluated=true;Kameleoon.Analyst.processElementSet(v,r,false,r.permanentRefreshActive,r.editionMode,n)}}})}if(r.replaceData&&j.nodeType===Node.TEXT_NODE&&(!j.parentNode||(j.parentNode.nodeName!=="SCRIPT"&&j.parentNode.nodeName!=="STYLE"))){var t=JSON.parse(r.replaceData);for(var s=0;s<t.length;++s){var u=new RegExp(t[s].toReplace,"gi");if(!t[s].disabled&&j.nodeValue&&u.test(j.nodeValue)){Kameleoon.Analyst.saveElementOriginalData(j);j.kameleoonData.powered=true;j.nodeValue=j.nodeValue.replace(u,t[s].replaceBy)}}}})}if(o&&j){for(var q=Kameleoon.Internals.runtime.waitingElementPresentObjects.length-1;q>=0;q-=1){var k=Kameleoon.Internals.runtime.waitingElementPresentObjects[q];if(k&&k.useAntiFlicker){if(Kameleoon.Analyst.checkIDsForSelector(k)&&Kameleoon.Analyst.checkClassesForSelector(k)&&Kameleoon.Analyst.checkContainsTextesForSelector(k,j)){var d=Kameleoon.Utils.querySelectorAll(k.selector,n);if(0<d.length){Kameleoon.Utils.runProtectedFunction(function(){k.targetFunction(d)});Kameleoon.Internals.runtime.waitingElementPresentObjects.splice(q,1)}}}}}}})})}a={attributes:true,childList:true,characterData:true,subtree:true};if(typeof Kameleoon.Internals.runtime.mutationObserver.observe==="function"){Kameleoon.Internals.runtime.mutationObserver.observe(b,a)}},addMutationElementsToInternalObjects:function(e){for(var b=0;b<e.length;++b){var c=e[b];if(c&&c.id){if(Kameleoon.Internals.runtime.addedIDs.indexOf("#"+c.id)===-1){Kameleoon.Internals.runtime.addedIDs.push("#"+c.id)}}if(c&&c.className&&typeof c.className==="string"){var d=c.className.split(" ");for(var a=0;a<d.length;++a){if(Kameleoon.Internals.runtime.addedClasses.indexOf("."+d[a])===-1){Kameleoon.Internals.runtime.addedClasses.push("."+d[a])}}}}},removeMutationElementsFromInternalObjects:function(a){for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.id){if(Kameleoon.Internals.runtime.addedIDs.indexOf("#"+c.id)!==-1){var d=Kameleoon.Internals.runtime.addedIDs.indexOf(c.id);Kameleoon.Internals.runtime.addedIDs.splice(d,1)}}}},fillInternalObjectsForMutationObserver:function(a){if(!a){a=document}var d=a.getElementsByTagName("*");for(var e=0,g=d.length;e<g;++e){var c=d[e];if(c.id&&(Kameleoon.Internals.runtime.addedIDs.indexOf("#"+c.id)===-1)){Kameleoon.Internals.runtime.addedIDs.push("#"+c.id)}if(c.className&&typeof c.className==="string"){var b=c.className.split(" ");for(var f=0;f<b.length;++f){if(Kameleoon.Internals.runtime.addedClasses.indexOf("."+b[f])===-1){Kameleoon.Internals.runtime.addedClasses.push("."+b[f])}}}}},checkIDsForSelector:function(h){var f=h.selector;var m;if(h.currentQuery){m=h.currentQuery}var k;if(h.options){k=h.options.domReference}var e=[];if(f&&f.indexOf("#")!==-1){if(!h.selectorIDs||h.selectorIDs.length===0){if(f.indexOf("contains")!==-1){var j=f.match(/:contains\(['"]([\s\S]+)['"]\)/);var g=f.replace(j[0],"");e=g.match(/#([^\s:\[]+)/g)}else{e=f.match(/#([^\s:\[>]+)/g)}h.selectorIDs=e;if(m&&m.indexOf("#")!==-1){if(m.indexOf("contains")!==-1){var j=m.match(/:contains\(['"]([\s\S]+)['"]\)/);var c=m.replace(j[0],"");e=c.match(/#([^\s:\[]+)/g)}else{e=m.match(/#([^\s:\[]+)/g)}}for(var l=0,d=e.length;l<d;++l){if(h.selectorIDs.indexOf(e[l])===-1){h.selectorIDs.push(e[l])}}}}else{return true}for(var b=0,i=h.selectorIDs.length;b<i;++b){var a=h.selectorIDs[b];if(a.indexOf("kameleoonElement")!==-1){if(k&&!Kameleoon.Analyst.checkIDsForSelector({selector:k,checkDomReference:true})){return false}if(h.checkDomReference){if(Kameleoon.Internals.runtime.addedIDs.indexOf(a)===-1){return false}}}else{if(Kameleoon.Internals.runtime.addedIDs.indexOf(a)===-1){return false}}}return true},checkClassesForSelector:function(d){var b=d.selector;var h=[];if(b&&b.indexOf(".")!==-1){if(!d.selectorClasses||d.selectorClasses.length===0){if(b.indexOf("contains")!==-1){var c=b.match(/:contains\(['"]([\s\S]+)['"]\)/);var g=b.replace(c[0],"");h=g.match(/\.([^\s.:\[]+)/g)}h=b.match(/\.([^\s.:\[]+)/g);d.selectorClasses=h}}else{return true}for(var e=0,a=d.selectorClasses.length;e<a;++e){var f=d.selectorClasses[e];if(f.indexOf("kameleoon")===-1&&Kameleoon.Internals.runtime.addedClasses.indexOf(f)===-1){return false}}return true},checkContainsTextesForSelector:function(e,d){var a=e.selector;var c;if(d&&d.nodeType==Node.TEXT_NODE){if(a&&a.indexOf("contains")!==-1){if(!e.selectorContainsText){var b=a.match(/:contains\(['"]([\s\S]+)['"]\)/);c=b[1];e.selectorContainsText=c;if(d.nodeValue&&d.nodeValue.indexOf(c)===-1){return false}}}else{return false}}return true},processGlobalScript:function(){if(Kameleoon.Internals.configuration.globalScript&&!Kameleoon.Internals.runtime.globalScriptProcessed&&!Kameleoon.Internals.runtime.editorMode&&!Kameleoon.Internals.runtime.kameleoonSelectionIframeMode){Kameleoon.Internals.runtime.globalScriptProcessed=true;eval(Kameleoon.Internals.configuration.globalScript)}},performTargetingSegmentsTracking:function(a){if(Kameleoon.Internals.runtime.gathererRun){var c=[];for(var d=0,b=a.length;d<b;++d){c.push(a[d].id)}Kameleoon.Gatherer.trackTargetingSegments(c)}},performContainersTracking:function(containers){var containersTrackingNotPerformed=[];for(var i=0,l=containers.length;i<l;++i){var container=containers[i];if(container.trackingPerformed||!container.registeredVariation){continue}containersTrackingNotPerformed.push(container)}containers=containersTrackingNotPerformed;var containersKameleoonTrackingToTrack=[];var containersKameleoonTrackingNotToTrack=[];var containersMentalistActionsTracking=[];var containersMentalistPredictionTargetingTracking=[];for(var i=0,l=containers.length;i<l;++i){var sendContainerTracking=true;var container=containers[i];if(!container.experimentContainer){if("reference"!=container.displayedVariation.id){Kameleoon.Internals.configuration.displayedPersonalizations.push({id:container.id,name:container.name})}if(container.api){Kameleoon.Internals.configuration.activePersonalizations.push(container.name)}if("GLOBAL_CAPPING_NUMBER_VISITORS"==container.notExposedReason||"SCHEDULING"==container.notExposedReason||"INTERACTIONS"==container.notExposedReason||"PRIORITY"==container.notExposedReason){sendContainerTracking=false}Kameleoon.Internals.runtime.apiPersonalizations.update()}var variation=container.registeredVariation;if(container.mentalistEnabled){variation.name+=" (Predicteo)"}if(Kameleoon.Internals.configuration.checkTestedTrafficActive&&!container.counterActive&&container.experimentContainer){container.counterActive=true;var requestPrefix="//tlp-"+this.obtainTrackerNodeCodeDeterministic(Kameleoon.Internals.configuration.siteCode)+"."+Kameleoon.Internals.configuration.DOMAIN+"/counter.gif?";this.validateTrackingRequest(function(){Kameleoon.Utils.performBeaconServerCall(requestPrefix+"siteCode="+Kameleoon.Internals.configuration.siteCode+"&anniversaryDay="+Kameleoon.Internals.configuration.anniversaryDay)}.bind(this));this.writeExperimentLocalData(container)}if(sendContainerTracking&&(container.experimentContainer||container.exposition||(!container.exposition&&container.notExposedReason=="CUSTOM_EXPOSITION_RATE"))){this.validateTrackingRequest(function(){if(container.googleAnalyticsTracking){this.processGoogleAnalyticsTracking(container)}if(container.kissMetricsTracking){this.processKissMetricsTracking(container)}if(container.piwikTracking){this.processPiwikTracking(container)}if(container.comScoreTracking){this.processComScoreTracking(container)}if(container.crazyEggTracking){this.processCrazyEggTracking(container)}if(container.universalAnalyticsTracking){this.processUniversalAnalyticsTracking(container)}if(container.econdaTracking){this.processEcondaTracking(container)}if(container.atInternetTracking){this.processATInternetTracking(container)}if(container.adobeOmnitureTracking){this.processAdobeOmnitureTracking(container)}if(container.webtrendsTracking){this.processWebtrendsTracking(container)}if(container.eulerianTracking){this.processEulerianTracking(container)}if(container.experimentContainer&&(Kameleoon.Internals.configuration.ysanceCustomVariable!=null)){this.processYsanceTracking(container)}if(container.mPathyTracking){this.processMPathyTracking(container)}if(container.contentSquareTracking){this.processContentSquareTracking(container)}}.bind(this))}(container.kameleoonTracking&&sendContainerTracking?containersKameleoonTrackingToTrack:containersKameleoonTrackingNotToTrack).push({type:(container.experimentContainer?"EXPERIMENT":"PERSONALIZATION"),id:container.id,variationId:("reference"==variation.id?null:(container.experimentContainer?variation.id:1)),mentalistDecision:(container.mentalistEnabled?true:false)});if(container.mentalist){containersMentalistActionsTracking.push(container)}if(container.mentalistPredictionTargetingTracking){containersMentalistPredictionTargetingTracking.push(container)}if(container.heatMapTracking){(function(container){Kameleoon.Utils.addEventListener(document,Kameleoon.Internals.runtime.mouseDownEvent,function(e){if(Kameleoon.Internals.runtime.editorMode||Kameleoon.Internals.runtime.kameleoonSelectionIframeMode||e.kameleoonCreated||!e.preventDefault||!document.createEvent||Kameleoon.Internals.runtime.touchMoveEvent){return}var x=(e.clientX!==undefined)?e.clientX:((e.changedTouches&&0<e.changedTouches.length)?e.changedTouches[0].clientX:null);var y=(e.clientY!==undefined)?e.clientY:((e.changedTouches&&0<e.changedTouches.length)?e.changedTouches[0].clientY:null);if(x!==null){x=x-(document.documentElement.clientWidth-container.heatMapTracking.pageWidth)*0.5;x=Math.round(x)}if(y!==null){y+=document.body.scrollTop}var requestPrefix="//tlp-"+Kameleoon.Analyst.obtainTrackerNodeCodeRandom()+"."+Kameleoon.Internals.configuration.DOMAIN+"/heatmap.gif?";Kameleoon.Analyst.validateTrackingRequest(function(){Kameleoon.Utils.performBeaconServerCall(requestPrefix+"x="+x+"&y="+y+"&siteCode="+Kameleoon.Internals.configuration.siteCode+"&experimentId="+container.id+"&variationId="+container.registeredVariation.id)}.bind(this))},true)})(container)}if(container.javaScriptTracking){try{eval(container.javaScriptTracking)}catch(exception){}}container.trackingPerformed=true}if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Gatherer.trackContainers(containersKameleoonTrackingToTrack,containersKameleoonTrackingNotToTrack)}if(containersMentalistActionsTracking.length>0){this.processMentalistActionsTracking(containersMentalistActionsTracking)}if(containersMentalistPredictionTargetingTracking.length>0){this.processMentalistPredictionTargetingTracking(containersMentalistPredictionTargetingTracking)}},addCSSStyleSheet:function(f,a,c){if(!f){return}var i=c?c:document;var b="kameleoonStyleSheet"+(a?("-"+a.id):"");var d=c?c.getElementById(b):null;var e="";if(d){e=d.textContent;d.parentNode.removeChild(d)}var h=i.createElement("style");h.className="KameleoonStyleSheet";h.setAttribute("id",b);h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");h.setAttribute("media","screen");var g=e+f;if(h.styleSheet){h.styleSheet.cssText=g}else{h.appendChild(document.createTextNode(g))}if(c){i.getElementsByTagName("head")[0].appendChild(h,i.getElementsByTagName("head")[0].firstChild)}else{Kameleoon.Internals.runtime.headNode.appendChild(h)}if(a){a.loadedCSSStyleSheet=h}},removeCSSStyleSheet:function(a){if(a.loadedCSSStyleSheet){var b=a.loadedCSSStyleSheet.id.replace("kameleoonStyleSheet-","");if(-1==b.indexOf(",")){Kameleoon.Internals.runtime.headNode.removeChild(a.loadedCSSStyleSheet);a.loadedCSSStyleSheet=null}else{a.loadedCSSStyleSheet.id="kameleoonStyleSheet-"+b.replace(new RegExp(a.id+",?"),"")}}},findExperiment:function(a){return Kameleoon.Utils.findObjectWithId(a,Kameleoon.Internals.runtime.experiments)},findVariation:function(a){return Kameleoon.Utils.findObjectWithId(a,Kameleoon.Internals.runtime.variations)},associateContainerAndVariation:function(a,h,g){var d=true;var f=true;if("REGISTERED_VARIATION"==g){f=false}if("DISPLAYED_VARIATION"==g){d=false}if("none"==h){a.trackingPerformed=true;h="reference";d=false}var c=this.findVariation(h);var e="Reference";if(a&&a.variations){a.variations.forEach(function(j,i){if(j.id&&j.name&&j.id.toString()==h){e=j.name}})}var b=a.associatedVariation;if(a&&b&&h==b.id){e=b.name}if(a&&d){a.registeredVariation={id:h,name:e}}if(c){if(a&&((Kameleoon.Internals.runtime.simulationMode&&"simulation"==a.id)||(!a.associationMade))){if(d){a.registeredVariation=c;a.associationMade=true}if(f){a.displayedVariation=c}c.container=a;if(a.experimentContainer){c.experiment=a}else{c.personalization=a}}}else{a.displayedVariation={id:h,name:e}}if(a.displayedVariation&&!a.displayedVariation.elementSets){this.loadVariationData(a)}},writeExperimentLocalData:function(a){var b=a.registeredVariationId+(a.mentalistEnabled?"-mentalist":"")+"/"+a.assignmentTime+"/"+a.counterActive;if(!a.simulationMode){Kameleoon.Utils.createLocalData("kameleoonExperiment-"+a.id,b,a.cookieDuration?a.cookieDuration:30,a.cookieDomain,null,false)}},processReplaceData:function(d){if(document&&document.body){var f=function(i){var h=true,g=i.parentNode,j;if(g){j=g.getAttribute("id")}if(Kameleoon.Internals.runtime.editorMode){if((j&&j.match("kameleoon")!==null)||(g.closest&&g.closest(".KameleoonProtected")!==null)){h=false}}if(g.nodeName==="SCRIPT"||g.nodeName==="STYLE"){h=false}if(h){return NodeFilter.FILTER_ACCEPT}};var b=f;b.acceptNode=f;var e=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,b,false);while(e.nextNode()){for(var c=0;c<d.length;++c){var a=new RegExp(d[c].toReplace,"gi");if(!d[c].disabled&&e.currentNode.nodeValue&&a.test(e.currentNode.nodeValue)){Kameleoon.Analyst.saveElementOriginalData(e.currentNode);e.currentNode.kameleoonData.powered=true;e.currentNode.nodeValue=e.currentNode.nodeValue.replace(a,d[c].replaceBy)}}}}},saveElementOriginalData:function(c){if((!c)||(c.kameleoonData&&c.kameleoonData.originalData)){return}if(!c.kameleoonData){c.kameleoonData={}}c.kameleoonData.originalData={};c.kameleoonData.originalData.attributesData={};if(c.parentNode){c.kameleoonData.originalData.parentNode=c.parentNode}if(c.nextSibling){c.kameleoonData.originalData.nextSibling=c.nextSibling}if(c.href){c.kameleoonData.originalData.href=c.getAttribute("href")}if(c.nodeValue){c.kameleoonData.originalData.nodeValue=c.nodeValue}if(c.attributes){for(var b=0,d=c.attributes.length;b<d;++b){var a=c.attributes[b];c.kameleoonData.originalData.attributesData[a.nodeName]=a.nodeValue}}},processUserPosition:function(b,e,a,d){if(a){switch(a.positionMode){case"ABSOLUTE_KEEP_SPACE":case"ABSOLUTE":if(d){var h=("ABSOLUTE_KEEP_SPACE"==a.positionMode)?b.kameleoonData.originalData.originalNode.offsetWidth:b.offsetWidth;if(h){Kameleoon.Utils.setStyle(e,"width",h+"px",("th"!=e.nodeName.toLowerCase()&&"td"!=e.nodeName.toLowerCase()))}}var g=null;var c=false;if(a.referenceElement){g=Kameleoon.Utils.querySelectorAll(a.referenceElement)[0];c=true}if(!g){g=document.body}if(g&&e.parentNode!=g){e.parentNode.removeChild(e);g.appendChild(e);if(!e.kameleoonData){e.kameleoonData={}}e.kameleoonData.moved=true}Kameleoon.Utils.setStyle(e,"position","absolute",false);var f=Kameleoon.Utils.obtainComputedStyle(e).left.replace("px","")/a.referenceWidth;Kameleoon.Utils.setStyle(e,"left",Math.round(f*g.offsetWidth)+"px",true);if(c){this.addRelativePositionToReferenceElement(g)}break;case"RELATIVE":Kameleoon.Utils.setStyle(e,"position","",false)}Kameleoon.Utils.setStyle(e,"top","",false);Kameleoon.Utils.setStyle(e,"left","",false);Kameleoon.Utils.setStyle(e,"right","",false);Kameleoon.Utils.setStyle(e,"bottom","",false);if(!d){Kameleoon.Utils.setStyle(e,"width","",false)}Kameleoon.Utils.setStyle(e,"height","",false)}},addRelativePositionToReferenceElement:function(a){if("absolute"!=Kameleoon.Utils.obtainComputedStyle(a).position&&document.body!=a){Kameleoon.Utils.setStyle(a,"position","relative",false)}},refreshForScreenResize:function(){for(var a=Kameleoon.poweredNodes.length,b=a-1;b>=0;--b){this.processUserPosition(Kameleoon.poweredNodes[b].originalElement,Kameleoon.poweredNodes[b].baseElement,data?data.userPosition:null,true)}},obtainProductTrackingRequestPrefix:function(a){return"//tlp-"+this.obtainTrackerNodeCodeDeterministic(a)+"."+Kameleoon.Internals.configuration.DOMAIN+"/sitemapper.gif?"},obtainTrackerNodeCodeRandom:function(){return Kameleoon.Internals.configuration.trackerNodeCodes[Math.floor(Kameleoon.Internals.configuration.trackerNodeCodes.length*Math.random())]},obtainTrackerNodeCodeDeterministic:function(a){return Kameleoon.Internals.configuration.trackerNodeCodes[Math.abs(Kameleoon.Utils.computeStringHash(a))%Kameleoon.Internals.configuration.trackerNodeCodes.length]},isValidTrackerNodeCode:function(a){return Kameleoon.Internals.configuration.trackerNodeCodes.indexOf(a)>=0},obtainTrackerNodeLogParserRandom:function(a){return Math.floor(Math.random()*Kameleoon.Internals.configuration.trackerNodeNumberLogParsers[Kameleoon.Internals.configuration.trackerNodeCodes.indexOf(a)])},obtainTrackerNodeLogParserDeterministic:function(b,a){return Math.abs(Kameleoon.Utils.computeStringHash(a))%Kameleoon.Internals.configuration.trackerNodeNumberLogParsers[Kameleoon.Internals.configuration.trackerNodeCodes.indexOf(b)]},isValidTrackerNodeLogParser:function(b,a){return a>=0&&a<Kameleoon.Internals.configuration.trackerNodeNumberLogParsers[Kameleoon.Internals.configuration.trackerNodeCodes.indexOf(b)]},processRequestsToValidate:function(){var e=Kameleoon.Internals.runtime.trackerRequestsToValidate;if(e!=null){var c=Kameleoon.Internals.configuration.trackerExcludedIPRanges.length>0;var d=Kameleoon.Internals.configuration.requestsDataLegalControl;if(((c&&Kameleoon.Internals.runtime.ipIsTrackerAccepted)||!c)&&((d&&Kameleoon.Internals.runtime.saveLocalDataAllowed)||!d)){for(var b=0,a=e.length;b<a;++b){e[b]()}delete Kameleoon.Internals.runtime.trackerRequestsToValidate}}},validateTrackingRequest:function(a){if(a!=null){var d=Kameleoon.Internals.runtime.ipIsTrackerAccepted;var b=Kameleoon.Internals.configuration.trackerExcludedIPRanges.length>0;var c=Kameleoon.Internals.configuration.requestsDataLegalControl;if(!b&&!c){a()}else{if((b&&d==null)||(c&&!Kameleoon.Internals.runtime.saveLocalDataAllowed)){if(Kameleoon.Internals.runtime.trackerRequestsToValidate==null){Kameleoon.Internals.runtime.trackerRequestsToValidate=[]}Kameleoon.Internals.runtime.trackerRequestsToValidate.push(a)}else{((b&&d)||(!b))&&a()}}}},processSimulationsData:function(){}};Kameleoon.Utils={LOCAL_STORAGE_OBFUSCATED_KEYS:{kameleoonData:true,kameleoonDataSimulation:true},api:{mapAll:function(c,b,a){b.forEach(function(e,d){a.push(Kameleoon.Utils.api.mapItems(c,b,d))});return a},mapItems:function(c,b,a){var f={},e;e=(b.constructor===Array&&a!==undefined)?b[a]:b;for(var d in e){if(e[d]!==undefined&&e[d]!==null&&c.indexOf(d)===-1){f[d]=e[d]}}return f}},addEventListener:function(e,d,c,b){if(Kameleoon.Internals.runtime.eventListeners==null){Kameleoon.Internals.runtime.eventListeners=[]}var a=e.addEventListener(d,c,b);Kameleoon.Internals.runtime.eventListeners.push({element:e,eventType:d,actionFunction:c,useCapture:b});return a},setTimeout:function(){if(Kameleoon.Internals.runtime.timeoutIds==null){Kameleoon.Internals.runtime.timeoutIds={}}var a=window.setTimeout.apply(window,arguments);Kameleoon.Internals.runtime.timeoutIds[a]=true;return a},clearTimeout:function(a){delete Kameleoon.Internals.runtime.timeoutIds[a];window.clearTimeout(a)},setInterval:function(){if(Kameleoon.Internals.runtime.intervalIds==null){Kameleoon.Internals.runtime.intervalIds={}}var a=window.setInterval.apply(window,arguments);Kameleoon.Internals.runtime.intervalIds[a]=true;return a},clearInterval:function(a){delete Kameleoon.Internals.runtime.intervalIds[a];window.clearInterval(a)},findObjectWithId:function(a,c){for(var e=0,b=c.length;e<b;++e){var d=c[e];if(a==d.id){return d}}return null},computeCurrentPageCanonicalURL:function(){if(Kameleoon.Internals.runtime.currentPageCanonicalURL==null){var a=this.querySelectorAll('link[rel="canonical"]');if(a.length>0){Kameleoon.Internals.runtime.currentPageCanonicalURL=a[0].href}}return Kameleoon.Internals.runtime.currentPageCanonicalURL},computeCurrentPageCleanAbsoluteURL:function(){if(Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL==null){Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL=this.computeURLNoKameleoonParameters(this.computeCurrentPageAbsoluteURLNoProxyMode());try{Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL=decodeURIComponent(Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL)}catch(a){}}return Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL},computeCurrentPageCleanRelativeURL:function(){if(Kameleoon.Internals.runtime.currentPageCleanRelativeURL==null){Kameleoon.Internals.runtime.currentPageCleanRelativeURL=this.computeRelativeURL(this.computeCurrentPageCleanAbsoluteURL())}return Kameleoon.Internals.runtime.currentPageCleanRelativeURL},computeCurrentPageAbsoluteURLNoProxyMode:function(){if(Kameleoon.Internals.runtime.currentPageAbsoluteURLNoProxyMode==null){if(Kameleoon.Internals.runtime.proxyMode){var d=Kameleoon.Internals.runtime.parameters.kameleoonExperimentId;if(d==null){d=Kameleoon.Internals.runtime.parameters["kameleoon-experiment-id"]}if(d!=null){for(var c=0,b=Kameleoon.Internals.runtime.experiments.length;c<b;++c){var a=Kameleoon.Internals.runtime.experiments[c];if(a.id==d){Kameleoon.Internals.runtime.currentPageAbsoluteURLNoProxyMode=a.baseURL;break}}}}if(Kameleoon.Internals.runtime.currentPageAbsoluteURLNoProxyMode==null){Kameleoon.Internals.runtime.currentPageAbsoluteURLNoProxyMode=window.location.href}}return Kameleoon.Internals.runtime.currentPageAbsoluteURLNoProxyMode},computeURLNoKameleoonParameters:function(a){return a.replace(/(\?|&|#)kameleoon[^&#]*/g,"")},computeURLRegExpNoKameleoonParameters:function(a){return a.replace(/(\\\?|&|#)kameleoon[^&#()]*/g,"")},computeRelativeURL:function(c){var b=document.createElement("a");b.href=c;return b.pathname+b.search+b.hash},computeStringHash:function(a){var c=0;for(var b=0;b<a.length;++b){c=((c<<5)-c)+a.charCodeAt(b);c=c&c}return c},isInsideHoursMinutesRange:function(f,i,d,b,h,c){if(b==0){d--;if(d==-1){d=23}b=60}if((d<f)||((d==f)&&(b<i))){d+=24;if((h<f)||((h==f)&&(c<i))){h+=24}}var a=((h*60)+c)*60*1000;var g=((f*60)+i)*60*1000;var e=((d*60)+b)*60*1000;return(a>=g)&&(a<e)},seededRandom:function(a){var b=this.computeStringHash(a);b=(Math.abs(b)*9301+49297)%233280;return b/233280},testEmptyMap:function(a){return this.JSONStringify(a)===this.JSONStringify({})},JSONParse:function(string){return(((typeof JSON!="undefined")&&JSON.parse)?JSON.parse(string):eval("("+string+")"))},JSONStringify:function(a){var c=null;if((typeof JSON!="undefined"&&JSON.stringify)&&("[]"===JSON.stringify([])||!a.toJSON)){var b=Array.prototype.toJSON;if(b){delete Array.prototype.toJSON}c=JSON.stringify(a);if(b){Array.prototype.toJSON=b}}else{if(a.toJSON&&"[]"===[].toJSON()){c=a.toJSON()}else{if((typeof JSON!="undefined"&&JSON.encode)&&"[]"===JSON.encode([])){c=JSON.encode(a)}}}return c},performBeaconServerCall:function(c,b,a,e){var d=new XMLHttpRequest();if(d.withCredentials!==undefined||!XDomainRequest){d.open("GET",c,true);if(b){d.onreadystatechange=function(f){b.bind(d)(f)}}if(a){d.onerror=function(f){a.bind(d)(f)};if(null!=e){e=parseInt(e);if(!isNaN(e)){d.timeout=e;d.ontimeout=function(f){a.bind(d)(f)}}}}d.send()}else{d=new XDomainRequest();d.open("get",c);if(b){d.onload=b}d.send()}},runProtectedFunction:function(b){try{b()}catch(a){if(typeof console!=="undefined"&&console.log){console.log("An error occurred in one of your Kameleoon custom JavaScript functions, please check your code. Experiment caused the error is "+Kameleoon.API.currentContainer.name+" : "+Kameleoon.API.currentContainer.id);console.log(a,a.message)}Kameleoon.API.processPageLoaded()}},obtainComputedStyle:function(a){if(window.getComputedStyle){var b=getComputedStyle(a,"");return b?b:{backgroundImage:"none"}}else{return a.currentStyle}},setStyle:function(c,f,e,b){Kameleoon.Analyst.saveElementOriginalData(c);var g=c.style.cssText;if(g){g=g.replace(/^\s+|\s+$/g,"");var a=new RegExp("(^|;)(\\s*"+f+"(.*?);)");g=g.replace(a,"$1");if(g){if(g.lastIndexOf(";")<(g.length-2)){g=g+";"}if(g.lastIndexOf(" ")!=(g.length-1)&&e){g=g+" "}}}else{g=""}var d=g+(e?(f+": "+e+(b?" !important;":";")):"");c.style.cssText=d},processMessageEvent:function(event){if(typeof event.data!=="string"){return}if("obtainTagCommanderVariableNames"==event.data){var tagCommanderVariableNames=[];if(window.tc_vars){for(var tagCommanderVariableName in window.tc_vars){tagCommanderVariableNames.push(tagCommanderVariableName)}}event.source.postMessage("tagCommanderVariableNames"+Kameleoon.Utils.JSONStringify(tagCommanderVariableNames),event.origin);return}if(0==event.data.indexOf("checkKameleoonScriptPresent")){if("https://back-office."+Kameleoon.Internals.configuration.DOMAIN==event.origin){var resultMessage="";var obtainScriptInstallationCode=event.data.replace("checkKameleoonScriptPresent","");eval(obtainScriptInstallationCode);event.source.postMessage(resultMessage,event.origin)}return}if(Kameleoon.Internals.configuration.useWideDomainSupport&&(Kameleoon.Internals.runtime.postMessageOrigin==event.origin)){try{var messageData=Kameleoon.Utils.JSONParse(event.data);if(messageData.kameleoonMessage){if(messageData.callbackId){var callback=Kameleoon.Internals.runtime.postMessageCallbacks[messageData.callbackId];delete (Kameleoon.Internals.runtime.postMessageCallbacks[messageData.callbackId]);callback&&callback(messageData.data)}if(null!=messageData.type){Kameleoon.Utils.processStorageData(messageData)}}}catch(e){}}},processStorageData:function(d){if(Kameleoon.Internals.runtime.setupAfterLocalDataRetrieval){if(this.LOCAL_STORAGE_OBFUSCATED_KEYS[d.type]){d.value=Kameleoon.Utils.JSONParse(Kameleoon.Utils.unobfuscateString(d.value));if(!Kameleoon.Internals.configuration.useWideDomainSupport){d.value=d.value.value}}switch(d.type){case"kameleoonExperiment":if(null!=Kameleoon.Internals.runtime.experiments){for(var c=0,b=Kameleoon.Internals.runtime.experiments.length;c<b;++c){var a=Kameleoon.Internals.runtime.experiments[c];if(d.experimentId==a.id){a.registeredVariationId=d.registeredVariationId;break}}}break;case"kameleoonPersonalizations":if(null!=Kameleoon.API.visitor){Kameleoon.API.visitor.personalizationsActive=d.active}break;case"kameleoonData":case"kameleoonDataSimulation":if((d.type=="kameleoonData"&&!Kameleoon.Internals.runtime.simulationMode)||(d.type=="kameleoonDataSimulation"&&Kameleoon.Internals.runtime.simulationMode)){Kameleoon.Internals.runtime.storedData=d.value;if(Kameleoon.Internals.runtime.gathererRun){Kameleoon.Visitor.setupFromStoredData(false)}}break;case"kameleoonLocalDataConsent":if(d.saveLocalDataAllowed){if(Kameleoon.Internals.runtime.saveLocalDataAllowed==null){Kameleoon.Analyst.allowSaveLocalData()}}break}}},addPostMessageCallback:function(b){var a=Math.random().toString();Kameleoon.Internals.runtime.postMessageCallbacks[a]=b;return a},postMessageToExternalIframe:function(a){Kameleoon.Internals.runtime.externalIframe.contentWindow.postMessage("kameleoon"+a,"*")},encodeString:function(d){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var a="";var l,j,g,k,h,f,e;var c=0;d=this.encodeUTF8(d);while(c<d.length){l=d.charCodeAt(c++);j=d.charCodeAt(c++);g=d.charCodeAt(c++);k=l>>2;h=((l&3)<<4)|(j>>4);f=((j&15)<<2)|(g>>6);e=g&63;if(isNaN(j)){f=e=64}else{if(isNaN(g)){e=64}}a=a+b.charAt(k)+b.charAt(h)+b.charAt(f)+b.charAt(e)}return a},decodeString:function(d){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var a="";var l,j,g;var k,h,f,e;var c=0;d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<d.length){k=b.indexOf(d.charAt(c++));h=b.indexOf(d.charAt(c++));f=b.indexOf(d.charAt(c++));e=b.indexOf(d.charAt(c++));l=(k<<2)|(h>>4);j=((h&15)<<4)|(f>>2);g=((f&3)<<6)|e;a=a+String.fromCharCode(l);if(f!=64){a=a+String.fromCharCode(j)}if(e!=64){a=a+String.fromCharCode(g)}}a=this.decodeUTF8(a);return a},obfuscateString:function(c){var e="";for(var d=0,a=c.length;d<a;d+=1){var b=c[d];if(b=="’"){b="'"}e+=String.fromCharCode(b.charCodeAt(0)+16)}return e},unobfuscateString:function(d){var b="";for(var c=0,a=d.length;c<a;c+=1){b+=String.fromCharCode(d[c].charCodeAt(0)-16)}return b},encodeUTF8:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},decodeUTF8:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b},saveStoredData:function(a){this.createLocalData(Kameleoon.Internals.runtime.simulationMode?"kameleoonDataSimulation":"kameleoonData",Kameleoon.Internals.runtime.storedData||{},Kameleoon.Internals.runtime.simulationMode?(1/24):380,null,"LS",true,a)},createLocalData:function(a,i,k,f,d,c,l,m){var j=("LS"==d)?true:(("COOKIE"==d)?false:Kameleoon.Internals.configuration.useLocalStorage);var b=new Date().getTime();if((!m)&&(!Kameleoon.Internals.runtime.saveLocalDataAllowed)){var h=j?"LS":"COOKIE";if(Kameleoon.Internals.runtime.localDataMap==null){Kameleoon.Internals.runtime.localDataMap={}}if(Kameleoon.Internals.runtime.localDataMap[h]==null){Kameleoon.Internals.runtime.localDataMap[h]={}}Kameleoon.Internals.runtime.localDataMap[h][a]={name:a,value:i,days:k,domain:f,forceLocalAccess:d,jsonFormat:c,creationTime:b};if(j){l&&l()}return}if(j){var e=b+(k*24*60*60*1000);if(Kameleoon.Internals.configuration.useWideDomainSupport){this.postMessageToExternalIframe(this.JSONStringify({type:"set",key:a,data:{value:this.LOCAL_STORAGE_OBFUSCATED_KEYS[a]&&this.obfuscateString(this.JSONStringify(i))||i,date:e},callbackId:this.addPostMessageCallback(l)}))}else{var g=this.JSONStringify({value:i,date:e});localStorage.setItem(a,this.LOCAL_STORAGE_OBFUSCATED_KEYS[a]&&this.obfuscateString(g)||g);l&&l()}}else{var n="";if(k){var e=new Date(b+(k*24*60*60*1000));n="; expires="+e.toGMTString()}if("CURRENT_HOST"!=f){f=f||this.obtainCurrentRootDomain();n+="; domain="+f}document.cookie=a+"="+(c?this.JSONStringify(i):i)+n+"; path=/"}},readLocalData:function(b,h,f){var q=("LS"==h)?true:(("COOKIE"==h)?false:Kameleoon.Internals.configuration.useLocalStorage);var g=new Date().getTime();try{if(!Kameleoon.Internals.runtime.saveLocalDataAllowed){var a=Kameleoon.Internals.runtime.localDataMap;var m=q?"LS":"COOKIE";if((a!=null)&&(a[m]!=null)&&(a[m][b]!=null)){var k=a[m][b];if(g-(k.days*24*60*60*1000)>=k.creationTime){delete a[m][b]}else{return k.value}}}if(q){var k=localStorage&&localStorage.getItem(b);if(!k){return null}if(this.LOCAL_STORAGE_OBFUSCATED_KEYS[b]){k=this.unobfuscateString(k)}k=this.JSONParse(k);if(g>k.date){localStorage.removeItem(b);return null}return k.value}else{var d=null;var p=document.cookie.split(";");for(var j=0,r=p.length;j<r;++j){var c=p[j];var o=c.indexOf("=");if(c.substring(0,o).trim()==b){var n=c.substring(o+1);d=f&&Kameleoon.Utils.JSONParse(n)||n;break}}return d}}catch(l){}return null},eraseLocalData:function(b,c,f){var e=("LS"==f)?true:(("COOKIE"==f)?false:Kameleoon.Internals.configuration.useLocalStorage);if(!Kameleoon.Internals.runtime.saveLocalDataAllowed){var d=Kameleoon.Internals.runtime.localDataMap;var a=e?"LS":"COOKIE";if((d!=null)&&(d[a]!=null)&&(d[a][b]!=null)){delete d[a][b]}}if(e){if(Kameleoon.Internals.configuration.useWideDomainSupport){this.postMessageToExternalIframe(this.JSONStringify({type:"remove",key:b,callbackId:this.addPostMessageCallback(null)}))}else{localStorage.removeItem(b)}}else{this.createLocalData(b,"",-1,c,"COOKIE",false,null,true)}},obtainCurrentRootDomain:function(){if(Kameleoon.Internals.runtime.currentRootDomain==null){var d=window.location.hostname.split(".");var c="";for(var b=0,a=d.length;b<a;b++){if(b>0){c="."+c}c=d[a-b-1]+c;this.createLocalData("kameleoonTestCookie","test",1,c,"COOKIE",false,undefined,true);if(this.readLocalData("kameleoonTestCookie","COOKIE",false)){this.eraseLocalData("kameleoonTestCookie",c,"COOKIE");Kameleoon.Internals.runtime.currentRootDomain=c;break}}}return Kameleoon.Internals.runtime.currentRootDomain},obtainRandomString:function(e,f){if(f==null){f=Kameleoon.Analyst.CODE_ALPHABET}var b=f.length;var a="";for(var c=0;c<e;++c){var d=Math.floor(Math.random()*b);a+=f.substring(d,d+1)}return a},parseParameters:function(){var e={};var a=window.location.search.substring(1);if(a){a=a.split("&");for(var d=0,b=a.length;d<b;++d){var f=a[d].split("=");try{e[decodeURIComponent(f[0])]=f[1]?decodeURIComponent(f[1]):null}catch(c){e[unescape(f[0])]=f[1]?unescape(f[1]):null}}}a=window.location.hash.substring(1);if(Kameleoon.Internals.runtime.firefox){a=window.location.toString().substring(window.location.toString().indexOf("#")+1)}a=a.replace(/\?/g,"&");if(a){a=a.split("&");for(var d=0,b=a.length;d<b;++d){var f=a[d].split("=");try{e[decodeURIComponent(f[0])]=f[1]?decodeURIComponent(f[1]):null}catch(c){e[unescape(f[0])]=f[1]?unescape(f[1]):null}}}return e},addParameterToURL:function(a,d,c){if(c){return(a+((-1==a.indexOf("#"))?"#":"&")+d)}var b="";if(-1!=a.indexOf("#")){b=a.substr(a.indexOf("#"));a=a.substr(0,a.indexOf("#"))}a+=((-1==a.indexOf("?"))?"?":"&")+d+b;return a},removeBlockingStyleSheet:function(){var a=document.getElementById("kameleoonPageLoading");if(a&&a.parentNode){a.parentNode.removeChild(a)}},domReady:function(b){if("complete"==document.readyState||"loaded"==document.readyState||("interactive"==document.readyState&&(!Kameleoon.Internals.runtime.msie||Kameleoon.Internals.runtime.modernMsie))){return b()}var a=false;window.addEventListener("load",function(){if(a){return}a=true;b()},false);return Kameleoon.Utils.addEventListener(document,"DOMContentLoaded",function(){if(a){return}a=true;b()},false)},obtainDepth:function(b){var a=0;while(!(b.parentNode===null)){++a;b=b.parentNode}return a},collectionToArray:function(d){var a=[];for(var c=0,b=d.length;c<b;++c){a.push(d[c])}return a},getLocale:function(b){var a=null;if(navigator){if(navigator.language){a=navigator.language}else{if(navigator.browserLanguage){a=navigator.browserLanguage}else{if(navigator.systemLanguage){a=navigator.systemLanguage}else{if(navigator.userLanguage){a=navigator.userLanguage}}}}}if("fr-FR"==a){a="fr"}if("en-US"==a){a="en"}if(b&&(!a||"fr"!=a)){a="en"}return a},callJavaScriptCode:function(b){var a=document.createElement("script");a.type="text/javascript";Kameleoon.Internals.runtime.headNode.appendChild(a);if(Kameleoon.Internals.runtime.msie){a.text=b}else{a.appendChild(document.createTextNode(b))}},checkElementLoaded:function(a){if(!a||!a.parentNode){return false}return((a.nextSibling)?true:this.checkElementLoaded(a.parentNode))},checkElementIsInDocument:function(c,a){var b=null,d=document;if(a.context){b=Kameleoon.Utils.querySelectorAll(a.context);if(b[0]){d=b[0].contentWindow.document}}while(c&&c!=d.documentElement&&c!=Kameleoon.Internals.runtime.virtualRootElement){if(c.parentNode){c=c.parentNode}else{return false}}return(c==d.documentElement)?true:"VIRTUAL"},clone:function(a){return this.JSONParse(this.JSONStringify(a))},treatContainsSelector:function(a){var d={},c;function b(g,e){var f=false;if(e.textContent&&e.textContent.indexOf(g)!==-1){f=true}return f}c=a.match(/:contains\(['"]([\s\S]+)['"]\)/);d.containText=c[1];d.newSelector=a.replace(c[0],"");if(d.newSelector===""){d.newSelector="*"}d.check=b;return d},treatEqSelector:function(b,k){if(b===undefined){return null}var f=b.split(/\:eq\([0-9]+\)/g);var g=b.match(/(?!\:eq\()[0-9]+/g)||[];var a=k==null?document:k;for(var e=0;e<f.length;++e){f[e]=f[e].trim();if(f[e].charAt(0)===">"){f[e]=f[e].substring(1,b.length).trim()}if(a==null||f[e].trim()==""){break}if(e>g.length-1){a=a.querySelectorAll(f[e])}else{a=a.querySelectorAll(f[e])[g[e]]}}if(null==a){return[]}if(undefined==a.length){a=[a]}var h=Kameleoon.Utils.querySelectorAll(b.replace(/\:eq\([0-9]+\)/g,""));var c=[];for(var e=0;e<h.length;++e){for(var d=0;d<a.length;++d){if(h[e]===a[d]){c.push(a[d]);break}}}return c},querySelectorAll:function(g,r){Kameleoon.Internals.runtime.querySelectorAllHasError=false;var o=false,m,d=[],p=[];if(r==null){r=document}var h=g.match(/#([0-9]+.*)(?: |$)/);if(h){var q=g.charAt(1);g=g.replace("#"+q,"#\\3"+q+" ")}if(g!==""){if(g.indexOf("[")!==-1&&g.indexOf("']")===-1&&g.indexOf('"]')===-1){var k=g.split(/(?=\.)|(?=#)|(?=\[)/),a,c,b;k.forEach(function(e){if(e[0]==="["&&e.indexOf("']")===-1&&g.indexOf('"]')===-1&&g.indexOf("=")!==-1){a=e.split(/=(.+)?/);c=a[1];c=c.substring(0,c.length-1);b=a[0]+"='"+c+"']";g=g.replace(e,b)}})}if(g.indexOf(":contains")!==-1){o=true;m=this.treatContainsSelector(g);g=m.newSelector}if(r&&r.querySelectorAll){if(g.indexOf(":eq")!==-1){d=this.treatEqSelector(g,r)}else{try{d=r.querySelectorAll(g)}catch(n){Kameleoon.Internals.runtime.querySelectorAllHasError=true;console.log("querySelector:",n);d=[]}}}for(var j=0,f=d.length;j<f;++j){if(o){if(m.check(m.containText,d[j])){p.push(d[j])}}else{p.push(d[j])}}}return p},flatten:function(){var b=[];for(var a=0;a<arguments.length;a++){if(arguments[a] instanceof Array){b.push.apply(b,Kameleoon.Utils.flatten.apply(this,arguments[a]))}else{b.push(arguments[a])}}return b},flattenTargetingTree:function(b){var a=function(f,d){if(f!=null){if(f.targetingCondition!=null){return f.targetingCondition.targeting===false?["!",f.targetingCondition]:f.targetingCondition}else{var e=f.orOperator?"OR":"AND";var c=[a(f.leftChild,e),e,a(f.rightChild,e)];return d=="AND"&&e=="OR"?["(",c,")"]:c}}};return Kameleoon.Utils.flatten(a(b,"OR"))},checkIfImageWasSeen:function(e,d){if(Kameleoon.Internals.runtime.gathererRun&&"object"==typeof e){var c=Math.random().toString();if(null==Kameleoon.Internals.runtime.checkImageCallbacks){Kameleoon.Internals.runtime.checkImageCallbacks={}}var a=[];for(var b=0;b<e.length;++b){a.push({url:e[b]})}Kameleoon.Internals.runtime.checkImageCallbacks[c]=d;Kameleoon.Gatherer.checkImageList(a,null,c)}},computeDisplayableTargetingTree:function(e){var g=new Array();var b=new Array();this.computeDisplayableTargetingTreeFirstLevelAddIn(e,g,b);if(b.length>0){var a=new Array();var d=new Array();var c=this.createIterator(g);var h=this.createIterator(b);while(h.hasNext()){var f=h.next();if(this.testEmptyMap(f.conditions)){if(h.hasNext()){c.next()}}else{d.push(f);if(h.hasNext()){a.push(c.next())}}}g=d.length>0?a.slice(0,d.length-1):a;b=d}return{firstLevelOrOperators:g,secondLevel:b}},computeDisplayableTargetingTreeFirstLevelAddIn:function(b,c,a){if(null!=b){if(null==b.targetingCondition){if(0==b.orGuiLevel){this.computeDisplayableTargetingTreeFirstLevelAddIn(b.leftChild,c,a);c.push(b.orOperator);this.computeDisplayableTargetingTreeFirstLevelAddIn(b.rightChild,c,a)}else{a.push(this.computeDisplayableTargetingTreeSecondLevel(b))}}else{a.push(this.computeDisplayableTargetingTreeSecondLevel(b))}}},computeDisplayableTargetingTreeSecondLevel:function(b){var a=new Array();var f=new Array();this.computeDisplayableTargetingTreeSecondLevelAddIn(b,a,f);if(f.length>0){var h=new Array();var d=new Array();var c=this.createIterator(a);var e=this.createIterator(f);while(e.hasNext()){var g=e.next();if(g.disabled){if(e.hasNext()){c.next()}}else{d.push(g);if(e.hasNext()){h.push(c.next())}}}a=d.length>0?h.slice(0,d.length-1):h;f=d}return{orOperators:a,conditions:f}},computeDisplayableTargetingTreeSecondLevelAddIn:function(b,a,c){if(b!=null){if(b.targetingCondition==null){this.computeDisplayableTargetingTreeSecondLevelAddIn(b.leftChild,a,c);a.push(b.orOperator);this.computeDisplayableTargetingTreeSecondLevelAddIn(b.rightChild,a,c)}else{c.push(b.targetingCondition)}}},createIterator:function(b){var a=0;return{hasNext:function(){return a<b.length},next:function(){return b[a++]}}},ipAddressMatchesRange:function(c,b){var a=c.split(".");var d=b.split(".");return a.length==4&&d.length==4&&this.ipAdressBlockMatchesRangeBlock(a[0],d[0])&&this.ipAdressBlockMatchesRangeBlock(a[1],d[1])&&this.ipAdressBlockMatchesRangeBlock(a[2],d[2])&&this.ipAdressBlockMatchesRangeBlock(a[3],d[3])},ipAdressBlockMatchesRangeBlock:function(c,d){if(d==c){return true}if(d=="*"){return true}var e=parseInt(c);var b=d.split("-");var f=parseInt(b[0]);var a=b.length>1?parseInt(b[1]):f;if(!isNaN(e)&&!isNaN(f)&&!isNaN(a)&&e>=f&&e<=a){return true}return false},Event:(function(){function c(){this.subscribers={};this.key=0}c.prototype.subscribe=function b(i){var g=this.key;this.subscribers[g]=i;++this.key;this.onSubscribe(g);return function h(){this.onUnsubscribe(g);delete this.subscribers[g]}.bind(this)};c.prototype.emit=function d(){for(var f in this.subscribers){this.subscribers[f].apply(null,arguments)}};c.prototype.onSubscribe=function e(f){};c.prototype.onUnsubcribe=function a(f){};c.prototype.filter=function(h){var g=new c();this.subscribe(function(){if(h.apply(null,arguments)){g.emit.apply(g,arguments)}});return g};c.prototype.map=function(h){var g=new c();this.subscribe(function(){g.emit(h.apply(null,arguments))});return g};c.prototype.memorize=function(){var g=new c();var f=[];this.subscribe(function(){f.push(arguments);g.emit.apply(g,arguments)});g.onSubscribe=function(h){f.forEach(function(i){g.subscribers[h].apply(null,i)})};return g};return c})()};Kameleoon.Loader={enableKameleoonEditorListener:function(){if(!Kameleoon.Internals.runtime.editorListenerEnabled){Kameleoon.Internals.runtime.editorListenerEnabled=true;var a=function(b){if(!b){b=window.event}Kameleoon.Loader.listenKeys.call(Kameleoon.Loader,b)};Kameleoon.Utils.addEventListener(document,"keyup",a,false)}},listenKeys:function(a){if(a.shiftKey){if(113==a.keyCode&&Kameleoon.Internals.configuration.abtestingSetup){Kameleoon.Internals.runtime.editorMode=true;Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.enableKameleoonEditor.apply(Kameleoon.Loader)})}if(115==a.keyCode&&(Kameleoon.Internals.runtime.simulationMode||Kameleoon.Internals.runtime.parameters.kameleoonVariationSelection)){Kameleoon.Analyst.loadKameleoonFull(function(){Kameleoon.Loader.enableSimulationPanel()})}}}};Kameleoon.Analyst.evaluateTargeting_PAGE_URL=function(d){var a=new RegExp(Kameleoon.Utils.computeURLRegExpNoKameleoonParameters(d.value));var c;try{c=a.test(decodeURI(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL()))}catch(b){try{c=(window.unescape?a.test(unescape(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())):false)}catch(b){c=false}}return{targeting:c,rescheduleTargeting:false}};(function(a){var b=(function(){var d="s",g={DAY:86400000,HOUR:3600000,MINUTE:60000,SECOND:1000,BASELINE_YEAR:2014,MAX_SCORE:864000000,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"Europe/London":["Africa/Casablanca"],"America/Chicago":["America/Mexico_City"],"America/Asuncion":["America/Campo_Grande","America/Santiago"],"America/Montevideo":["America/Sao_Paulo","America/Santiago"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},f=function f(o){var p=-o.getTimezoneOffset();return(p!==null?p:0)},h=function h(){var o=f(new Date(g.BASELINE_YEAR,0,2)),p=f(new Date(g.BASELINE_YEAR,5,2)),q=o-p;if(q<0){return o+",1"}else{if(q>0){return p+",1,"+d}}return o+",0"},j=function j(){var p,o;if(typeof Intl==="undefined"||typeof Intl.DateTimeFormat==="undefined"){return}p=Intl.DateTimeFormat();if(typeof p==="undefined"||typeof p.resolvedOptions==="undefined"){return}o=p.resolvedOptions().timeZone;if(o&&(o.indexOf("/")>-1||o==="UTC")){return o}},i=function i(s){var v=new Date(s,0,1,0,0,1,0).getTime();var u=new Date(s,12,31,23,59,59).getTime();var r=v;var p=(new Date(r)).getTimezoneOffset();var t=null;var w=null;while(r<u-86400000){var q=new Date(r);var o=q.getTimezoneOffset();if(o!==p){if(o<p){t=q}if(o>p){w=q}p=o}r+=86400000}if(t&&w){return{s:k(t).getTime(),e:k(w).getTime()}}return false},k=function k(w,v,t){if(typeof v==="undefined"){v=g.DAY;t=g.HOUR}var q=new Date(w.getTime()-v).getTime();var x=w.getTime()+v;var s=new Date(q).getTimezoneOffset();var u=q;var p=null;while(u<x-t){var r=new Date(u);var o=r.getTimezoneOffset();if(o!==s){p=r;break}u+=t}if(v===g.DAY){return k(p,g.HOUR,g.MINUTE)}if(v===g.HOUR){return k(p,g.MINUTE,g.SECOND)}return p},n=function e(o,r,q,p){if(q!=="N/A"){return q}if(r==="Asia/Beirut"){if(p.name==="Africa/Cairo"){if(o[6].s===1398376800000&&o[6].e===1411678800000){return 0}}if(p.name==="Asia/Jerusalem"){if(o[6].s===1395964800000&&o[6].e===1411858800000){return 0}}}else{if(r==="America/Santiago"){if(p.name==="America/Asuncion"){if(o[6].s===1412481600000&&o[6].e===1397358000000){return 0}}if(p.name==="America/Campo_Grande"){if(o[6].s===1413691200000&&o[6].e===1392519600000){return 0}}}else{if(r==="America/Montevideo"){if(p.name==="America/Sao_Paulo"){if(o[6].s===1413687600000&&o[6].e===1392516000000){return 0}}}else{if(r==="Pacific/Auckland"){if(p.name==="Pacific/Fiji"){if(o[6].s===1414245600000&&o[6].e===1396101600000){return 0}}}}}}return q},m=function m(r,o){var y=function y(B){var C=0;for(var A=0;A<r.length;A++){if(!!B.rules[A]&&!!r[A]){if(r[A].s>=B.rules[A].s&&r[A].e<=B.rules[A].e){C=0;C+=Math.abs(r[A].s-B.rules[A].s);C+=Math.abs(B.rules[A].e-r[A].e)}else{C="N/A";break}if(C>g.MAX_SCORE){C="N/A";break}}}C=n(r,o,C,B);return C};var u={};var x=b.olson.dst_rules.zones;var v=x.length;var z=g.AMBIGUITIES[o];for(var t=0;t<v;t++){var w=x[t];var p=y(x[t]);if(p!=="N/A"){u[w.name]=p}}for(var q in u){if(u.hasOwnProperty(q)){for(var s=0;s<z.length;s++){if(z[s]===q){return q}}}}return o},c=function c(s){var p=function p(){var u=[];for(var v=0;v<b.olson.dst_rules.years.length;v++){var t=i(b.olson.dst_rules.years[v]);u.push(t)}return u};var o=function o(u){for(var t=0;t<u.length;t++){if(u[t]!==false){return true}}return false};var r=p();var q=o(r);if(q){return m(r,s)}return s},l=function l(){var o=j();if(!o){o=b.olson.timezones[h()];if(typeof g.AMBIGUITIES[o]!=="undefined"){o=c(o)}}return{name:function(){return o}}};return{determine:l}}());b.olson=b.olson||{};b.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Asuncion","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"};b.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:1219957200000,s:1209074400000},{e:1250802000000,s:1240524000000},{e:1285880400000,s:1284069600000},false,false,false,{e:1411678800000,s:1406844000000}]},{name:"Africa/Casablanca",rules:[{e:1220223600000,s:1212278400000},{e:1250809200000,s:1243814400000},{e:1281222000000,s:1272758400000},{e:1312066800000,s:1301788800000},{e:1348970400000,s:1345428000000},{e:1382839200000,s:1376100000000},{e:1414288800000,s:1406944800000}]},{name:"America/Asuncion",rules:[{e:1205031600000,s:1224388800000},{e:1236481200000,s:1255838400000},{e:1270954800000,s:1286078400000},{e:1302404400000,s:1317528000000},{e:1333854000000,s:1349582400000},{e:1364094000000,s:1381032000000},{e:1395543600000,s:1412481600000}]},{name:"America/Campo_Grande",rules:[{e:1203217200000,s:1224388800000},{e:1234666800000,s:1255838400000},{e:1266721200000,s:1287288000000},{e:1298170800000,s:1318737600000},{e:1330225200000,s:1350792000000},{e:1361070000000,s:1382241600000},{e:1392519600000,s:1413691200000}]},{name:"America/Goose_Bay",rules:[{e:1225594860000,s:1205035260000},{e:1257044460000,s:1236484860000},{e:1289098860000,s:1268539260000},{e:1320555600000,s:1299988860000},{e:1352005200000,s:1331445600000},{e:1383454800000,s:1362895200000},{e:1414904400000,s:1394344800000}]},{name:"America/Havana",rules:[{e:1224997200000,s:1205643600000},{e:1256446800000,s:1236488400000},{e:1288501200000,s:1268542800000},{e:1321160400000,s:1300597200000},{e:1352005200000,s:1333256400000},{e:1383454800000,s:1362891600000},{e:1414904400000,s:1394341200000}]},{name:"America/Mazatlan",rules:[{e:1225008000000,s:1207472400000},{e:1256457600000,s:1238922000000},{e:1288512000000,s:1270371600000},{e:1319961600000,s:1301821200000},{e:1351411200000,s:1333270800000},{e:1382860800000,s:1365325200000},{e:1414310400000,s:1396774800000}]},{name:"America/Mexico_City",rules:[{e:1225004400000,s:1207468800000},{e:1256454000000,s:1238918400000},{e:1288508400000,s:1270368000000},{e:1319958000000,s:1301817600000},{e:1351407600000,s:1333267200000},{e:1382857200000,s:1365321600000},{e:1414306800000,s:1396771200000}]},{name:"America/Miquelon",rules:[{e:1225598400000,s:1205038800000},{e:1257048000000,s:1236488400000},{e:1289102400000,s:1268542800000},{e:1320552000000,s:1299992400000},{e:1352001600000,s:1331442000000},{e:1383451200000,s:1362891600000},{e:1414900800000,s:1394341200000}]},{name:"America/Santa_Isabel",rules:[{e:1225011600000,s:1207476000000},{e:1256461200000,s:1238925600000},{e:1288515600000,s:1270375200000},{e:1319965200000,s:1301824800000},{e:1351414800000,s:1333274400000},{e:1382864400000,s:1365328800000},{e:1414314000000,s:1396778400000}]},{name:"America/Santiago",rules:[{e:1206846000000,s:1223784000000},{e:1237086000000,s:1255233600000},{e:1270350000000,s:1286683200000},{e:1304823600000,s:1313899200000},{e:1335668400000,s:1346558400000},{e:1367118000000,s:1378612800000},{e:1398567600000,s:1410062400000}]},{name:"America/Sao_Paulo",rules:[{e:1203213600000,s:1224385200000},{e:1234663200000,s:1255834800000},{e:1266717600000,s:1287284400000},{e:1298167200000,s:1318734000000},{e:1330221600000,s:1350788400000},{e:1361066400000,s:1382238000000},{e:1392516000000,s:1413687600000}]},{name:"Asia/Amman",rules:[{e:1225404000000,s:1206655200000},{e:1256853600000,s:1238104800000},{e:1288303200000,s:1269554400000},{e:1319752800000,s:1301608800000},false,false,{e:1414706400000,s:1395957600000}]},{name:"Asia/Damascus",rules:[{e:1225486800000,s:1207260000000},{e:1256850000000,s:1238104800000},{e:1288299600000,s:1270159200000},{e:1319749200000,s:1301608800000},{e:1351198800000,s:1333058400000},{e:1382648400000,s:1364508000000},{e:1414702800000,s:1395957600000}]},{name:"Asia/Dubai",rules:[false,false,false,false,false,false,false]},{name:"Asia/Gaza",rules:[{e:1219957200000,s:1206655200000},{e:1252015200000,s:1238104800000},{e:1281474000000,s:1269640860000},{e:1312146000000,s:1301608860000},{e:1348178400000,s:1333058400000},{e:1380229200000,s:1364508000000},{e:1414098000000,s:1395957600000}]},{name:"Asia/Irkutsk",rules:[{e:1224957600000,s:1206813600000},{e:1256407200000,s:1238263200000},{e:1288461600000,s:1269712800000},false,false,false,false]},{name:"Asia/Jerusalem",rules:[{e:1223161200000,s:1206662400000},{e:1254006000000,s:1238112000000},{e:1284246000000,s:1269561600000},{e:1317510000000,s:1301616000000},{e:1348354800000,s:1333065600000},{e:1382828400000,s:1364515200000},{e:1414278000000,s:1395964800000}]},{name:"Asia/Kamchatka",rules:[{e:1224943200000,s:1206799200000},{e:1256392800000,s:1238248800000},{e:1288450800000,s:1269698400000},false,false,false,false]},{name:"Asia/Krasnoyarsk",rules:[{e:1224961200000,s:1206817200000},{e:1256410800000,s:1238266800000},{e:1288465200000,s:1269716400000},false,false,false,false]},{name:"Asia/Omsk",rules:[{e:1224964800000,s:1206820800000},{e:1256414400000,s:1238270400000},{e:1288468800000,s:1269720000000},false,false,false,false]},{name:"Asia/Vladivostok",rules:[{e:1224950400000,s:1206806400000},{e:1256400000000,s:1238256000000},{e:1288454400000,s:1269705600000},false,false,false,false]},{name:"Asia/Yakutsk",rules:[{e:1224954000000,s:1206810000000},{e:1256403600000,s:1238259600000},{e:1288458000000,s:1269709200000},false,false,false,false]},{name:"Asia/Yekaterinburg",rules:[{e:1224968400000,s:1206824400000},{e:1256418000000,s:1238274000000},{e:1288472400000,s:1269723600000},false,false,false,false]},{name:"Asia/Yerevan",rules:[{e:1224972000000,s:1206828000000},{e:1256421600000,s:1238277600000},{e:1288476000000,s:1269727200000},{e:1319925600000,s:1301176800000},false,false,false]},{name:"Australia/Lord_Howe",rules:[{e:1207407600000,s:1223134200000},{e:1238857200000,s:1254583800000},{e:1270306800000,s:1286033400000},{e:1301756400000,s:1317483000000},{e:1333206000000,s:1349537400000},{e:1365260400000,s:1380987000000},{e:1396710000000,s:1412436600000}]},{name:"Australia/Perth",rules:[{e:1206813600000,s:1224957600000},false,false,false,false,false,false]},{name:"Europe/Helsinki",rules:[{e:1224982800000,s:1206838800000},{e:1256432400000,s:1238288400000},{e:1288486800000,s:1269738000000},{e:1319936400000,s:1301187600000},{e:1351386000000,s:1332637200000},{e:1382835600000,s:1364691600000},{e:1414285200000,s:1396141200000}]},{name:"Europe/Minsk",rules:[{e:1224979200000,s:1206835200000},{e:1256428800000,s:1238284800000},{e:1288483200000,s:1269734400000},false,false,false,false]},{name:"Europe/Moscow",rules:[{e:1224975600000,s:1206831600000},{e:1256425200000,s:1238281200000},{e:1288479600000,s:1269730800000},false,false,false,false]},{name:"Pacific/Apia",rules:[false,false,false,{e:1301752800000,s:1316872800000},{e:1333202400000,s:1348927200000},{e:1365256800000,s:1380376800000},{e:1396706400000,s:1411826400000}]},{name:"Pacific/Fiji",rules:[false,false,{e:1269698400000,s:1287842400000},{e:1327154400000,s:1319292000000},{e:1358604000000,s:1350741600000},{e:1390050000000,s:1382796000000},{e:1421503200000,s:1414850400000}]},{name:"Europe/London",rules:[{e:1224982800000,s:1206838800000},{e:1256432400000,s:1238288400000},{e:1288486800000,s:1269738000000},{e:1319936400000,s:1301187600000},{e:1351386000000,s:1332637200000},{e:1382835600000,s:1364691600000},{e:1414285200000,s:1396141200000}]}]};if(typeof a==="undefined"){window.jstz=b}else{a.jstz=b}}());Kameleoon.Gatherer={SCRIPT_VERSION:20180605,VISITOR_CODE_LENGTH:16,SEND_TRACKING_REQUEST_SECURITY_CHECK_INTERVAL:100,ACTIVITY_TRACKING_INTERVAL:30*1000,INTERESTS_TRACKING_TIMEOUT_AFTER_WINDOW_LOAD:2*1000,INTERESTS_TRACKING_INTERVAL:5*60*1000,INTERESTS_FRESHNESS_DURATION:7*24*60*60*1000,IMAGES_DETECTION_TEST_IMAGE:"images/common/personalizations/benchmark.png",IMAGES_DETECTION_DEFAULT_CACHE_TIMEOUT:20,CUSTOM_DATA_TRACKING_INTERVAL:30*1000,TAB_COUNT_TRACKING_INTERVAL:15*1000,NUMBER_CLICKS_TRACKING_INTERVAL:30*1000,MAX_NUMBER_CONVERSIONS_IN_A_REQUEST:20,MAX_NUMBER_MENTALIST_ACTIONS_IN_A_REQUEST:10,MAX_NUMBER_TARGETING_SEGMENTS_IN_A_REQUEST:20,MAX_NUMBER_CONTAINERS_IN_A_REQUEST:20,REFERENCE_VARIATION_ID_IN_A_REQUEST:0,MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST:1024,MAX_NUMBER_MENTALIST_PREDICTION_TARGETING_IN_A_REQUEST:10,MAX_HREF_LENGTH_IN_A_REQUEST:200,MAX_PAGE_TITLE_LENGTH_IN_A_REQUEST:200,NONCE_BYTE_LENGTH:8,HEXADECIMAL_ALPHABET:"0123456789ABCDEF",DEFAULT_CUSTOM_DATUM_SCOPE:"VISIT",CUSTOM_DATA_RETRY_DELAY_BEFORE_CUT_OFF:100,CUSTOM_DATA_CUTOFF:3*1000,VISITOR_DATA_FROM_SERVER_TRACKING_TIMEOUT:2*1000,DEFAULT_LOCALE_LANGUAGE_TAG:"en",run:function(){var trackPage=function(callback){var date=new Date();this.updateIfStartOfVisit(date,true,false,false,function(startOfVisit){this.LocalDataHandler.registerAction(function(){var pageHref=Kameleoon.Utils.computeCurrentPageCanonicalURL()||Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL();this.restoreVisitCookieIfNecessary();this.saveFieldToVisitCookieOrStoredData("timeLastActivity",date.getTime());this.saveVisitCookieIfNecessary();Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addPage(date,pageHref,document.title,this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(startOfVisit));Kameleoon.Visitor.saveToStoredData();if(["medium","audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0){this.sendTrackingRequest(date,"event=page&href="+encodeURIComponent((Kameleoon.Utils.computeCurrentPageCanonicalURL()||Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL()).slice(0,this.MAX_HREF_LENGTH_IN_A_REQUEST))+"&title="+encodeURIComponent(document.title.slice(0,this.MAX_PAGE_TITLE_LENGTH_IN_A_REQUEST))+"&keyPages="+this.joinAll(this.obtainKeyPagesIndexes(),"-")+"&referrers="+this.joinAll(this.obtainReferrersIndexes(startOfVisit),"-"),startOfVisit);var landingPageHref=this.obtainFieldFromStoredData("landingPageHref");var landingPageTitle=this.obtainFieldFromStoredData("landingPageTitle");var landingPages=this.obtainFieldFromStoredData("landingPages")||[null];var firstReferrerHref=this.obtainFieldFromStoredData("firstReferrerHref");var firstReferrers=this.obtainFieldFromStoredData("firstReferrers")||[null];this.sendTrackingRequest(date,"event=staticData&trackingMode="+Kameleoon.Internals.configuration.trackingMode+"&timeSincePreviousVisit="+this.obtainFieldFromVisitCookieOrStoredData("timeSincePreviousVisit")+(landingPageHref!=null?"&landingPageHref="+encodeURIComponent(landingPageHref.slice(0,this.MAX_HREF_LENGTH_IN_A_REQUEST)):"")+(landingPageTitle!=null?"&landingPageTitle="+encodeURIComponent(landingPageTitle.slice(0,this.MAX_PAGE_TITLE_LENGTH_IN_A_REQUEST)):"")+"&landingPages="+this.joinAll(landingPages,"-")+(firstReferrerHref!=null?"&firstReferrerHref="+encodeURIComponent(firstReferrerHref.slice(0,this.MAX_HREF_LENGTH_IN_A_REQUEST)):"")+"&firstReferrers="+this.joinAll(firstReferrers,"-")+"&timeZoneGroups="+this.joinAll(this.obtainTimeZoneGroupsIndexes(),"-")+"&language="+this.obtainLanguageIndex()+"&browser="+this.obtainBrowserIndex()+"&browserVersion="+Kameleoon.Internals.runtime.browserVersion+"&mobileBrowser="+Kameleoon.Internals.runtime.mobileDevice+"&os="+this.obtainOSIndex()+"&windowWidth="+this.obtainWindowWidth()+"&windowHeight="+this.obtainWindowHeight()+"&screenWidth="+this.obtainScreenWidth()+"&screenHeight="+this.obtainScreenHeight()+"&javaEnabled="+this.obtainJavaEnabled()+"&timeZoneId="+this.obtainTimeZoneId()+"&localeLanguageTag="+this.obtainLocaleLanguageTag()+"&deviceType="+Kameleoon.Internals.runtime.deviceType+"&browserName="+this.obtainBrowser()+"&osName="+this.obtainOS(),startOfVisit)}if(["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0){if(Kameleoon.Mentalist!=null){this.sendTrackingRequest(date,"event=mentalistSettings&learnerVersion="+Kameleoon.Internals.configuration.MentalistLearner.version,startOfVisit)}}if(Kameleoon.API.pageCallbacks!=null){for(var k=0,n=Kameleoon.API.pageCallbacks.length;k<n;++k){try{Kameleoon.API.pageCallbacks[k](date,pageHref,document.title,this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(startOfVisit))}catch(exception){}}}callback&&callback()}.bind(this),true,{urgent:true})}.bind(this))}.bind(this);var scheduleActivityTracking=function(){Kameleoon.Internals.runtime.Gatherer.active=false;var setActivity=function(){Kameleoon.Internals.runtime.Gatherer.active=true}.bind(this);Kameleoon.Utils.addEventListener(document,"mousemove",setActivity,false);Kameleoon.Utils.addEventListener(document,"scroll",setActivity,false);this.LocalDataHandler.registerAction(function(){this.trackActivity(Kameleoon.Internals.runtime.Gatherer.active);Kameleoon.Internals.runtime.Gatherer.active=false}.bind(this),false,{repeatInterval:this.ACTIVITY_TRACKING_INTERVAL})}.bind(this);var scheduleInterestsTracking=function(){var launchInterestsTrackingScheduler=function(){if(null==Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists){if(null==Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesListsFileUrl){Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists=[]}else{if(!Kameleoon.Internals.runtime.interestsFileLoaded){Kameleoon.Internals.runtime.interestsFileLoaded=true;Kameleoon.API.loadScriptSequentially(Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesListsFileUrl)}var timeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(timeoutId);launchInterestsTrackingScheduler()}.bind(this),100);return}}if("https:"==window.location.protocol){var interestsImagesListsHTTPS=[];for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists.length;i<l;++i){var interestsImagesListsHTTPS_i=[];for(var j=0,m=Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists[i].length;j<m;++j){var interestsImagesListsHTTPS_i_j=[];for(var k=0,n=Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists[i][j].length;k<n;++k){if(0==Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists[i][j][k].url.indexOf("https:")){interestsImagesListsHTTPS_i_j.push(Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists[i][j][k])}}interestsImagesListsHTTPS_i.push(interestsImagesListsHTTPS_i_j)}interestsImagesListsHTTPS.push(interestsImagesListsHTTPS_i)}Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists=interestsImagesListsHTTPS}var timeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(timeoutId);this.LocalDataHandler.registerAction(function(){if((!Kameleoon.Internals.runtime.gecko)&&(!Kameleoon.Internals.runtime.webkit)){return}var currentTime=new Date().getTime();Kameleoon.Internals.runtime.numberInterestChecks=0;Kameleoon.Internals.runtime.Gatherer.inheritedActiveInterestIndexes=[];Kameleoon.Internals.runtime.Gatherer.potentialFreshActiveInterestIndexes=[];for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.configuration.interests.length;i<l;++i){if(!Kameleoon.Internals.runtime.Gatherer.configuration.interests[i].disabled){var lastVisitWithFreshActiveInterest=Kameleoon.Visitor.obtainLastVisitWithFreshActiveInterest(i);if((lastVisitWithFreshActiveInterest==null)||(Kameleoon.Internals.runtime.Visitor.currentVisit.timeStarted-lastVisitWithFreshActiveInterest.timeStarted>this.INTERESTS_FRESHNESS_DURATION)){Kameleoon.Internals.runtime.Gatherer.potentialFreshActiveInterestIndexes.push(i)}else{Kameleoon.Internals.runtime.Gatherer.inheritedActiveInterestIndexes.push(i)}}}this.trackInterests(Kameleoon.Internals.runtime.Gatherer.inheritedActiveInterestIndexes,false);Kameleoon.Internals.runtime.Gatherer.freshActiveInterestIndexes=[];for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.potentialFreshActiveInterestIndexes.length;i<l;++i){var interestIndex=Kameleoon.Internals.runtime.Gatherer.potentialFreshActiveInterestIndexes[i];var interestLastCheckTime=this.obtainFieldFromStoredData("interestLastCheckTime-"+interestIndex);if((interestLastCheckTime==null)||(currentTime-interestLastCheckTime>=this.INTERESTS_TRACKING_INTERVAL)){this.saveFieldToStoredData("interestLastCheckTime-"+interestIndex,currentTime);var interestHashes=this.obtainFieldFromStoredData("interestHashes-"+interestIndex);var interestHashesArrayUnchecked=null==interestHashes?[]:interestHashes.split("|");var interestsImagesLists=Kameleoon.Internals.runtime.Gatherer.configuration.interestsImagesLists[interestIndex];var checkedURLHashed={};for(var j=0,m=interestsImagesLists.length;j<m;++j){for(var k=0,n=interestsImagesLists[j].length;k<n;++k){var urlHash=Kameleoon.Utils.computeStringHash(interestsImagesLists[j][k].url);checkedURLHashed[urlHash]=true}}var interestHashesArray=[];for(var j=0,m=interestHashesArrayUnchecked.length;j<m;++j){var urlHash=interestHashesArrayUnchecked[j];if(checkedURLHashed[urlHash]){interestHashesArray.push(urlHash)}}for(var j=0,m=interestsImagesLists.length;j<m;++j){var imagesToCheck=[];for(var k=0,n=interestsImagesLists[j].length;k<n;++k){var urlHash=Kameleoon.Utils.computeStringHash(interestsImagesLists[j][k].url).toString();if(-1==interestHashesArray.indexOf(urlHash)){interestHashesArray.push(urlHash);imagesToCheck.push(interestsImagesLists[j][k])}}if((imagesToCheck.length>0)&&((imagesToCheck.length>=3)||(j==m-1))){++Kameleoon.Internals.runtime.numberInterestChecks;this.checkImageList(imagesToCheck,interestIndex);break}}this.saveFieldToStoredData("interestHashes-"+interestIndex,interestHashesArray.join("|"))}}}.bind(this),false,{repeatInterval:this.INTERESTS_TRACKING_INTERVAL,firstRunNow:true})}.bind(this),this.INTERESTS_TRACKING_TIMEOUT_AFTER_WINDOW_LOAD)}.bind(this);if("complete"==document.readyState){launchInterestsTrackingScheduler()}else{Kameleoon.Utils.addEventListener(window,"load",launchInterestsTrackingScheduler,false)}}.bind(this);var scheduleCustomDataTracking=function(){var obtainCustomData=function(){var obtainCustomDataVirtual=function(virtual,customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated){var hasNonReadyOrNullValues=false;for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.configuration.customData.length;i<l;++i){if(Kameleoon.Internals.runtime.Gatherer.customDataTreatedByIndex[i]==null){var customDatum=Kameleoon.Internals.runtime.Gatherer.configuration.customData[i];if(customDatum!=null&&!customDatum.disabled){var customDatumVirtual=customDatum.virtual;if(customDatumVirtual==null){customDatumVirtual=false}if(customDatumVirtual==virtual){var customDatumCurrentCountByValue=Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.countByValueByCustomDatum[i];if(customDatumCurrentCountByValue==null||!customDatum.constant){var valueMap=this.obtainCustomDatumValueMap(i);if(valueMap!=null){var customDatumDetectedValue=valueMap.value;if(customDatumDetectedValue!=null){customDataTreated.push({name:customDatum.name,index:i});var customDatumType=customDatum.type;if(customDatumType=="LIST"||customDatumType=="COUNT_LIST"||customDatumCurrentCountByValue==null||Object.keys(customDatumCurrentCountByValue)[0]!=customDatumDetectedValue||(Kameleoon.Internals.configuration.enableHistoryReconciliation&&customDatum.mappingIdentifier&&(this.obtainFieldFromStoredData("visitsRequestSuccess_"+i)==null))){customDataIndexes.push(i);customDataValues.push(customDatumDetectedValue);customDataOverwritesIfCollection.push(valueMap.overwrite)}}else{hasNonReadyOrNullValues=true}}else{hasNonReadyOrNullValues=true}}}}}}return hasNonReadyOrNullValues}.bind(this);var customDataIndexes=[];var customDataValues=[];var customDataOverwritesIfCollection=[];var customDataTreated=[];var hasNonReadyOrNullValues=false;hasNonReadyOrNullValues=obtainCustomDataVirtual(false,customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated)||hasNonReadyOrNullValues;hasNonReadyOrNullValues=obtainCustomDataVirtual(true,customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated)||hasNonReadyOrNullValues;return[customDataIndexes,customDataValues,customDataOverwritesIfCollection,customDataTreated,hasNonReadyOrNullValues]}.bind(this);var registerCustomData=function(obtainCustomDataResult){var customDataIndexes=obtainCustomDataResult[0];var customDataValues=obtainCustomDataResult[1];var customDataOverwritesIfCollection=obtainCustomDataResult[2];var customDataTreated=obtainCustomDataResult[3];for(var i=0,l=customDataIndexes.length;i<l;++i){var customDatumIndex=customDataIndexes[i];var customDatum=Kameleoon.Internals.runtime.Gatherer.configuration.customData[customDatumIndex];if(Kameleoon.Internals.configuration.enableHistoryReconciliation&&customDatum.mappingIdentifier){var registerVisitsRequestSuccessAndChangePreviousVisits=function(visitsFromServer){this.saveFieldToStoredData("visitsRequestSuccess_"+customDatumIndex,true);for(var i=0,l=visitsFromServer.length;i<l;++i){Kameleoon.Visit.convertVisitFromServer(visitsFromServer[i])}if(visitsFromServer.length>0){this.LocalDataHandler.registerAction(function(){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addPreviousVisits(visitsFromServer);Kameleoon.Visitor.saveToStoredData();this.inheritVisitorScopeCustomDataAndTrackVisitorDataFromServer()}.bind(this),true,{urgent:true})}}.bind(this);Kameleoon.Utils.performBeaconServerCall("//api-visit."+Kameleoon.Internals.configuration.DOMAIN+"/visits?scriptVersion="+this.SCRIPT_VERSION+"&simulation="+(Kameleoon.Internals.runtime.simulationMode==true)+"&siteCode="+Kameleoon.Internals.configuration.siteCode+"&mappingIdentifier="+customDatumIndex+"&mappingValue="+encodeURIComponent(customDataValues[i]),function(){if((this.readyState==4)&&(this.status==200)){registerVisitsRequestSuccessAndChangePreviousVisits(Kameleoon.Utils.JSONParse(this.responseText))}})}}this.trackCustomData(customDataIndexes,customDataValues,customDataOverwritesIfCollection);for(var i=0,l=customDataTreated.length;i<l;++i){var customDatumTreated=customDataTreated[i];Kameleoon.API.state.customDataTreated[customDatumTreated.name]=true;Kameleoon.Internals.runtime.Gatherer.customDataTreatedByIndex[customDatumTreated.index]=true}}.bind(this);this.LocalDataHandler.registerAction(function(){var obtainCustomDataFirstTryStartTime=new Date().getTime();var obtainCustomDataWithRetriesBeforeCutOff=null;obtainCustomDataWithRetriesBeforeCutOff=function(){var obtainCustomDataResult=obtainCustomData();if(obtainCustomDataResult[4]&&(new Date().getTime()-obtainCustomDataFirstTryStartTime<this.CUSTOM_DATA_CUTOFF)){var timeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(timeoutId);obtainCustomDataWithRetriesBeforeCutOff()}.bind(this),this.CUSTOM_DATA_RETRY_DELAY_BEFORE_CUT_OFF)}else{registerCustomData(obtainCustomDataResult)}}.bind(this);obtainCustomDataWithRetriesBeforeCutOff()}.bind(this),false,{});this.LocalDataHandler.registerAction(function(){registerCustomData(obtainCustomData())}.bind(this),false,{repeatInterval:this.CUSTOM_DATA_TRACKING_INTERVAL,firstRunNow:true})}.bind(this);var scheduleTabCountTracking=function(){if(Kameleoon.Internals.configuration.useWideDomainSupport){Kameleoon.Internals.runtime.Gatherer.tabCode=Kameleoon.Utils.obtainRandomString(16);this.LocalDataHandler.registerAction(function(){Kameleoon.Utils.postMessageToExternalIframe(Kameleoon.Utils.JSONStringify({type:"tabcount",tabCode:Kameleoon.Internals.runtime.Gatherer.tabCode,deadTime:new Date().getTime()+this.TAB_COUNT_TRACKING_INTERVAL,callbackId:Kameleoon.Utils.addPostMessageCallback(this.trackTabCount.bind(this))}))}.bind(this),false,{repeatInterval:this.TAB_COUNT_TRACKING_INTERVAL,firstRunNow:true})}}.bind(this);var scheduleNumberClicksTracking=function(){Kameleoon.Internals.runtime.Gatherer.numberClicks=0;Kameleoon.Utils.addEventListener(document,"click",function(){Kameleoon.Internals.runtime.Gatherer.numberClicks++}.bind(this),false);this.LocalDataHandler.registerAction(function(){this.trackNumberClicks(Kameleoon.Internals.runtime.Gatherer.numberClicks);Kameleoon.Internals.runtime.Gatherer.numberClicks=0}.bind(this),false,{repeatInterval:this.NUMBER_CLICKS_TRACKING_INTERVAL,firstRunNow:true})}.bind(this);var processMessageEvent=function(event){if(typeof event.data!=="string"){return}if((event.data.indexOf("addKameleoonInterest")>=0)||(event.data.indexOf("finishKameleoonInterestCheck")>=0)){var messageData=Kameleoon.Utils.JSONParse(event.data);if("addKameleoonInterest"==messageData.command){Kameleoon.Internals.runtime.Gatherer.freshActiveInterestIndexes.push(messageData.index)}--Kameleoon.Internals.runtime.numberInterestChecks;if(0==Kameleoon.Internals.runtime.numberInterestChecks){var timeoutId=Kameleoon.Utils.setTimeout(function(){Kameleoon.Utils.clearTimeout(timeoutId);var iframes=document.getElementsByClassName("KameleoonInterestDetection");for(var i=0,l=iframes.length;i<l;++i){var iframe=iframes.item(0);iframe.parentNode.removeChild(iframe)}this.trackInterests(Kameleoon.Internals.runtime.Gatherer.freshActiveInterestIndexes,true)}.bind(this),300)}return}if(event.data.indexOf("imageChecked")>=0){var messageData=Kameleoon.Utils.JSONParse(event.data);if(null!=Kameleoon.Internals.runtime.checkImageCallbacks&&null!=Kameleoon.Internals.runtime.checkImageCallbacks[messageData.callbackId]){var callback=Kameleoon.Internals.runtime.checkImageCallbacks[messageData.callbackId];delete (Kameleoon.Internals.runtime.checkImageCallbacks[messageData.callbackId]);callback&&callback(messageData.value);var iframes=document.getElementsByClassName("KameleoonImageDetection");for(var i=0,l=iframes.length;i<l;++i){var iframe=iframes.item(0);iframe.parentNode.removeChild(iframe)}}}}.bind(this);if(Kameleoon.API==null){Kameleoon.API={}}if(Kameleoon.API.state==null){Kameleoon.API.state={}}Kameleoon.API.state.customDataTreated={};if(Kameleoon.Internals.runtime.Gatherer==null){Kameleoon.Internals.runtime.Gatherer={}}if(Kameleoon.Internals.configuration.environment=="DEVELOPMENT"){Kameleoon.Internals.runtime.Gatherer.configuration=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.Gatherer)}else{Kameleoon.Internals.runtime.Gatherer.configuration=Kameleoon.Utils.JSONParse(Kameleoon.Utils.decodeString(Kameleoon.Internals.configuration.Gatherer))}Kameleoon.Internals.runtime.Gatherer.customDataTreatedByIndex={};Kameleoon.Internals.runtime.Gatherer.customDataUpdateNeedsLocalData=false;for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.configuration.customData.length;i<l;++i){var customDatum=Kameleoon.Internals.runtime.Gatherer.configuration.customData[i];if(customDatum!=null&&!customDatum.disabled){var customDatumScope=this.obtainCorrectedCustomDatumScope(customDatum.scope);if(("VISIT"==customDatumScope)||("VISITOR"==customDatumScope)){Kameleoon.Internals.runtime.Gatherer.customDataUpdateNeedsLocalData=true;break}}}if(Kameleoon.Internals.runtime.Visitor==null){Kameleoon.Internals.runtime.Visitor={}}if(Kameleoon.Internals.runtime.Gatherer.countByValueByCustomDatum==null){Kameleoon.Internals.runtime.Gatherer.countByValueByCustomDatum={}}this.initializeStoredDataIfNecessary();this.LocalDataHandler.init();Kameleoon.Utils.addEventListener(window,"message",processMessageEvent,false);if((Kameleoon.Mentalist!=null)&&(!Kameleoon.Mentalist.computeIsSecure())){Kameleoon.Mentalist=null}this.LocalDataHandler.registerAction(function(){if(Kameleoon.Internals.runtime.Gatherer.configuration.enableImagesDetectionCacheTimeoutComputation){Kameleoon.Visitor.setupFromStoredData(false);if(Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout==null){var downloadImage=function(url,cacheParameterValue,callback){var image=new Image();var timeStarted=new Date().getTime();image.onload=function(){var timeEnded=new Date().getTime();callback&&callback(timeEnded-timeStarted)};image.src=url+"?cache="+cacheParameterValue}.bind(this);var cacheParameterValue=new Date().getTime();downloadImage(Kameleoon.Internals.configuration.staticURL+this.IMAGES_DETECTION_TEST_IMAGE,cacheParameterValue,function(timeWithoutCache){downloadImage(Kameleoon.Internals.configuration.staticURL+this.IMAGES_DETECTION_TEST_IMAGE,cacheParameterValue,function(timeWithCache){this.LocalDataHandler.registerAction(function(){Kameleoon.Visitor.setupFromStoredData(false);Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithoutCache=timeWithoutCache;Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithCache=timeWithCache;var timeRatio=timeWithoutCache/timeWithCache;if(timeRatio>=6){Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout=2*timeWithCache}else{if(timeRatio>=4){Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout=1.75*timeWithCache}else{if(timeRatio>=2){Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout=1.5*timeWithCache}else{Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout=1.25*timeWithCache}}}Kameleoon.Visitor.saveToStoredData()}.bind(this),true,{})}.bind(this))}.bind(this))}}this.saveFieldToStoredData("startsOfVisitForCurrentPage",0);try{eval(Kameleoon.Internals.runtime.Gatherer.configuration.customScriptBefore)}catch(error){}trackPage(function(){scheduleActivityTracking();scheduleInterestsTracking();scheduleCustomDataTracking();scheduleTabCountTracking();scheduleNumberClicksTracking()}.bind(this))}.bind(this),true,{urgent:true})},trackActivity:function(b){var a=new Date();var c=function(d){this.LocalDataHandler.registerAction(function(){if(b||(!this.obtainVisitIsFinished(a))){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addActivity(a,b);Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(a,"event=activity&active="+b,d)}if(Kameleoon.API.activityCallbacks!=null){for(var e=0,g=Kameleoon.API.activityCallbacks.length;e<g;++e){try{Kameleoon.API.activityCallbacks[e](a,b)}catch(f){}}}}}.bind(this),true,{urgent:true})}.bind(this);if(b){this.updateIfStartOfVisit(a,false,false,false,function(d){this.LocalDataHandler.registerAction(function(){this.restoreVisitCookieIfNecessary();this.saveFieldToVisitCookieOrStoredData("timeLastActivity",a.getTime());this.saveVisitCookieIfNecessary();c(d)}.bind(this),true,{urgent:true})}.bind(this))}else{c(false)}},trackInterests:function(f,d){var g=[];for(var e=0,c=f.length;e<c;++e){var b=f[e];var a=Kameleoon.Internals.runtime.Gatherer.configuration.interests[b];if(!a.disabled){g.push(b)}}f=g;if(f.length>0){this.LocalDataHandler.registerAction(function(){var i=new Date();if(!this.obtainVisitIsFinished(i)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addInterests(f,d);Kameleoon.Visitor.saveToStoredData();if((["audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(i,"event=interests&activeInterests="+this.joinAll(f,"-")+"&fresh="+d,false)}if(Kameleoon.API.interestsCallbacks!=null){for(var h=0,l=Kameleoon.API.interestsCallbacks.length;h<l;++h){try{Kameleoon.API.interestsCallbacks[h](i,f,d)}catch(j){}}}}}.bind(this),true,{})}},trackSearch:function(d,c,a){var b=new Date();this.updateIfStartOfVisit(b,false,false,false,function(e){this.LocalDataHandler.registerAction(function(){this.restoreVisitCookieIfNecessary();this.saveFieldToVisitCookieOrStoredData("timeLastActivity",b.getTime());this.saveVisitCookieIfNecessary();Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addSearch(b,this.obtainKeyWordsIndexes(d),c,a);Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(b,"event=search&keyWords="+this.joinAll(this.obtainKeyWordsIndexes(d),"-")+"&numberResults="+c+"&followed="+a,e)}if(Kameleoon.API.searchCallbacks!=null){for(var f=0,h=Kameleoon.API.searchCallbacks.length;f<h;++f){try{Kameleoon.API.searchCallbacks[f](b,this.obtainKeyWordsIndexes(d),c,a)}catch(g){}}}}.bind(this),true,{urgent:true})}.bind(this))},trackConversions:function(c,a){var b=c.length;if(b>0){this.LocalDataHandler.registerAction(function(){var g=new Date();if(!this.obtainVisitIsFinished(g)){var t=(["medium","audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0);(!a)&&Kameleoon.Visitor.setupFromStoredData(true);for(var s=0;s<b;s+=this.MAX_NUMBER_CONVERSIONS_IN_A_REQUEST){var o=Math.min(this.MAX_NUMBER_CONVERSIONS_IN_A_REQUEST,b-s);var r=null;if(t){r="event=conversions&number="+o}for(var q=0;q<o;++q){var m=c[s+q];var p=m.goalId;var d=parseFloat(m.revenue);var l=(m.negative===true);if(isNaN(d)){d=0}Kameleoon.Visitor.addConversion(p,d,l);if(t){r+=("&goalId"+q+"="+p+(d!=0?"&revenue"+q+"="+d:""));if(l){r+=("&negative"+q+"=true")}}if(Kameleoon.API.conversionCallbacks!=null){for(var h=0,f=Kameleoon.API.conversionCallbacks.length;h<f;++h){try{Kameleoon.API.conversionCallbacks[h](g,p,d,l)}catch(e){}}}}if(t){this.sendTrackingRequest(g,r,false)}}(!a)&&Kameleoon.Visitor.saveToStoredData()}}.bind(this),(!a)&&true,{urgent:true})}},trackMentalistActions:function(a,d,b){var c=a.length;if(c>0){this.LocalDataHandler.registerAction(function(){var h=new Date();if(!this.obtainVisitIsFinished(h)){var r=(["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0);Kameleoon.Visitor.setupFromStoredData(true);for(var q=0;q<c;q+=this.MAX_NUMBER_MENTALIST_ACTIONS_IN_A_REQUEST){var m=Math.min(this.MAX_NUMBER_MENTALIST_ACTIONS_IN_A_REQUEST,c-q);var p=null;if(r){p="event=mentalistActions&number="+m}for(var o=0;o<m;++o){var u=q+o;var e=a[u];var s=d[u];var t=b[u];Kameleoon.Visitor.addMentalistAction(e,s,t);if(r){p+=("&actionTakenIds"+o+"="+this.joinAll(e,"-")+"&actionNotTakenIds"+o+"="+this.joinAll(s,"-")+"&mentalistDecision"+o+"="+t)}if(Kameleoon.API.mentalistActionCallbacks!=null){for(var l=0,g=Kameleoon.API.mentalistActionCallbacks.length;l<g;++l){try{Kameleoon.API.mentalistActionCallbacks[l](h,e,s,t)}catch(f){}}}}if(r){this.sendTrackingRequest(h,p,false)}}Kameleoon.Visitor.saveToStoredData()}}.bind(this),true,{urgent:true})}},trackTargetingSegments:function(a){var b=a.length;if(b>0){this.LocalDataHandler.registerAction(function(){var f=new Date();if(!this.obtainVisitIsFinished(f)){var p=(["medium","audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0);Kameleoon.Visitor.setupFromStoredData(true);for(var o=0;o<b;o+=this.MAX_NUMBER_TARGETING_SEGMENTS_IN_A_REQUEST){var h=Math.min(this.MAX_NUMBER_TARGETING_SEGMENTS_IN_A_REQUEST,b-o);var m=null;if(p){m="event=targetingSegments&number="+h}for(var l=0;l<h;++l){var e=o+l;var q=a[e];Kameleoon.Visitor.addTargetingSegment(f,q);if(p){m+=("&id"+l+"="+q)}if(Kameleoon.API.targetingSegmentCallbacks!=null){for(var g=0,d=Kameleoon.API.targetingSegmentCallbacks.length;g<d;++g){try{Kameleoon.API.targetingSegmentCallbacks[g](f,q)}catch(c){}}}}if(p){this.sendTrackingRequest(f,m,false)}}Kameleoon.Visitor.saveToStoredData()}}.bind(this),true,{urgent:true})}},trackContainers:function(a,b){if((a.length+b.length)>0){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){var d=function(m,g){var u=m.length;if(u>0){for(var s=0;s<u;s+=this.MAX_NUMBER_CONTAINERS_IN_A_REQUEST){var p=Math.min(this.MAX_NUMBER_CONTAINERS_IN_A_REQUEST,u-s);var r=null;if(g){r="event=containers&number="+p}for(var q=0;q<p;++q){var f=m[s+q];var e=null;var t=null;switch(f.type.toUpperCase()){case"EXPERIMENT":e=Kameleoon.Visitor.addExperiment.bind(Kameleoon.Visitor);t=Kameleoon.API.experimentCallbacks;break;case"PERSONALIZATION":e=Kameleoon.Visitor.addPersonalization.bind(Kameleoon.Visitor);t=Kameleoon.API.personalizationCallbacks;break}if(e!=null){e(c,f.id,f.variationId,f.mentalistDecision)}if(g){r+=("&type"+q+"="+f.type+"&id"+q+"="+f.id+"&variationId"+q+"="+(f.variationId==null?this.REFERENCE_VARIATION_ID_IN_A_REQUEST:f.variationId)+"&mentalistDecision"+q+"="+f.mentalistDecision)}if(t!=null){for(var o=0,l=t.length;o<l;++o){try{t[o](c,f.id,f.variationId,f.mentalistDecision)}catch(h){}}}}if(g){this.sendTrackingRequest(c,r,false)}}}}.bind(this);Kameleoon.Visitor.setupFromStoredData(true);d(a,(["medium","audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0));d(b,false);Kameleoon.Visitor.saveToStoredData()}}.bind(this),true,{urgent:true})}},trackWeather:function(a,c,e,b,g,h,f,d){this.LocalDataHandler.registerAction(function(){var j=new Date();if(!this.obtainVisitIsFinished(j)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addWeather(a,c,e,b,g,h,f,d);Kameleoon.Visitor.saveToStoredData();if((["audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(j,"event=weather&temperature="+a+"&humidity="+c+"&pressure="+e+"&windSpeed="+b+"&cloudiness="+g+"&sunriseTime="+h+"&sunsetTime="+f+(d!=null?"&weatherCode="+d:""),false)}if(Kameleoon.API.weatherCallbacks!=null){for(var i=0,m=Kameleoon.API.weatherCallbacks.length;i<m;++i){try{Kameleoon.API.weatherCallbacks[i](j,a,c,e,b,g,h,f,d)}catch(l){}}}}}.bind(this),true,{})},trackCustomData:function(f,d,v,h){var x=[];var c=[];var b=[];var n=[];var p=[];var o=[];for(var u=0,s=f.length;u<s;++u){var g=f[u];var k=Kameleoon.Internals.runtime.Gatherer.configuration.customData[g];if(g!=null&&!k.disabled&&(!k.constant||Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.countByValueByCustomDatum[g]==null)){var r=d[u];if(r!=null){var a;if(h){a=r}else{a={};if(r instanceof Array){for(var t=0,q=r.length;t<q;++t){if(r[t]!=null&&(r[t].toString().length<=this.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST||k.localOnly)){a[r[t]]=(a[r[t]]||0)+1}}}else{if(r.toString().length<=this.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST||k.localOnly){a[r]=(a[r]||0)+1}}}var w=k.type=="LIST"||k.type=="COUNT_LIST"?v[u]:true;if(w||!Kameleoon.Utils.testEmptyMap(a)){var e=[];for(var y in a){e.push([y,a[y]])}e=Kameleoon.Utils.JSONStringify(e);if(e.length<=this.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST||k.localOnly){x.push(g);c.push(r);b.push(a);n.push(e);p.push(v[u]);o.push(w)}}}}}if(f.length>0){this.LocalDataHandler.registerAction(function(){var P=new Date();if(!this.obtainVisitIsFinished(P)){var B=[];var I=[];var z=[];var A=0;var D=function(){var S="event=customData&indexes="+this.joinAll(B,"-");for(var R=0,i=B.length;R<i;++R){var l=B[R];S+="&countByValue"+l+"="+encodeURIComponent(I[R])+"&overwrite"+l+"="+z[R]}this.sendTrackingRequest(P,S,false)}.bind(this);var J=(["medium","audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0);(!h)&&Kameleoon.Visitor.setupFromStoredData(true);for(var O=0,M=x.length;O<M;++O){var E=x[O];var L=c[O];var j=b[O];var C=n[O];var Q=p[O];var m=o[O];var H=Kameleoon.Internals.runtime.Gatherer.configuration.customData[E];Kameleoon.Visitor.addCustomData(E,j,m);if("PAGE"==this.obtainCorrectedCustomDatumScope(H.scope)){Kameleoon.Internals.runtime.Gatherer.countByValueByCustomDatum[E]=Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.countByValueByCustomDatum[E]}if(!H.localOnly&&J){var F=C.length;if(A+F<=this.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST){B.push(E);I.push(C);z.push(m);A+=F}else{D();B=[E];I=[C];z=[m];A=F}}if(Kameleoon.API.customDatumCallbacks!=null){for(var N=0,K=Kameleoon.API.customDatumCallbacks.length;N<K;++N){try{Kameleoon.API.customDatumCallbacks[N](P,E,L,Q)}catch(G){}}}}(!h)&&Kameleoon.Visitor.saveToStoredData();if(B.length>0){D()}}}.bind(this),(!h)&&Kameleoon.Internals.runtime.Gatherer.customDataUpdateNeedsLocalData,{urgent:true})}},trackTabCount:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addTabCount(a);Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(c,"event=tabCount&tabCount="+a,false)}if(Kameleoon.API.tabCountCallbacks!=null){for(var b=0,e=Kameleoon.API.tabCountCallbacks.length;b<e;++b){try{Kameleoon.API.tabCountCallbacks[b](c,a)}catch(d){}}}}}.bind(this),true,{})},trackProduct:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addProduct(a);Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(c,"event=product&ean="+a,false)}if(Kameleoon.API.productCallbacks!=null){for(var b=0,e=Kameleoon.API.productCallbacks.length;b<e;++b){try{Kameleoon.API.productCallbacks[b](c,a)}catch(d){}}}}}.bind(this),true,{})},trackGeolocation:function(e,c,d,b,f,a){this.LocalDataHandler.registerAction(function(){var h=new Date();if(!this.obtainVisitIsFinished(h)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addGeolocation(e,c,d,b,f,a);Kameleoon.Visitor.saveToStoredData();if((["audience","full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(h,"event=geolocation"+(e!=null?"&country="+e:"")+(c!=null?"&region="+c:"")+(d!=null?"&city="+d:"")+(b!=null?"&postalCode="+b:"")+(f!=null?"&latitude="+f:"")+(a!=null?"&longitude="+a:""),false)}if(Kameleoon.API.geolocationCallbacks!=null){for(var g=0,j=Kameleoon.API.geolocationCallbacks.length;g<j;++g){try{Kameleoon.API.geolocationCallbacks[g](h,e,c,d,b,f,a)}catch(i){}}}}}.bind(this),true,{})},trackNumberClicks:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addNumberClicks(a);Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(c,"event=numberClicks&number="+a,false)}if(Kameleoon.API.numberClicksCallbacks!=null){for(var b=0,e=Kameleoon.API.numberClicksCallbacks.length;b<e;++b){try{Kameleoon.API.numberClicksCallbacks[b](c,a)}catch(d){}}}}}.bind(this),true,{})},trackAdBlocker:function(){this.LocalDataHandler.registerAction(function(){var b=new Date();if(!this.obtainVisitIsFinished(b)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addAdBlocker();Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){this.sendTrackingRequest(b,"event=adBlocker",false)}if(Kameleoon.API.adBlockerCallbacks!=null){for(var a=0,d=Kameleoon.API.adBlockerCallbacks.length;a<d;++a){try{Kameleoon.API.adBlockerCallbacks[a](b)}catch(c){}}}}}.bind(this),true,{})},trackIP:function(a){this.LocalDataHandler.registerAction(function(){var c=new Date();if(!this.obtainVisitIsFinished(c)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addIP(a);Kameleoon.Visitor.saveToStoredData();if(Kameleoon.API.ipCallbacks!=null){for(var b=0,e=Kameleoon.API.ipCallbacks.length;b<e;++b){try{Kameleoon.API.ipCallbacks[b](c,a)}catch(d){}}}}}.bind(this),true,{})},trackExternalSolutionData:function(a,b){this.LocalDataHandler.registerAction(function(){var d=new Date();if(!this.obtainVisitIsFinished(d)){Kameleoon.Visitor.setupFromStoredData(true);Kameleoon.Visitor.addExternalSolutionData(a,b);Kameleoon.Visitor.saveToStoredData();if((["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0)){var g=[];for(var f in b){g.push([f,b[f]])}this.sendTrackingRequest(d,"event=externalSolutionData&externalSolution="+encodeURIComponent(a)+"&valuesByKey="+encodeURIComponent(Kameleoon.Utils.JSONStringify(g)),false)}if(Kameleoon.API.externalSolutionDataCallbacks!=null){for(var c=0,h=Kameleoon.API.externalSolutionDataCallbacks.length;c<h;++c){try{Kameleoon.API.externalSolutionDataCallbacks[c](d,a,b)}catch(e){}}}}}.bind(this),true,{})},trackMentalistPredictionTargeting:function(c,a){var d=[];var k=[];var b=[];for(var j=0,e=c.length;j<e;++j){if(!Kameleoon.Utils.testEmptyMap(a[j])){d.push(c[j]);k.push(a[j]);var f=[];for(var g in a[j]){f.push([parseInt(g),a[j][g]])}b.push(Kameleoon.Utils.JSONStringify(f))}}var h=d.length;if(h>0){this.LocalDataHandler.registerAction(function(){var p=new Date();if(!this.obtainVisitIsFinished(p)){var w=(["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0);for(var v=0;v<h;v+=this.MAX_NUMBER_MENTALIST_PREDICTION_TARGETING_IN_A_REQUEST){var s=Math.min(this.MAX_NUMBER_MENTALIST_PREDICTION_TARGETING_IN_A_REQUEST,h-v);var u=null;if(w){u="event=mentalistPredictionTargeting&number="+s}for(var t=0;t<s;++t){var x=v+t;var l=d[x];var y=k[x];var r=b[x];if(w){u+=("&containerType"+t+"="+(l.experimentContainer?"EXPERIMENT":"PERSONALIZATION")+"&containerId"+t+"="+l.id+"&goalIdToConversionProbabilityAndTargeted"+t+"="+encodeURIComponent(r))}if(Kameleoon.API.mentalistPredictionTargetingCallbacks!=null){for(var q=0,o=Kameleoon.API.mentalistPredictionTargetingCallbacks.length;q<o;++q){try{Kameleoon.API.mentalistPredictionTargetingCallbacks[q](p,l,y)}catch(m){}}}}if(w){this.sendTrackingRequest(p,u,false)}}}}.bind(this),false,{})}},startNewVisit:function(a,b){this.updateIfStartOfVisit(a,false,true,b,function(c){this.LocalDataHandler.registerAction(function(){}.bind(this),true,{urgent:true})}.bind(this))},checkImageList:function(f,d,e){var b=Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout;if(b==null){b=this.IMAGES_DETECTION_DEFAULT_CACHE_TIMEOUT}var a=document.createElement("iframe");a.style.display="none";var c="var cacheTimeout = "+b+";";if(null!=d){a.className="KameleoonInterestDetection"}if(null!=e){a.className="KameleoonImageDetection";c+="var callbackId = "+e+";"}c+="var interestIndex = "+d+";";c+="var images = "+Kameleoon.Utils.JSONStringify(f)+";";c+='var CoreAlgorithm={webkit:function(b){var d;var c=false;var a=function(){window.removeEventListener("message",a,false);d=new Date().getTime();var f=new Image();f.style.display="none";f.style.position="absolute";f.style.left="-9999px";f.style.top="-9999px";f.src=b;var e=function(j){if(c){--window.currentChecks;return}var h=new Date().getTime();var k=h-d;if(f.complete||f.width>0){--window.currentChecks;var g=true;if(/(\.css|\.js|\.swf)/.test(f.src)){g=true}else{if(f.width==0){g=false}}if(g){c=true;if(null!=interestIndex){window.parent.postMessage(JSON.stringify({command:"addKameleoonInterest",index:interestIndex}),"*")}else{window.parent.postMessage(JSON.stringify({command:"imageChecked",value:true,callbackId:callbackId}),"*")}}window.stop();window.stop();delete f;window.removeEventListener("message",e,false)}else{if(h-d>cacheTimeout){--window.currentChecks;if(window.stop!==undefined){window.stop()}else{if(document.execCommand!==undefined){document.execCommand("Stop",false)}}delete f;window.removeEventListener("message",e,false)}else{window.postMessage("toNextMessageInterval","*")}}if(!c&&0==window.currentChecks){if(null!=interestIndex){window.parent.postMessage(JSON.stringify({command:"finishKameleoonInterestCheck",index:interestIndex}),"*")}else{window.parent.postMessage(JSON.stringify({command:"imageChecked",value:false,callbackId:callbackId}),"*")}}};window.addEventListener("message",e,false);window.postMessage("","*")};window.addEventListener("message",a,false);window.postMessage("","*")}};mainCheck=CoreAlgorithm.webkit;window.currentChecks=0;for(var i=0;i<images.length;++i){++window.currentChecks;mainCheck(images[i].url)};';a.src='javascript:\'<!doctype html><html><head><meta charset="utf-8"><style>*{margin:0;padding:0;border:0;}</style></head><body><script>'+c+"<\/script></body></html>'";Kameleoon.Internals.runtime.headNode.appendChild(a)},obtainInterestLastCheckTime:function(a){var b=Kameleoon.Internals.runtime.storedData.Gatherer["interestLastCheckTime-"+a];return null==b?Number.MIN_VALUE:b},sendTrackingRequest:function(a,c,b){Kameleoon.Analyst.validateTrackingRequest(function(){if(this.checkSendTrackingRequestIsSecure()){this.sendDelayedTrackingRequests();this.secureSendTrackingRequest(a,c,b)}else{this.addDelayedTrackingRequest(a,c,b)}}.bind(this))},checkSendTrackingRequestIsSecure:function(){return(typeof document.visibilityState=="undefined")||(document.visibilityState!="prerender")},addDelayedTrackingRequest:function(a,c,b){if(Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters==null){Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters=[]}Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters.push([a,c,b]);if(Kameleoon.Internals.runtime.Gatherer.sendTrackingRequestSecurityCheckIntervalSetup==null){Kameleoon.Utils.setInterval(function(){if(this.checkSendTrackingRequestIsSecure()){this.sendDelayedTrackingRequests()}}.bind(this),this.SEND_TRACKING_REQUEST_SECURITY_CHECK_INTERVAL);Kameleoon.Internals.runtime.Gatherer.sendTrackingRequestSecurityCheckIntervalSetup=true}},sendDelayedTrackingRequests:function(){if(Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters!=null){for(var b=0,a=Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters.length;b<a;++b){var c=Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters[b];this.secureSendTrackingRequest(c[0],c[1],c[2])}Kameleoon.Internals.runtime.Gatherer.delayedSendTrackingRequestParameters=null}},secureSendTrackingRequest:function(a,c,b){this.restoreVisitCookieIfNecessary();if((!Kameleoon.Internals.runtime.simulationMode)&&(!Kameleoon.Internals.runtime.proxyMode)&&(!Kameleoon.Internals.runtime.kameleoonSelectionIframeMode)&&(!window.kameleoonInjector)&&Kameleoon.Internals.runtime.Gatherer.configuration.track&&(!this.obtainFieldFromVisitCookieOrStoredData("untrackedVisit"))){Kameleoon.Utils.performBeaconServerCall("//tlp-"+this.obtainFieldFromVisitCookieOrStoredData("trackerNodeCode")+"."+Kameleoon.Internals.configuration.DOMAIN+"/visit.gif?lp="+this.obtainFieldFromVisitCookieOrStoredData("trackerNodeLogParser")+(b&&Kameleoon.Internals.runtime.Gatherer.scriptProduceTimeSent==null?"&spt="+Kameleoon.Internals.configuration.scriptProduceTime:"")+"&p="+encodeURIComponent(Kameleoon.Utils.encodeString(c+"&siteCode="+Kameleoon.Internals.configuration.siteCode+"&visitorCode="+this.obtainFieldFromVisitCookieOrStoredData("visitorCode")+"&visitNumber="+this.obtainFieldFromVisitCookieOrStoredData("visitNumber")+"&startOfVisit="+(b===true)+"&scriptVersion="+this.SCRIPT_VERSION+"&nonce="+Kameleoon.Utils.obtainRandomString(this.NONCE_BYTE_LENGTH*2,this.HEXADECIMAL_ALPHABET))));if(b){Kameleoon.Internals.runtime.Gatherer.scriptProduceTimeSent=true}}},updateIfStartOfVisit:function(date,callerIsTrackPage,forceStartOfVisit,forceStartOfVisitor,callback){var finalCallback=function(startOfVisit){var trackerNodeCode=this.obtainFieldFromVisitCookieOrStoredData("trackerNodeCode");if(startOfVisit||trackerNodeCode==null||!Kameleoon.Analyst.isValidTrackerNodeCode(trackerNodeCode)){trackerNodeCode=this.obtainTrackerNodeCode(this.obtainFieldFromVisitCookieOrStoredData("visitorCode"),this.obtainFieldFromVisitCookieOrStoredData("visitNumber"));this.saveFieldToVisitCookieOrStoredData("trackerNodeCode",trackerNodeCode)}var trackerNodeLogParser=this.obtainFieldFromVisitCookieOrStoredData("trackerNodeLogParser");if(startOfVisit||trackerNodeLogParser==null||!Kameleoon.Analyst.isValidTrackerNodeLogParser(trackerNodeCode,trackerNodeLogParser)){trackerNodeLogParser=this.obtainTrackerNodeLogParser(this.obtainFieldFromVisitCookieOrStoredData("visitorCode"),this.obtainFieldFromVisitCookieOrStoredData("visitNumber"));this.saveFieldToVisitCookieOrStoredData("trackerNodeLogParser",trackerNodeLogParser)}this.saveVisitCookieIfNecessary();if(startOfVisit){this.inheritVisitorScopeCustomDataAndTrackVisitorDataFromServer();if(Kameleoon.API.startOfVisitCallbacks!=null){for(var k=0,n=Kameleoon.API.startOfVisitCallbacks.length;k<n;++k){try{Kameleoon.API.startOfVisitCallbacks[k](date,visitNumber)}catch(exception){}}}}if(startOfVisit&&Kameleoon.Mentalist!=null&&["full"].indexOf(Kameleoon.Internals.configuration.trackingMode)>=0){var goalIdToConversionProbability=Kameleoon.Mentalist.computeGoalConversionProbabilityPredictionByGoalId(true);if(!Kameleoon.Utils.testEmptyMap(goalIdToConversionProbability)){var goalIdToConversionProbabilityToSend=[];for(var goalId in goalIdToConversionProbability){goalIdToConversionProbabilityToSend.push([parseInt(goalId),goalIdToConversionProbability[goalId]])}goalIdToConversionProbabilityToSend=Kameleoon.Utils.JSONStringify(goalIdToConversionProbabilityToSend);this.sendTrackingRequest(date,"event=mentalistPredictionStartOfVisit&goalIdToConversionProbability="+encodeURIComponent(goalIdToConversionProbabilityToSend),startOfVisit)}}if((Kameleoon.Internals.configuration.segmentUserIdJavaScriptVarPath!=null)&&(window.WebSocket!=null)){var userId;try{userId=eval(Kameleoon.Internals.configuration.segmentUserIdJavaScriptVarPath)}catch(e){userId=null}if(userId!=null&&userId.toString().length==0){userId=null}if((Kameleoon.Internals.runtime.Gatherer.segmentWebSocket!=null)&&(Kameleoon.Internals.runtime.Gatherer.segmentWebSocketUserId!=userId)){try{Kameleoon.Internals.runtime.Gatherer.segmentWebSocket.close()}catch(e){}Kameleoon.Internals.runtime.Gatherer.segmentWebSocket=null;Kameleoon.Internals.runtime.Gatherer.segmentWebSocketUserId=null}if((Kameleoon.Internals.runtime.Gatherer.segmentWebSocket==null)&&(userId!=null)){Kameleoon.Internals.runtime.Gatherer.segmentWebSocket=new WebSocket(("https:"==window.location.protocol?"wss":"ws")+"://api-segment."+Kameleoon.Internals.configuration.DOMAIN+"/segment/"+Kameleoon.Internals.configuration.siteCode+"/"+userId);Kameleoon.Internals.runtime.Gatherer.segmentWebSocket.onmessage=function(event){var segmentDataMap=JSON.parse(event.data);var customDatumIndexesToTrack=[];var customDatumValuesToTrack=[];var customDatumOverwritesIfCollectionToTrack=[];customDataLoop:for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.configuration.customData.length;i<l;++i){var customDatum=Kameleoon.Internals.runtime.Gatherer.configuration.customData[i];if(customDatum!=null&&!customDatum.disabled){var customDatumName=customDatum.name;if(customDatumName=="userId"){customDatumIndexesToTrack.push(i);customDatumValuesToTrack.push(userId);customDatumOverwritesIfCollectionToTrack.push(true)}else{var customDatumNameSplit=customDatumName.split("/");var segmentDataMapPath=segmentDataMap;for(var j=0,m=customDatumNameSplit.length;j<m;++j){segmentDataMapPath=segmentDataMapPath[customDatumNameSplit[j]];if(segmentDataMapPath==null){continue customDataLoop}}customDatumIndexesToTrack.push(i);customDatumValuesToTrack.push(segmentDataMapPath);customDatumOverwritesIfCollectionToTrack.push(true)}}}this.trackCustomData(customDatumIndexesToTrack,customDatumValuesToTrack,customDatumOverwritesIfCollectionToTrack)}.bind(this);Kameleoon.Internals.runtime.Gatherer.segmentWebSocketUserId=userId}}callback&&callback(startOfVisit)}.bind(this);if(forceStartOfVisitor){forceStartOfVisit=true}this.restoreVisitCookieIfNecessary();var visitNumber=this.obtainFieldFromVisitCookieOrStoredData("visitNumber");if(forceStartOfVisit||(visitNumber==null)||this.obtainVisitIsFinished(date)){this.saveFieldToStoredData("startsOfVisitForCurrentPage",this.obtainFieldFromStoredData("startsOfVisitForCurrentPage")+1);var timeSincePreviousVisit;if(forceStartOfVisitor||(visitNumber==null)){timeSincePreviousVisit=0;visitNumber=0}else{timeSincePreviousVisit=date.getTime()-this.obtainFieldFromVisitCookieOrStoredData("timeLastActivity");visitNumber++}this.saveFieldToVisitCookieOrStoredData("storedDataVersion",this.SCRIPT_VERSION);this.saveFieldToVisitCookieOrStoredData("visitNumber",visitNumber);this.saveFieldToVisitCookieOrStoredData("untrackedVisit",Math.random()<Kameleoon.Internals.runtime.Gatherer.configuration.dropRate);this.saveFieldToVisitCookieOrStoredData("timeLastActivity",date.getTime());this.saveFieldToVisitCookieOrStoredData("timeSincePreviousVisit",timeSincePreviousVisit);for(var i=0,l=Kameleoon.Internals.runtime.Gatherer.configuration.customData.length;i<l;++i){var customDatum=Kameleoon.Internals.runtime.Gatherer.configuration.customData[i];if((customDatum!=null)&&customDatum.mappingIdentifier){this.saveFieldToStoredData("visitsRequestSuccess_"+i,null)}}this.saveFieldToStoredData("landingPageHref",Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL());this.saveFieldToStoredData("landingPageTitle",document.title);this.saveFieldToStoredData("landingPages",this.obtainKeyPagesIndexes());this.saveFieldToStoredData("firstReferrerHref",this.obtainCorrectedReferrer(true));this.saveFieldToStoredData("firstReferrers",this.obtainReferrersIndexes(true));if(visitNumber==0){this.saveFieldToVisitCookieOrStoredData("visitorCode",Kameleoon.Utils.obtainRandomString(this.VISITOR_CODE_LENGTH,Kameleoon.Analyst.CODE_ALPHABET));Kameleoon.Visitor.init()}else{Kameleoon.Visitor.setupFromStoredData(false)}var landingPageHref=this.obtainFieldFromStoredData("landingPageHref");var landingPageTitle=this.obtainFieldFromStoredData("landingPageTitle");var landingPages=this.obtainFieldFromStoredData("landingPages")||[null];var firstReferrerHref=this.obtainFieldFromStoredData("firstReferrerHref");var firstReferrers=this.obtainFieldFromStoredData("firstReferrers")||[null];var visit=Kameleoon.Visit.create(Kameleoon.Internals.configuration.trackingMode,Kameleoon.Internals.configuration.siteCode,this.obtainFieldFromVisitCookieOrStoredData("visitorCode"),date,this.obtainFieldFromVisitCookieOrStoredData("timeSincePreviousVisit"),this.obtainFieldFromVisitCookieOrStoredData("visitNumber"),landingPageHref,landingPageTitle,landingPages,firstReferrerHref,firstReferrers,this.obtainTimeZoneGroupsIndexes(),this.obtainLanguageIndex(),this.obtainBrowserIndex(),Kameleoon.Internals.runtime.browserVersion,Kameleoon.Internals.runtime.mobileDevice,this.obtainOSIndex(),this.obtainWindowWidth(),this.obtainWindowHeight(),this.obtainScreenWidth(),this.obtainScreenHeight(),this.obtainJavaEnabled(),this.obtainTimeZoneId(),this.obtainLocaleLanguageTag(),Kameleoon.Internals.runtime.deviceType,this.obtainBrowser(),this.obtainOS());Kameleoon.Visitor.addVisit(visit);if(!callerIsTrackPage){Kameleoon.Visitor.addPage(date,Kameleoon.Utils.computeCurrentPageCanonicalURL()||Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL(),document.title,this.obtainKeyPagesIndexes(),this.obtainReferrersIndexes(true))}Kameleoon.Visitor.saveToStoredData();finalCallback(true)}else{finalCallback(false)}},inheritVisitorScopeCustomDataAndTrackVisitorDataFromServer:function(){this.LocalDataHandler.registerAction(function(){Kameleoon.Visitor.setupFromStoredData(true);if(Kameleoon.Internals.runtime.Visitor.visits.length>1){var a=Kameleoon.Internals.runtime.Visitor.visits[Kameleoon.Internals.runtime.Visitor.visits.length-2];var f=[];var j=[];var g=[];var k=Kameleoon.Internals.runtime.Gatherer.configuration.customData;for(var e=0,b=k.length;e<b;++e){var d=k[e];if(d!=null&&!d.disabled){var c=this.obtainCorrectedCustomDatumScope(d.scope);if("VISITOR"==c){var h=a.wholeVisitHistory.countByValueByCustomDatum[e];if(h!=null){f.push(e);j.push(h);g.push(true)}}}}this.trackCustomData(f,j,g,true);Kameleoon.Visitor.saveToStoredData()}}.bind(this),true,{urgent:true})},obtainCorrectedCustomDatumScope:function(a){if(a==null){a=this.DEFAULT_CUSTOM_DATUM_SCOPE}return a},initializeStoredDataIfNecessary:function(){if(Kameleoon.Internals.runtime.storedData==null){Kameleoon.Internals.runtime.storedData={}}if(Kameleoon.Internals.runtime.storedData.Gatherer==null){Kameleoon.Internals.runtime.storedData.Gatherer={}}if(Kameleoon.Internals.runtime.storedData.Visitor==null){Kameleoon.Internals.runtime.storedData.Visitor={}}},obtainFieldFromStoredData:function(a){return Kameleoon.Internals.runtime.storedData.Gatherer[a]},saveFieldToStoredData:function(a,b){Kameleoon.Internals.runtime.storedData.Gatherer[a]=b},obtainFieldFromVisitCookie:function(a){return Kameleoon.Internals.runtime.Gatherer.visitCookie[a]},saveFieldToVisitCookie:function(a,b){Kameleoon.Internals.runtime.Gatherer.visitCookie[a]=b},restoreVisitCookieIfNecessary:function(){if(!Kameleoon.Internals.configuration.useWideDomainSupport){Kameleoon.Internals.runtime.Gatherer.visitCookie={};var d=(Kameleoon.Internals.runtime.simulationMode&&!Kameleoon.Internals.runtime.newSimulationModeData?Kameleoon.Utils.readLocalData("kameleoonVisitSimulation","COOKIE",false):null)||Kameleoon.Utils.readLocalData("kameleoonVisit","COOKIE",false);if(d!=null){var a=d.split("/");var c=a.length;var b=0;Kameleoon.Internals.runtime.Gatherer.visitCookie.storedDataVersion=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.visitorCode=((c>b)&&(a[b].length>0)?a[b]:null);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.visitNumber=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.timeLastActivity=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.timeSincePreviousVisit=((c>b)&&(a[b].length>0)?parseInt(a[b]):null);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.untrackedVisit=((c>b)&&(a[b].length>0)?(a[b]=="true"):false);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.trackerNodeCode=((c>b)&&(a[b].length>0)?a[b]:null);++b;Kameleoon.Internals.runtime.Gatherer.visitCookie.trackerNodeLogParser=((c>b)&&(a[b].length>0)?parseInt(a[b]):null)}}},saveVisitCookieIfNecessary:function(){if(!Kameleoon.Internals.configuration.useWideDomainSupport){var a="";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.storedDataVersion!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.storedDataVersion}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.visitorCode!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.visitorCode}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.visitNumber!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.visitNumber}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.timeLastActivity!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.timeLastActivity}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.timeSincePreviousVisit!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.timeSincePreviousVisit}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.untrackedVisit===true){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.untrackedVisit}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.trackerNodeCode!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.trackerNodeCode}a+="/";if(Kameleoon.Internals.runtime.Gatherer.visitCookie.trackerNodeLogParser!=null){a+=Kameleoon.Internals.runtime.Gatherer.visitCookie.trackerNodeLogParser}Kameleoon.Utils.createLocalData(Kameleoon.Internals.runtime.simulationMode?"kameleoonVisitSimulation":"kameleoonVisit",a,Kameleoon.Internals.runtime.simulationMode?(1/24):380,null,"COOKIE",false,null)}},obtainFieldFromVisitCookieOrStoredData:function(a){return Kameleoon.Internals.configuration.useWideDomainSupport?this.obtainFieldFromStoredData(a):this.obtainFieldFromVisitCookie(a)},saveFieldToVisitCookieOrStoredData:function(a,b){if(Kameleoon.Internals.configuration.useWideDomainSupport){this.saveFieldToStoredData(a,b)}else{this.saveFieldToVisitCookie(a,b)}},obtainVisitIsFinished:function(a){var b=a.getTime()-Kameleoon.Internals.runtime.Gatherer.configuration.maxVisitIdleDuration;this.restoreVisitCookieIfNecessary();return this.obtainFieldFromVisitCookieOrStoredData("timeLastActivity")<b},obtainTrackerNodeCode:function(b,a){return Kameleoon.Analyst.obtainTrackerNodeCodeDeterministic(b+a)},obtainTrackerNodeLogParser:function(b,a){return Kameleoon.Analyst.obtainTrackerNodeLogParserDeterministic(this.obtainFieldFromVisitCookieOrStoredData("trackerNodeCode"),b+a)},obtainTimeZoneId:function(){return jstz.determine().name()},obtainTimeZoneGroupsIndexes:function(){var b=this.obtainTimeZoneId();var a=[];for(var c=0;c<Kameleoon.Internals.runtime.Gatherer.configuration.timeZoneGroups.length;c++){if((!Kameleoon.Internals.runtime.Gatherer.configuration.timeZoneGroups[c].disabled)&&this.obtainTimeZoneGroupMatches(Kameleoon.Internals.runtime.Gatherer.configuration.timeZoneGroups[c].timeZones,b)){a.push(c)}}if(a.length==0){a.push(null)}return a},obtainTimeZoneGroupMatches:function(d,b){var a=b.toUpperCase();for(var c=0;c<d.length;c++){if(d[c].toUpperCase()==a){return true}}return false},obtainLocaleLanguageTag:function(){var a=null;if(navigator){if(navigator.language){a=navigator.language}else{if(navigator.browserLanguage){a=navigator.browserLanguage}else{if(navigator.systemLanguage){a=navigator.systemLanguage}else{if(navigator.userLanguage){a=navigator.userLanguage}}}}}return a?a:this.DEFAULT_LOCALE_LANGUAGE_TAG},obtainLanguage:function(){var b=this.obtainLocaleLanguageTag();var a=b.indexOf("-");if(a>=0){return b.substring(0,a)}return b},obtainLanguageIndex:function(){var a=this.obtainLanguage().toUpperCase();for(var b=0;b<Kameleoon.Internals.runtime.Gatherer.configuration.languages.length;b++){if((!Kameleoon.Internals.runtime.Gatherer.configuration.languages[b].disabled)&&(Kameleoon.Internals.runtime.Gatherer.configuration.languages[b].code.toUpperCase()==a)){return b}}return null},obtainBrowser:function(){var a=Kameleoon.Internals.runtime.browserName;if(("Internet Explorer"==a)||("Microsoft Edge"==a)){a="Explorer"}return a},obtainBrowserIndex:function(){var c=this.obtainBrowser();if(c==null){return null}var a=c.toUpperCase();for(var b=0;b<Kameleoon.Internals.runtime.Gatherer.configuration.browsers.length;b++){if((!Kameleoon.Internals.runtime.Gatherer.configuration.browsers[b].disabled)&&(Kameleoon.Internals.runtime.Gatherer.configuration.browsers[b].name.toUpperCase()==a)){return b}}return null},obtainOS:function(){if(Kameleoon.Internals.runtime.windowsphone){return"Windows Phone"}if(Kameleoon.Internals.runtime.ios){return"iOS"}if(Kameleoon.Internals.runtime.android){return"Android"}if(Kameleoon.Internals.runtime.windows){return"Windows"}if(Kameleoon.Internals.runtime.mac){return"Mac"}if(Kameleoon.Internals.runtime.linux){return"Linux"}return null},obtainOSIndex:function(){var c=this.obtainOS();if(c==null){return null}var a=c.toUpperCase();for(var b=0;b<Kameleoon.Internals.runtime.Gatherer.configuration.oss.length;b++){if((!Kameleoon.Internals.runtime.Gatherer.configuration.oss[b].disabled)&&(Kameleoon.Internals.runtime.Gatherer.configuration.oss[b].name.toUpperCase()==a)){return b}}return null},obtainReferrer:function(){return document.referrer},obtainCorrectedReferrer:function(a){switch(this.obtainReferrerType(a)){case 0:case 1:case 2:return null;default:return this.obtainReferrer()}},obtainReferrerType:function(b){if(this.obtainReferrerIsIgnored(b)){return 0}var c=this.obtainInternalReferrerType();var a=this.obtainFieldFromStoredData("startsOfVisitForCurrentPage");if((a>1)||((a==1)&&(c>=0))){return 1}if(c>=0){return 2}return 3},obtainReferrerIsIgnored:function(d){var c=this.obtainReferrer();if(Kameleoon.Internals.runtime.Gatherer.configuration.directNoneReferrerOnlyFirst){if((c=="")&&(!d)){return true}}var e=window.location.pathname;var a=Kameleoon.Internals.runtime.Gatherer.configuration.noReferrerPages.length;for(var b=0;b<a;b++){if(e==Kameleoon.Internals.runtime.Gatherer.configuration.noReferrerPages[b]){return true}}return false},obtainInternalReferrerType:function(){var d=this.obtainReferrer();if(d==""){return -1}var e=this.parseHostName(d);var b=Kameleoon.Utils.obtainCurrentRootDomain();if((b!=null)&&this.computeIfSuffix(e,b)){return Kameleoon.Internals.runtime.Gatherer.configuration.aliasSites.length}var a=Kameleoon.Internals.runtime.Gatherer.configuration.aliasSites.length;for(var c=0;c<a;c++){if(this.computeIfSuffix(e,Kameleoon.Internals.runtime.Gatherer.configuration.aliasSites[c])){return c}}return -1},obtainReferrersIndexes:function(e){switch(this.obtainReferrerType(e)){case 0:case 2:return[null];case 1:return[0];default:var d=[];var c=Number.NEGATIVE_INFINITY;for(var b=0;b<Kameleoon.Internals.runtime.Gatherer.configuration.referrers.length;b++){if((!Kameleoon.Internals.runtime.Gatherer.configuration.referrers[b].disabled)&&this.obtainReferrerMatches(Kameleoon.Internals.runtime.Gatherer.configuration.referrers[b])){var a=Kameleoon.Internals.runtime.Gatherer.configuration.referrers[b].priority;if(a==null){a=Number.NEGATIVE_INFINITY}if(a>=c){if(a>c){d=[];c=a}d.push(b+1)}}}if(d.length==0){d.push(null)}return d}},obtainReferrerMatches:function(c){var a=c.detections;for(var b=0;b<a.length;b++){if(this.obtainReferrerDetectionMatches(a[b])){return true}}return false},obtainReferrerDetectionMatches:function(b){var a=this.obtainReferrerDetectionPartMatches(b.method,b.parameters);if(b.and){a=a&&this.obtainReferrerDetectionPartMatches(b.andMethod,b.andParameters)}return a},obtainReferrerDetectionPartMatches:function(method,parameters){switch(method.toUpperCase()){case"REFERRER_REGEX":return new RegExp(parameters).test(this.obtainReferrer());case"URL_REGEX":var regExp=new RegExp(parameters);return regExp.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())||regExp.test(Kameleoon.Utils.computeCurrentPageCleanRelativeURL());default:try{return eval(parameters)===true}catch(error){return false}}},obtainKeyPagesIndexes:function(){var d=[];for(var c=0,a=Kameleoon.Internals.runtime.Gatherer.configuration.keyPages.length;c<a;c++){var e=Kameleoon.Internals.runtime.Gatherer.configuration.keyPages[c];if(!e.disabled){var b=new RegExp(e.relativeURLRegExp);if(b.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())||b.test(Kameleoon.Utils.computeCurrentPageCleanRelativeURL())){d.push(c)}}}if(d.length==0){d.push(null)}return d},obtainKeyWordsIndexes:function(d){var b=[];for(var c=0,a=Kameleoon.Internals.runtime.Gatherer.configuration.keyWords.length;c<a;c++){var e=Kameleoon.Internals.runtime.Gatherer.configuration.keyWords[c];if((!e.disabled)&&(new RegExp(e.wordRegExp,"i").test(d))){b.push(c)}}return b},obtainWindowWidth:function(){var a=null;if(document.body&&document.body.offsetWidth){a=document.body.offsetWidth}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){a=document.documentElement.offsetWidth}if(window.innerWidth){a=window.innerWidth}return a},obtainWindowHeight:function(){var a=null;if(document.body&&document.body.offsetHeight){a=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetHeight){a=document.documentElement.offsetHeight}if(window.innerHeight){a=window.innerHeight}return a},obtainScreenWidth:function(){return window.screen.width},obtainScreenHeight:function(){return window.screen.height},obtainJavaEnabled:function(){return navigator.javaEnabled()===true},obtainCustomDatumValueMap:function(customDataIndex){var customDatumValueMap=null;var customDatum=Kameleoon.Internals.runtime.Gatherer.configuration.customData[customDataIndex];if(customDatum!=null&&!customDatum.disabled){switch(customDatum.method.toUpperCase()){case"GTM":if(window.dataLayer&&customDatum.variableName){for(var i=0,l=dataLayer.length;i<l;++i){var dataLayer_i=dataLayer[i];if(dataLayer_i.hasOwnProperty(customDatum.variableName)){customDatumValueMap={value:dataLayer_i[customDatum.variableName],overwrite:false};break}}}break;case"TC":if(window.tc_vars&&customDatum.variableName){var tc_var=tc_vars[customDatum.variableName];if(""==tc_var){tc_var=null}customDatumValueMap={value:tc_var,overwrite:false}}break;case"TEALIUM":if(window.utag_data&&customDatum.variableName){var utagData=utag_data[customDatum.variableName];if(""==utagData){utagData=null}customDatumValueMap={value:utagData,overwrite:false}}break;case"CUSTOM_CODE":try{customDatumValueMap=eval("(function() {"+customDatum.customEvalCode+"})();");if(customDatumValueMap.overwrite==null){customDatumValueMap.overwrite=false}}catch(error){}break;default:break}}return customDatumValueMap},computeIfSuffix:function(b,c){var a=b.length-c.length;var d=b.lastIndexOf(c,a);return(d>=0)&&(d==a)},joinAll:function(d,c){var a="";if(d.length>0){a+=d[0];for(var b=1;b<d.length;b++){a+=c;a+=d[b]}}return a},parseHostName:function(c){var b=document.createElement("a");b.href=c;return b.hostname},LocalDataHandler:{INTERVAL:1*1000,init:function(){if(Kameleoon.Internals.runtime.Gatherer.LocalDataHandler==null){Kameleoon.Internals.runtime.Gatherer.LocalDataHandler={}}Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.oneShotActions=[];Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.repeatedActions=[];var a=function(){if(Kameleoon.Internals.runtime!=null){var f=new Date().getTime();var e=false;var c=[];for(var d=0,b=Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.oneShotActions.length;d<b;++d){var g=Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.oneShotActions[d];if(g.saveLocalData==true){e=true}c.push(g.actionFunction)}Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.oneShotActions=[];for(var d=0,b=Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.repeatedActions.length;d<b;++d){var g=Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.repeatedActions[d];if(g.lastRunTime+g.repeatInterval<=f){if(g.saveLocalData==true){e=true}c.push(g.actionFunction);g.lastRunTime=f}}this.launchAction(function(){for(var k=0,h=c.length;k<h;++k){try{c[k]()}catch(j){}}}.bind(this),e)}}.bind(this);Kameleoon.Utils.setInterval(a,this.INTERVAL)},registerAction:function(a,b,d){if(d.urgent===true){this.launchAction(a,b)}else{var c=parseInt(d.repeatInterval);if(isNaN(c)){Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.oneShotActions.push({actionFunction:a,saveLocalData:b})}else{if(d.firstRunNow===true){Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.oneShotActions.push({actionFunction:a,saveLocalData:b})}Kameleoon.Internals.runtime.Gatherer.LocalDataHandler.repeatedActions.push({actionFunction:a,saveLocalData:b,repeatInterval:c,lastRunTime:new Date().getTime()})}}},launchAction:function(a,b){a();if(b){Kameleoon.Utils.saveStoredData(null)}}}};Kameleoon.Visitor={STORED_DATA_NAME_PREFIX:"Kameleoon.Visitor.",init:function(){if(Kameleoon.Internals.runtime.Visitor==null){Kameleoon.Internals.runtime.Visitor={}}Kameleoon.Internals.runtime.Visitor.visits=[];Kameleoon.Internals.runtime.Visitor.currentVisit=null;Kameleoon.Internals.runtime.Visitor.totalVisits=0;Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit=null;Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithoutCache=null;Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithCache=null;Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout=null;if(Kameleoon.API==null){Kameleoon.API={}}Kameleoon.API.visits=[];Kameleoon.API.firstVisit=null;Kameleoon.API.currentVisit=null;Kameleoon.API.previousVisit=null;if(Kameleoon.API.visitor==null){Kameleoon.API.visitor={}}Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.runtime.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit;Kameleoon.API.visitor.customData={}},addVisit:function(a){Kameleoon.Internals.runtime.Visitor.visits.push(a);Kameleoon.Internals.runtime.Visitor.currentVisit=a;Kameleoon.Internals.runtime.Visitor.totalVisits++;if(Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit==null){Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit=a.timeStarted}this.updateAPIAfterCurrentVisitChange();Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.runtime.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit;var b=Kameleoon.Internals.runtime.Visitor.visits.length;var c=Math.max(1,Kameleoon.Internals.configuration.maxNumberLocalVisits);if(b>c){Kameleoon.Internals.runtime.Visitor.visits=Kameleoon.Internals.runtime.Visitor.visits.slice(b-c);Kameleoon.API.visits=Kameleoon.API.visits.slice(b-c);Kameleoon.API.firstVisit=Kameleoon.API.visits[0];if(c>1){Kameleoon.API.previousVisit=Kameleoon.API.visits[c-2]}else{Kameleoon.API.previousVisit=null}}},addPreviousVisits:function(g){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){var k=Kameleoon.Internals.runtime.Visitor.currentVisit;var a=[];for(var f=0,e=Kameleoon.Internals.runtime.Visitor.visits.length-1;f<e;++f){a.push(Kameleoon.Internals.runtime.Visitor.visits[f])}for(var f=0,e=g.length;f<e;++f){a.push(g[f])}a.sort(function(l,i){var m=l.timeStarted-i.timeStarted;if(m!=0){return m}m=l.visitorCode-i.visitorCode;if(m!=0){return m}m=l.visitNumber-i.visitNumber;return m});this.init();var b=null;var c=null;for(var f=0,e=a.length;f<e;f++){var d=a[f];var j=d.visitorCode;var h=d.visitNumber;if((j!=b)||(h!=c)){this.addVisit(d)}b=j;c=h}this.addVisit(k)}},saveToStoredData:function(){this.saveFieldToStoredData("visits",Kameleoon.Internals.runtime.Visitor.visits);this.saveFieldToStoredData("totalVisits",Kameleoon.Internals.runtime.Visitor.totalVisits);this.saveFieldToStoredData("timeStartedEldestVisit",Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit);this.saveFieldToStoredData("imagesDetectionTimeWithoutCache",Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithoutCache);this.saveFieldToStoredData("imagesDetectionTimeWithCache",Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithCache);this.saveFieldToStoredData("imagesDetectionCacheTimeout",Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout)},setupFromStoredData:function(l){var g=this.obtainFieldFromStoredData("visits");this.init();if(g==null){if(l){var a=Kameleoon.Gatherer;a.restoreVisitCookieIfNecessary();var f=a.obtainFieldFromStoredData("landingPageHref");var j=a.obtainFieldFromStoredData("landingPageTitle");var c=a.obtainFieldFromStoredData("landingPages")||[null];var b=a.obtainFieldFromStoredData("firstReferrerHref");var k=a.obtainFieldFromStoredData("firstReferrers")||[null];var h=Kameleoon.Visit.create(Kameleoon.Internals.configuration.trackingMode,Kameleoon.Internals.configuration.siteCode,a.obtainFieldFromVisitCookieOrStoredData("visitorCode"),new Date(),a.obtainFieldFromVisitCookieOrStoredData("timeSincePreviousVisit"),a.obtainFieldFromVisitCookieOrStoredData("visitNumber"),f,j,c,b,k,a.obtainTimeZoneGroupsIndexes(),a.obtainLanguageIndex(),a.obtainBrowserIndex(),Kameleoon.Internals.runtime.browserVersion,Kameleoon.Internals.runtime.mobileDevice,a.obtainOSIndex(),a.obtainWindowWidth(),a.obtainWindowHeight(),a.obtainScreenWidth(),a.obtainScreenHeight(),a.obtainJavaEnabled(),a.obtainTimeZoneId(),a.obtainLocaleLanguageTag(),Kameleoon.Internals.runtime.deviceType,a.obtainBrowser(),a.obtainOS());this.addVisit(h)}return l}else{var d=g.length;for(var e=0;e<d;++e){var h=g[e];Kameleoon.Visit.convertVisitFromStoredData(h);this.addVisit(h)}Kameleoon.Internals.runtime.Visitor.totalVisits=this.obtainFieldFromStoredData("totalVisits");Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit=this.obtainFieldFromStoredData("timeStartedEldestVisit");Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithoutCache=this.obtainFieldFromStoredData("imagesDetectionTimeWithoutCache");Kameleoon.Internals.runtime.Visitor.imagesDetectionTimeWithCache=this.obtainFieldFromStoredData("imagesDetectionTimeWithCache");Kameleoon.Internals.runtime.Visitor.imagesDetectionCacheTimeout=this.obtainFieldFromStoredData("imagesDetectionCacheTimeout");Kameleoon.API.visitor.totalVisits=Kameleoon.Internals.runtime.Visitor.totalVisits;Kameleoon.API.visitor.timeStartedEldestVisit=Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit;return false}},obtainFieldFromStoredData:function(a){return Kameleoon.Internals.runtime.storedData.Visitor[a]},saveFieldToStoredData:function(a,b){Kameleoon.Internals.runtime.storedData.Visitor[a]=b},addPage:function(d,c,e,a,b){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addPage(d,c,e,a,b);this.updateAPIAfterCurrentVisitChange()}},addActivity:function(a,b){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addActivity(a,b);this.updateAPIAfterCurrentVisitChange()}},addInterests:function(b,a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addInterests(b,a);this.updateAPIAfterCurrentVisitChange()}},addSearch:function(c,d,b,a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addSearch(c,d,b,a);this.updateAPIAfterCurrentVisitChange()}},addConversion:function(c,a,b){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){if(b){Kameleoon.Internals.runtime.Visitor.currentVisit.addConversions(c,-1,-a)}else{Kameleoon.Internals.runtime.Visitor.currentVisit.addConversions(c,1,a)}this.updateAPIAfterCurrentVisitChange()}},addMentalistAction:function(b,a,c){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addMentalistAction(b,a,c);this.updateAPIAfterCurrentVisitChange()}},addTargetingSegment:function(a,b){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addTargetingSegment(a,b);this.updateAPIAfterCurrentVisitChange()}},addExperiment:function(a,b,d,c){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addExperiment(a,b,d,c);this.updateAPIAfterCurrentVisitChange()}},addPersonalization:function(b,a,d,c){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addPersonalization(b,a,d,c);this.updateAPIAfterCurrentVisitChange()}},addWeather:function(a,c,e,b,g,h,f,d){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addWeather(a,c,e,b,g,h,f,d);this.updateAPIAfterCurrentVisitChange()}},addCustomData:function(b,c,a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addCustomData(b,c,a);this.updateAPIAfterCurrentVisitChange()}},addTabCount:function(a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addTabCount(a);this.updateAPIAfterCurrentVisitChange()}},addProduct:function(a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addProduct(a);this.updateAPIAfterCurrentVisitChange()}},addGeolocation:function(e,c,d,b,f,a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addGeolocation(e,c,d,b,f,a);this.updateAPIAfterCurrentVisitChange()}},addNumberClicks:function(a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addNumberClicks(a);this.updateAPIAfterCurrentVisitChange()}},addAdBlocker:function(){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addAdBlocker();this.updateAPIAfterCurrentVisitChange()}},addIP:function(a){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addIP(a);this.updateAPIAfterCurrentVisitChange()}},addExternalSolutionData:function(a,b){if(Kameleoon.Internals.runtime.Visitor.currentVisit!=null){Kameleoon.Internals.runtime.Visitor.currentVisit.addExternalSolutionData(a,b);this.updateAPIAfterCurrentVisitChange()}},updateAPIAfterCurrentVisitChange:function(){var a=Kameleoon.Internals.runtime.Visitor.visits.length;Kameleoon.API.visits[a-1]=Kameleoon.Internals.runtime.Visitor.currentVisit.buildVisitForAPI();Kameleoon.API.firstVisit=Kameleoon.API.visits[0];Kameleoon.API.currentVisit=Kameleoon.API.visits[a-1];if(Kameleoon.Mentalist!=null){Object.defineProperty(Kameleoon.API.currentVisit,"conversionPredictions",{enumerable:true,get:function(){return Kameleoon.Mentalist.computeGoalConversionProbabilityPredictionByGoalId(false)}});Object.defineProperty(Kameleoon.API.currentVisit,"initialConversionPredictions",{enumerable:true,get:function(){return Kameleoon.Mentalist.computeGoalConversionProbabilityPredictionByGoalId(true)}})}if(a>1){Kameleoon.API.previousVisit=Kameleoon.API.visits[a-2]}Kameleoon.API.visitor.customData={};for(var d in Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.countByValueByCustomDatum){var b=Kameleoon.Internals.runtime.Gatherer.configuration.customData[d];if(b!=null&&!b.disabled){if("VISITOR"==Kameleoon.Gatherer.obtainCorrectedCustomDatumScope(b.scope)){var c=Kameleoon.Internals.runtime.Visitor.currentVisit.wholeVisitHistory.countByValueByCustomDatum[d];switch(b.type){case"LIST":var f=[];for(var e in c){f.push(e)}Kameleoon.API.visitor.customData[b.name]=f;break;case"COUNT_LIST":var g=[];for(var e in c){g.push({value:e,count:c[e]})}Kameleoon.API.visitor.customData[b.name]=g;break;default:Kameleoon.API.visitor.customData[b.name]=Object.keys(c)[0];break}}}}},obtainKeyPageIsVisited:function(c){for(var b=0,a=Kameleoon.Internals.runtime.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.runtime.Visitor.visits[b].obtainKeyPageIsVisited(c)){return true}}return false},obtainKeyWordIsSearched:function(c){for(var b=0,a=Kameleoon.Internals.runtime.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.runtime.Visitor.visits[b].obtainKeyWordIsSearched(c)){return true}}return false},obtainInterestIsActive:function(c){for(var b=0,a=Kameleoon.Internals.runtime.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.runtime.Visitor.visits[b].obtainInterestIsActive(c,null)){return true}}return false},obtainReferrerIsPresent:function(c){for(var b=0,a=Kameleoon.Internals.runtime.Visitor.visits.length;b<a;++b){if(Kameleoon.Internals.runtime.Visitor.visits[b].obtainReferrerIsPresent(c)){return true}}return false},obtainLastVisitWithFreshActiveInterest:function(c){for(var b=Kameleoon.Internals.runtime.Visitor.visits.length-1;b>=0;--b){var a=Kameleoon.Internals.runtime.Visitor.visits[b];if(a.obtainInterestIsActive(c,true)){return a}}return null},obtainNumberConversions:function(c){var a=0;for(var b=Kameleoon.Internals.runtime.Visitor.visits.length-1;b>=0;--b){a+=Kameleoon.Internals.runtime.Visitor.visits[b].obtainNumberConversions(c)}return a},obtainContainerNumberActivations:function(f,n,j,m,q,o,e,h){var c=h?"obtainExperimentNumberActivations":"obtainPersonalizationNumberActivations";var b=Kameleoon.Internals.runtime.Visitor.visits.length;var k=0;if(b>0){if(q){var g=Kameleoon.Internals.runtime.Visitor.visits[b-1][c](f,n,j,m);k+=(e?(g>0?1:0):g)}if(o){for(var d=0,a=b-1;d<a;++d){var p=Kameleoon.Internals.runtime.Visitor.visits[d][c](f,n,j,m);k+=(e?(p>0?1:0):p)}}}return k},obtainPageNumberViews:function(a,g,f,h,k,j){var d=Kameleoon.Internals.runtime.Visitor.visits.length;var c=0;if(d>0){if(k){c+=Kameleoon.Internals.runtime.Visitor.visits[d-1].obtainPageNumberViews(a,g,f,h)}if(j){for(var e=0,b=d-1;e<b;++e){c+=Kameleoon.Internals.runtime.Visitor.visits[e].obtainPageNumberViews(a,g,f,h)}}}return c}};Kameleoon.Visit={create:function(C,l,b,x,c,v,o,u,m,d,a,k,s,A,n,p,g,B,i,r,z,f,t,q,j,y,w){var h={};var e=x.getTime();h.wholeVisitHistory=Kameleoon.VisitHistory.create(e);h.actionsTakenIdsWithMentalistDecision={};h.actionsNotTakenIdsWithMentalistDecision={};h.trackingMode=C;h.siteCode=l;h.visitorCode=b;h.timeStarted=e;h.timeLastActivity=e;h.actionTakenHistoryByActionId={};h.actionNotTakenHistoryByActionId={};h.timeSincePreviousVisit=c;h.visitNumber=v;h.landingPages=m;h.firstReferrers=a;h.timeZoneGroups=k;h.language=s;h.browser=A;h.browserVersion=n;h.mobileBrowser=p;h.os=g;h.windowWidth=B;h.windowHeight=i;h.screenWidth=r;h.screenHeight=z;h.javaEnabled=f;h.timesByTargetingSegmentId={};h.variationIdByExperimentId={};h.mentalistDecisionByExperimentId={};h.timesByVariationIdByExperimentId={};h.variationIdByPersonalizationId={};h.mentalistDecisionByPersonalizationId={};h.timesByVariationIdByPersonalizationId={};h.sunriseTime=null;h.sunsetTime=null;h.weatherCode=null;h.productEansLastPage={};h.productEansAllButLastPages={};h.timeZoneId=t;h.localeLanguageTag=q;h.landingPageHref=o;h.landingPageTitle=u;h.timesByPageHref={};h.pageTitleByHref={};h.firstReferrerHref=d;h.country=null;h.region=null;h.city=null;h.postalCode=null;h.latitude=null;h.longitude=null;h.deviceType=j;h.browserName=y;h.osName=w;h.adBlocker=false;h.ips={};h.valuesByKeyByExternalSolution={};this.createBinds(h);return h},convertVisitFromStoredData:function(d){var c=function(f,e){d[f]=(d[f]===undefined?e:d[f])}.bind(this);c("trackingMode",Kameleoon.Internals.configuration.trackingMode);c("siteCode",Kameleoon.Internals.configuration.siteCode);c("visitorCode","");c("timeStarted",0);c("timeLastActivity",0);c("actionsTakenIdsWithMentalistDecision",{});c("actionsNotTakenIdsWithMentalistDecision",{});Kameleoon.VisitHistory.convertVisitHistoryFromStoredData(d.wholeVisitHistory,d.conversionCountByGoalId,d.revenueCountByGoalId);for(var a in d.actionTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromStoredData(d.actionTakenHistoryByActionId[a],d.conversionCountByGoalId,d.revenueCountByGoalId)}for(var b in d.actionNotTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromStoredData(d.actionNotTakenHistoryByActionId[b],d.conversionCountByGoalId,d.revenueCountByGoalId)}c("timeSincePreviousVisit",0);c("visitNumber",0);c("landingPages",[null]);c("firstReferrers",[null]);c("timeZoneGroups",[null]);c("language",null);c("browser",null);c("browserVersion",null);c("mobileBrowser",false);c("os",null);c("windowWidth",null);c("windowHeight",null);c("screenWidth",null);c("screenHeight",null);c("javaEnabled",false);c("timesByTargetingSegmentId",{});c("variationIdByExperimentId",{});c("mentalistDecisionByExperimentId",{});c("timesByVariationIdByExperimentId",{});c("variationIdByPersonalizationId",{});c("mentalistDecisionByPersonalizationId",{});c("timesByVariationIdByPersonalizationId",{});c("sunriseTime",null);c("sunsetTime",null);c("weatherCode",null);c("productEansLastPage",{});c("productEansAllButLastPages",{});c("timeZoneId","UTC");c("localeLanguageTag","en");c("landingPageHref",null);if(d.landingPageHref==null){c("originalLandingPage",null);d.landingPageHref=d.originalLandingPage;delete (d.originalLandingPage)}c("landingPageTitle",null);c("timesByPageHref",{});c("pageTitleByHref",{});c("firstReferrerHref",null);if(d.firstReferrerHref==null){c("originalReferrer",null);d.firstReferrerHref=d.originalReferrer;delete (d.originalReferrer)}c("country",null);c("region",null);c("city",null);c("postalCode",null);c("latitude",null);c("longitude",null);c("deviceType",null);c("browserName",null);c("osName",null);c("adBlocker",false);c("ips",{});c("valuesByKeyByExternalSolution",{});this.createBinds(d)},convertVisitFromServer:function(a){var q=a.actionsTakenIdsWithMentalistDecision;a.actionsTakenIdsWithMentalistDecision={};for(var k=0,f=q.length;k<f;++k){a.actionsTakenIdsWithMentalistDecision[q[k]]=true}var m=a.actionsNotTakenIdsWithMentalistDecision;a.actionsNotTakenIdsWithMentalistDecision={};for(var k=0,f=m.length;k<f;++k){a.actionsNotTakenIdsWithMentalistDecision[m[k]]=true}Kameleoon.VisitHistory.convertVisitHistoryFromServer(a.wholeVisitHistory);for(var h in a.actionTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromServer(a.actionTakenHistoryByActionId[h])}for(var n in a.actionNotTakenHistoryByActionId){Kameleoon.VisitHistory.convertVisitHistoryFromServer(a.actionNotTakenHistoryByActionId[n])}var j=a.productEansLastPage;a.productEansLastPage={};for(var k=0,f=j.length;k<f;++k){a.productEansLastPage[j[k]]=true}var d=a.productEansAllButLastPages;a.productEansAllButLastPages={};for(var k=0,f=d.length;k<f;++k){a.productEansAllButLastPages[d[k]]=true}var c=a.ips;a.ips={};for(var k=0,f=c.length;k<f;++k){a.ips[c[k]]=true}for(var b in a.valuesByKeyByExternalSolution){var e=a.valuesByKeyByExternalSolution[b];for(var p in e){var g=e[p];var o={};for(var k=0,f=g.length;k<f;++k){o[g[k]]=true}e[p]=o}}this.createBinds(a)},addContainer:function(c,f,i,j,g,h,b,a){if((g[f]===undefined)||(a&&(i!=null)&&(g[f]==null))){g[f]=i;h[f]=j}var e=b[f];if(e==null){e={};b[f]=e}var d=e[i];if(d==null){d=[];e[i]=d}d.push(c.getTime())},computeContainerIsActive:function(a,c,b){return(c===b[a])},computeContainerNumberActivations:function(c,g,d,b,f){var a=f[c];if(a==null){return 0}var e=a[g];if(e==null){return 0}return this.computeObjectNumberPresence(d,b,e)},computeObjectNumberPresence:function(f,c,e){var b=0;for(var g=0,a=e.length;g<a;++g){var d=e[g];if(((f==null)||(d>=f))&&((c==null)||(d<=c))){b++}}return b},createBinds:function(a){a.buildVisitForAPI=function(){var f=Kameleoon.Internals.runtime.Gatherer.configuration;var r=this.wholeVisitHistory;var m={};var k="<OTHER / UNKNOWN>";m.visitorCode=this.visitorCode;m.timeStarted=this.timeStarted;m.timeLastActivity=this.timeLastActivity;m.timeSincePreviousVisit=this.timeSincePreviousVisit;m.visitNumber=this.visitNumber;var y=f.languages[this.language];m.language=(y==null||y.disabled?k:y.code);m.environment={};var I=f.browsers[this.browser];m.environment.browser=(I==null||I.disabled?k:I.name);m.environment.browserVersion=this.browserVersion;m.environment.mobileBrowser=this.mobileBrowser;var j=f.oss[this.os];m.environment.os=(j==null||j.disabled?k:j.name);m.environment.windowWidth=this.windowWidth;m.environment.windowHeight=this.windowHeight;m.environment.screenWidth=this.screenWidth;m.environment.screenHeight=this.screenHeight;m.environment.timeZone=this.timeZoneId;m.acquisition={};m.acquisition.landingPages=[];for(var A=0,z=this.landingPages.length;A<z;A++){var q=this.landingPages[A];var t=f.keyPages[q];m.acquisition.landingPages.push(t==null||t.disabled?k:t.name)}m.acquisition.referrers=[];for(var A=0,z=this.firstReferrers.length;A<z;A++){var G=this.firstReferrers[A];var g;if(G==0){g="<RESTART>"}else{var d=f.referrers[G-1];g=d==null||d.disabled?k:d.name}m.acquisition.referrers.push(g)}m.weather={};m.weather.temperature=r.temperature;m.weather.humidity=r.humidity;m.weather.pressure=r.pressure;m.weather.windSpeed=r.windSpeed;m.weather.cloudiness=r.cloudiness;m.weather.sunrise=(this.sunriseTime==null?null:new Date(this.sunriseTime));m.weather.sunset=(this.sunsetTime==null?null:new Date(this.sunsetTime));m.weather.code=this.weatherCode;m.customData={};for(var u in r.countByValueByCustomDatum){var p=f.customData[u];if(p!=null&&!p.disabled){var J=r.countByValueByCustomDatum[u];switch(p.type){case"LIST":var C=[];for(var x in J){C.push(x)}m.customData[p.name]=C;break;case"COUNT_LIST":var b=[];for(var x in J){b.push({value:x,count:J[x]})}m.customData[p.name]=b;break;default:m.customData[p.name]=Object.keys(J)[0];break}}}m.conversions=[];if(Kameleoon.Internals.configuration.goals!=null){for(var A=0,z=Kameleoon.Internals.configuration.goals.length;A<z;++A){var o=Kameleoon.Internals.configuration.goals[A];var c=r.conversionCountByGoalId[o.id];if((c!=null)&&(c>0)){var E=r.revenueCountByGoalId[o.id];if(E==null){E=0}m.conversions.push({goalName:o.name,goalId:o.id,count:c,revenue:E})}}}m.activeExperiments=[];if(Kameleoon.Internals.runtime.experiments!=null){for(var A=0,z=Kameleoon.Internals.runtime.experiments.length;A<z;++A){var h=Kameleoon.Internals.runtime.experiments[A];var B=h.id;var F=h.registeredVariationId;if((F!=null)&&(F!="none")){var s={id:B,name:h.name,variationId:F};var D=Kameleoon.Analyst.findVariation(F);if(D){s.variationName=D.name}if(this.mentalistDecisionByExperimentId[B]){s.mentalistDecision=true}m.activeExperiments.push(s)}}}m.activePersonalizations=[];if(Kameleoon.Internals.runtime.personalizations!=null){for(var A=0,z=Kameleoon.Internals.runtime.personalizations.length;A<z;++A){var H=Kameleoon.Internals.runtime.personalizations[A];var v=H.id;var F=this.variationIdByPersonalizationId[v];if(null!=F){var s={id:v,name:H.name};if(this.mentalistDecisionByPersonalizationId[v]){s.mentalistDecision=true}m.activePersonalizations.push(s)}}}m.productEansLastPage=[];for(var e in this.productEansLastPage){m.productEansLastPage.push(e)}m.productEansAllButLastPages=[];for(var e in this.productEansAllButLastPages){m.productEansAllButLastPages.push(e)}m.interests=[];for(var w in r.freshByActiveInterest){var n=f.interests[w];if(n!=null&&!n.disabled){m.interests.push(n.name)}}if(this.landingPageHref!=null){m.acquisition.originalLandingPage=this.landingPageHref}if(this.firstReferrerHref!=null){m.acquisition.originalReferrer=this.firstReferrerHref}m.geolocation={};if(this.country!=null){m.geolocation.country=this.country}if(this.region!=null){m.geolocation.region=this.region}if(this.city!=null){m.geolocation.city=this.city}if(this.postalCode!=null){m.geolocation.postalCode=this.postalCode}if(this.latitude!=null){m.geolocation.latitude=this.latitude}if(this.longitude!=null){m.geolocation.longitude=this.longitude}m.pageViews=r.timesStartedPages.length;m.timeSpent=this.timeLastActivity-this.timeStarted;return m};a.addPage=function(e,d,i,b,c){var h=e.getTime();this.addActivity(e,true);this.wholeVisitHistory.addPage(h,b,c);var g=this.timesByPageHref[d];if(g==null){g=[];this.timesByPageHref[d]=g}g.push(h);this.pageTitleByHref[d]=i;for(var f in this.productEansLastPage){this.productEansAllButLastPages[f]=true}this.productEansLastPage={}};a.addActivity=function(b,d){var c=b.getTime();if(d){this.timeLastActivity=c}this.wholeVisitHistory.addActivity(c,d)};a.addInterests=function(c,b){this.wholeVisitHistory.addInterests(c,b)};a.addSearch=function(d,e,c,b){this.addActivity(d,true);this.wholeVisitHistory.addSearch(d.getTime(),e,c,b)};a.addConversions=function(d,c,b){this.wholeVisitHistory.addConversions(d,c,b)};a.addMentalistAction=function(c,b,d){this.privateAddMentalistAction(c,d,this.actionsTakenIdsWithMentalistDecision,this.actionTakenHistoryByActionId);this.privateAddMentalistAction(b,d,this.actionsNotTakenIdsWithMentalistDecision,this.actionNotTakenHistoryByActionId)};a.privateAddMentalistAction=function(f,g,e,b){for(var d=0,c=f.length;d<c;++d){var h=f[d];if((this.actionTakenHistoryByActionId[h]==null)&&(this.actionNotTakenHistoryByActionId[h]==null)){if(g){e[h]=true}b[h]=Kameleoon.VisitHistory.createCopy(this.wholeVisitHistory)}}};a.addTargetingSegment=function(b,d){var c=this.timesByTargetingSegmentId[d];if(c==null){c=[];this.timesByTargetingSegmentId[d]=c}c.push(b.getTime())};a.addExperiment=function(b,c,e,d){Kameleoon.Visit.addContainer(b,c,e,d,this.variationIdByExperimentId,this.mentalistDecisionByExperimentId,this.timesByVariationIdByExperimentId,false)};a.addPersonalization=function(c,b,e,d){Kameleoon.Visit.addContainer(c,b,e,d,this.variationIdByPersonalizationId,this.mentalistDecisionByPersonalizationId,this.timesByVariationIdByPersonalizationId,true)};a.addWeather=function(b,d,f,c,h,i,g,e){this.wholeVisitHistory.addWeather(b,d,f,c,h);if(this.sunriseTime==null){this.sunriseTime=i}if(this.sunsetTime==null){this.sunsetTime=g}if(this.weatherCode==null){this.weatherCode=e}};a.addCustomData=function(c,d,b){this.wholeVisitHistory.addCustomData(c,d,b)};a.addTabCount=function(b){this.wholeVisitHistory.addTabCount(b)};a.addProduct=function(b){this.productEansLastPage[b]=true};a.addGeolocation=function(f,d,e,c,g,b){this.country=f;this.region=d;this.city=e;this.postalCode=c;this.latitude=g;this.longitude=b};a.addNumberClicks=function(b){this.wholeVisitHistory.addNumberClicks(b)};a.addAdBlocker=function(){this.adBlocker=true};a.addIP=function(b){this.ips[b]=true};a.addExternalSolutionData=function(h,j){if(!Kameleoon.Utils.testEmptyMap(j)){var d=this.valuesByKeyByExternalSolution[h];if(d==null){d={};this.valuesByKeyByExternalSolution[h]=d}for(var f in j){var c=j[f];var g=c.length;if(g>0){var b=d[f];if(b==null){b={};d[f]=b}for(var e=0;e<g;++e){b[c[e]]=true}}}}};a.obtainKeyPageIsVisited=function(b){return this.wholeVisitHistory.obtainKeyPageIsVisited(b)};a.obtainKeyWordIsSearched=function(b){return this.wholeVisitHistory.obtainKeyWordIsSearched(b)};a.obtainInterestIsActive=function(c,b){return this.wholeVisitHistory.obtainInterestIsActive(c,b)};a.obtainReferrerIsPresent=function(b){return this.wholeVisitHistory.obtainReferrerIsPresent(b)};a.obtainNumberConversions=function(c){var b=this.wholeVisitHistory.conversionCountByGoalId[c];return(b==null?0:b)};a.obtainMeanPageDuration=function(){var c=new Date();var b=Kameleoon.OnlineMeanAndDeviation.createFromDifferences(this.wholeVisitHistory.timesStartedPages,false,true,true);b.update([c.getTime()-this.wholeVisitHistory.timesStartedPages[this.wholeVisitHistory.timesStartedPages.length-1]]);return b.mean[0]};a.obtainExperimentNumberActivations=function(d,e,c,b){return Kameleoon.Visit.computeContainerNumberActivations(d,e,c,b,this.timesByVariationIdByExperimentId)};a.obtainPersonalizationNumberActivations=function(b,e,d,c){return Kameleoon.Visit.computeContainerNumberActivations(b,e,d,c,this.timesByVariationIdByPersonalizationId)};a.obtainPageNumberViews=function(f,e,d,b){var c=0;for(var h in this.timesByPageHref){if(h!=null){var g=Kameleoon.Utils.computeRelativeURL(h);if(((f==null)||(f.test(h)||f.test(g)))&&((e==null)||((!e.test(h))&&(!e.test(g))))){c+=Kameleoon.Visit.computeObjectNumberPresence(d,b,this.timesByPageHref[h])}}}return c}}};Kameleoon.VisitHistory={create:function(b){var a={};a.timesStartedPages=[];a.timesReferrers=[];a.timesSearches=[];a.keyPages=[];a.searchesNumberResults=[];a.searchesFollowed=[];a.timeLastActivity=b;a.timeLastInactivity=b;a.referrers=[];a.keyWords=[];a.freshByActiveInterest={};a.maxTabCount=null;a.numberClicks=null;a.temperature=null;a.humidity=null;a.pressure=null;a.windSpeed=null;a.cloudiness=null;a.countByValueByCustomDatum={};a.conversionCountByGoalId={};a.revenueCountByGoalId={};this.createBinds(a);return a},createCopy:function(d){var b={};b.timesStartedPages=d.timesStartedPages.slice(0);b.timesReferrers=d.timesReferrers.slice(0);b.timesSearches=d.timesSearches.slice(0);b.keyPages=[];for(var c=0;c<d.keyPages.length;c++){b.keyPages.push(d.keyPages[c].slice(0))}b.searchesNumberResults=d.searchesNumberResults.slice(0);b.searchesFollowed=d.searchesFollowed.slice(0);b.timeLastActivity=d.timeLastActivity;b.timeLastInactivity=d.timeLastInactivity;b.referrers=[];for(var c=0;c<d.referrers.length;c++){b.referrers.push(d.referrers[c].slice(0))}b.keyWords=[];for(var c=0;c<d.keyWords.length;c++){b.keyWords.push(d.keyWords[c].slice(0))}b.freshByActiveInterest={};for(var c in d.freshByActiveInterest){b.freshByActiveInterest[c]=d.freshByActiveInterest[c]}b.maxTabCount=d.maxTabCount;b.numberClicks=d.numberClicks;b.temperature=d.temperature;b.humidity=d.humidity;b.pressure=d.pressure;b.windSpeed=d.windSpeed;b.cloudiness=d.cloudiness;b.countByValueByCustomDatum={};for(var a in d.countByValueByCustomDatum){b.countByValueByCustomDatum[a]={};for(var e in d.countByValueByCustomDatum[a]){b.countByValueByCustomDatum[a][e]=d.countByValueByCustomDatum[a][e]}}b.conversionCountByGoalId={};for(var c in d.conversionCountByGoalId){b.conversionCountByGoalId[c]=d.conversionCountByGoalId[c]}b.revenueCountByGoalId={};for(var c in d.revenueCountByGoalId){b.revenueCountByGoalId[c]=d.revenueCountByGoalId[c]}this.createBinds(b);return b},convertVisitHistoryFromStoredData:function(c,j,d){var g=function(k,i){c[k]=(c[k]===undefined?i:c[k])}.bind(this);g("timesStartedPages",[]);g("timesReferrers",[]);g("timesSearches",[]);g("keyPages",[]);var a=c.timesSearches.length;var b=[];var h=[];for(var f=0;f<a;f++){b[f]=0;h[f]=false}g("searchesNumberResults",b);g("searchesFollowed",h);g("timeLastActivity",0);g("timeLastInactivity",0);g("referrers",[]);g("keyWords",[]);g("freshByActiveInterest",{});g("maxTabCount",null);g("numberClicks",null);g("temperature",null);g("humidity",null);g("pressure",null);g("windSpeed",null);g("cloudiness",null);g("countByValueByCustomDatum",null);if(c.countByValueByCustomDatum==null){c.countByValueByCustomDatum={};g("valueByCustomDatum",{});for(var e in c.valueByCustomDatum){c.countByValueByCustomDatum[e]={};c.countByValueByCustomDatum[e][c.valueByCustomDatum[e]]=1}delete (c.valueByCustomDatum)}g("conversionCountByGoalId",null);if(c.conversionCountByGoalId==null){c.conversionCountByGoalId=j==null?{}:j}g("revenueCountByGoalId",null);if(c.revenueCountByGoalId==null){c.revenueCountByGoalId=d==null?{}:d}this.createBinds(c)},convertVisitHistoryFromServer:function(a){this.createBinds(a)},createBinds:function(a){if(a.numberClicks==0){a.numberClicks=null}a.addPage=function(h,c,d){this.timesStartedPages.push(h);this.keyPages.push(c);var e=[];for(var g=0,b=d.length;g<b;++g){var f=d[g];if(f!=null){e.push(f)}}if(e.length>0){this.timesReferrers.push(h);this.referrers.push(e)}};a.addActivity=function(c,b){if(b){this.timeLastActivity=c}else{this.timeLastInactivity=c}};a.addSearch=function(d,e,c,b){this.timesSearches.push(d);this.keyWords.push(e);this.searchesNumberResults.push(c);this.searchesFollowed.push(b)};a.addConversions=function(h,e,b){var c=this.conversionCountByGoalId[h];if(c==null){c=0}var g=c+e;if(g>0){this.conversionCountByGoalId[h]=g;var d=this.revenueCountByGoalId[h];if(d==null){d=0}var f=d+b;if(f>0){this.revenueCountByGoalId[h]=f}else{delete (this.revenueCountByGoalId[h])}}else{delete (this.conversionCountByGoalId[h]);delete (this.revenueCountByGoalId[h])}};a.addInterests=function(f,d){for(var e=0,c=f.length;e<c;e++){var b=f[e];var g=this.freshByActiveInterest[b];if(g==null){g=false}this.freshByActiveInterest[b]=g||d}};a.addTabCount=function(b){if((this.maxTabCount==null)||(b>this.maxTabCount)){this.maxTabCount=b}};a.addNumberClicks=function(b){if(b>0){if(this.numberClicks==null){this.numberClicks=0}this.numberClicks+=b}};a.addWeather=function(b,d,e,c,f){if(this.temperature==null){this.temperature=b}if(this.humidity==null){this.humidity=d}if(this.pressure==null){this.pressure=e}if(this.windSpeed==null){this.windSpeed=c}if(this.cloudiness==null){this.cloudiness=f}};a.addCustomData=function(c,e,b){if(Kameleoon.Utils.testEmptyMap(e)){if(b){delete (this.countByValueByCustomDatum[c])}}else{if(b||this.countByValueByCustomDatum[c]==null){this.countByValueByCustomDatum[c]={}}for(var d in e){this.countByValueByCustomDatum[c][d]=(this.countByValueByCustomDatum[c][d]||0)+e[d]}}};a.obtainKeyPageIsVisited=function(g){for(var e=0,c=this.keyPages.length;e<c;e++){var f=this.keyPages[e];for(var d=0,b=f.length;d<b;d++){if(g==f[d]){return true}}}return false};a.obtainKeyWordIsSearched=function(g){for(var e=0,c=this.keyWords.length;e<c;e++){var f=this.keyWords[e];for(var d=0,b=f.length;d<b;d++){if(g==f[d]){return true}}}return false};a.obtainInterestIsActive=function(c,b){if(b==null){return this.freshByActiveInterest[c]!=null}return this.freshByActiveInterest[c]==b};a.obtainReferrerIsPresent=function(f){var g=(f==null?null:f+1);for(var e=0,c=this.referrers.length;e<c;e++){var h=this.referrers[e];for(var d=0,b=h.length;d<b;d++){if(h[d]==g){return true}}}return false}}};Kameleoon.OnlineMeanAndDeviation={create:function(c){var a={};a.dimension=c;a.mean=[];a.nbUpdates=[];a.m2=[];a.deviation=[];for(var b=0;b<c;++b){a.mean[b]=0;a.nbUpdates[b]=0;a.m2[b]=0;a.deviation[b]=0}this.createBinds(a);return a},createFromDifferences:function(h,j,f,g){var a=this.create(1);var e=h.length;var c=0;if(c<e){var d=h[c];c++;while(c<e){var b=h[c];c++;var k=b-d;if(((k<0)&&j)||((k==0)&&f)||((k>0)&&g)){a.update([k])}d=b}}return a},createFromValues:function(c){var b=this.create(1);for(var d=0,a=c.length;d<a;d++){b.update([c[d]])}return b},createFromBooleanValues:function(c){var b=this.create(1);for(var d=0,a=c.length;d<a;d++){b.update([c[d]?1:0])}return b},createBinds:function(a){a.update=function(b,d){if(d==null){d=1}if(d>0){for(var c=0;c<this.dimension;++c){if(!isNaN(b[c])&&isFinite(b[c])){var f=this.mean[c]-b[c];var e=this.nbUpdates[c]+d;this.m2[c]=this.m2[c]+f/e*f*this.nbUpdates[c]*d;this.deviation[c]=Math.sqrt(this.m2[c]/e);this.mean[c]=this.mean[c]/e*this.nbUpdates[c]+b[c]/e*d;this.nbUpdates[c]=e}}}}}};
Kameleoon.Internals = {"configuration":{"siteCode":"mrhojfmrlx","memberCode":"0","abtestingSetup":true,"EDITOR_HOST_NAME":"editor","BACK_OFFICE_HOST_NAME":"back-office","STATIC_HOST_NAME":"static","STATIC_DIRECT_HOST_NAME":"static-direct","PROXY_HOST_NAME":"proxy","API_HOST_NAME":"api","DOMAIN":"kameleoon.com","environment":"PRODUCTION","QOOXDOO_ESTIMATED_LOADING_TIME":2000,"SERVER_CALL_ESTIMATED_LOADING_TIME":500,"GUI_ESTIMATED_LOADING_TIME":3000,"BASE_EDITOR_URL":"//static.kameleoon.com/js/editor/","IFRAME_ORIGIN":"https://mrhojfmrlx.kameleoon.eu","variations":[{"name":"Variation 1","id":213750,"builtCssCodeLevel2":"","elementSets":[],"redirections":[{"string":"https://www.captaincontrat.com/categorie/creer-entreprise-en-ligne-b","keepParameters":true}]},{"name":"Variation 1","id":215012,"builtCssCodeLevel2":"","elementSets":[],"redirections":[{"string":"https://www.captaincontrat.com/categorie/creer-entreprise-b"}]},{"name":"Variation 1","id":215057,"builtCssCodeLevel2":"","elementSets":[],"redirections":[{"string":"https://www.captaincontrat.com/document/contrat-commercial-b"}]},{"id":"reference","name":"Reference","builtCssCodeLevel2":"","elementSets":[]}],"experiments":[{"id":73866,"name":"Créa générique","baseURL":"https://www.captaincontrat.com/categorie/creer-entreprise-en-ligne","type":"CLASSIC","variations":[{"name":"Reference","id":"reference","deviation":0.5},{"name":"Variation 1","id":213750,"deviation":0.5,"color":{"code":1,"color":"#00a9dc"}}],"experimentContainer":true,"multiVariateTest":false,"executeCodeForReference":true,"kameleoonTracking":{"mainGoalMasterId":122819,"mainGoalId":124410,"mainGoalName":"Engagement","mainGoal":{"id":124410,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"description":null,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":122819,"experimentId":73866,"selector":null,"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":false,"eulerianEventTracking":false,"webtrendsEventTracking":false,"heatMapEventTracking":false,"kissMetricsEventTracking":false,"piwikEventTracking":false,"crazyEggEventTracking":false,"comScoreEventTracking":false,"reportingScriptEventTracking":false,"automaticallyCreated":true,"active":true,"accessLimiter":null,"scrollTrackingType":null,"scrollTrackingValue":null,"numberName":null}},"goals":[{"id":124410,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"description":null,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":122819,"experimentId":73866,"selector":null,"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":false,"eulerianEventTracking":false,"webtrendsEventTracking":false,"heatMapEventTracking":false,"kissMetricsEventTracking":false,"piwikEventTracking":false,"crazyEggEventTracking":false,"comScoreEventTracking":false,"reportingScriptEventTracking":false,"automaticallyCreated":true,"active":true,"accessLimiter":null,"scrollTrackingType":null,"scrollTrackingValue":null,"numberName":null}],"dateModified":1543507820000,"dateCreated":1542820721000,"dateStatusModified":1543507820000,"targetingSegment":{"id":105043,"name":"Segment for Créa générique","targetingTree":{"targetingCondition":{"type":"PAGE_URL","disabled":false,"weight":1,"value":"https\\://www\\.captaincontrat\\.com/categorie/creer\\-entreprise\\-en\\-ligne/?([\\?#].*)?$","include":true}}}},{"id":74435,"name":"Créa générique SEO","baseURL":"https://www.captaincontrat.com/categorie/creer-entreprise","type":"CLASSIC","variations":[{"name":"Reference","id":"reference","deviation":0.5},{"name":"Variation 1","id":215012,"deviation":0.5,"color":{"code":1,"color":"#00a9dc"}}],"experimentContainer":true,"multiVariateTest":false,"executeCodeForReference":true,"kameleoonTracking":{"mainGoalMasterId":122819,"mainGoalId":124438,"mainGoalName":"Engagement","mainGoal":{"id":124438,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"description":null,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":122819,"experimentId":74435,"selector":null,"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":false,"eulerianEventTracking":false,"webtrendsEventTracking":false,"heatMapEventTracking":false,"kissMetricsEventTracking":false,"piwikEventTracking":false,"crazyEggEventTracking":false,"comScoreEventTracking":false,"reportingScriptEventTracking":false,"automaticallyCreated":true,"active":true,"accessLimiter":null,"scrollTrackingType":null,"scrollTrackingValue":null,"numberName":null}},"goals":[{"id":124438,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"description":null,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":122819,"experimentId":74435,"selector":null,"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":false,"eulerianEventTracking":false,"webtrendsEventTracking":false,"heatMapEventTracking":false,"kissMetricsEventTracking":false,"piwikEventTracking":false,"crazyEggEventTracking":false,"comScoreEventTracking":false,"reportingScriptEventTracking":false,"automaticallyCreated":true,"active":true,"accessLimiter":null,"scrollTrackingType":null,"scrollTrackingValue":null,"numberName":null}],"dateModified":1543508428000,"dateCreated":1543508341000,"dateStatusModified":1543508428000,"targetingSegment":{"id":105045,"name":"Segment for Créa générique SEO","targetingTree":{"targetingCondition":{"type":"PAGE_URL","disabled":false,"weight":1,"value":"https\\://www\\.captaincontrat\\.com/categorie/creer\\-entreprise/?([\\?#].*)?$","include":true}}}},{"id":74450,"name":"Contrats commerciaux","baseURL":"https://www.captaincontrat.com/document/contrat-commercial","type":"CLASSIC","variations":[{"name":"Reference","id":"reference","deviation":0.5},{"name":"Variation 1","id":215057,"deviation":0.5,"color":{"code":1,"color":"#00a9dc"}}],"experimentContainer":true,"multiVariateTest":false,"executeCodeForReference":true,"kameleoonTracking":{"mainGoalMasterId":122819,"mainGoalId":124477,"mainGoalName":"Engagement","mainGoal":{"id":124477,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"description":null,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":122819,"experimentId":74450,"selector":null,"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":false,"eulerianEventTracking":false,"webtrendsEventTracking":false,"heatMapEventTracking":false,"kissMetricsEventTracking":false,"piwikEventTracking":false,"crazyEggEventTracking":false,"comScoreEventTracking":false,"reportingScriptEventTracking":false,"automaticallyCreated":true,"active":true,"accessLimiter":null,"scrollTrackingType":null,"scrollTrackingValue":null,"numberName":null}},"goals":[{"id":124477,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"description":null,"url":null,"matchType":"null","pageViews":null,"timeSpent":null,"mentalistWeight":0.0,"masterGoalId":122819,"experimentId":74450,"selector":null,"category":null,"action":null,"attached":false,"attachedGoalId":null,"attachedGoalName":null,"googleAnalyticsEventTracking":false,"universalAnalyticsEventTracking":false,"atInternetEventTracking":false,"adobeOmnitureEventTracking":false,"eulerianEventTracking":false,"webtrendsEventTracking":false,"heatMapEventTracking":false,"kissMetricsEventTracking":false,"piwikEventTracking":false,"crazyEggEventTracking":false,"comScoreEventTracking":false,"reportingScriptEventTracking":false,"automaticallyCreated":true,"active":true,"accessLimiter":null,"scrollTrackingType":null,"scrollTrackingValue":null,"numberName":null}],"dateModified":1543567239000,"dateCreated":1543567152000,"dateStatusModified":1543567239000,"targetingSegment":{"id":105058,"name":"Segment for Contrats commerciaux","targetingTree":{"targetingCondition":{"type":"PAGE_URL","disabled":false,"weight":1,"value":"https\\://www\\.captaincontrat\\.com/document/contrat\\-commercial/?([\\?#].*)?$","include":true}}}}],"pausedExperiments":[],"personalizations":[],"goals":[{"id":122819,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"mentalistWeight":0.0},{"id":124410,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"mentalistWeight":0.0,"masterGoalId":122819,"masterGoalName":"Engagement","linkedExperimentId":73866},{"id":124438,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"mentalistWeight":0.0,"masterGoalId":122819,"masterGoalName":"Engagement","linkedExperimentId":74435},{"id":124477,"name":"Engagement","type":"ENGAGEMENT","multipleConversions":false,"mentalistWeight":0.0,"masterGoalId":122819,"masterGoalName":"Engagement","linkedExperimentId":74450}],"personalizationsDeviation":0.9,"personalizationSetup":false,"boLocale":"FRENCH","activateFullStory":true,"weather":false,"weatherForecast":false,"weatherHistory":false,"geolocation":false,"ip":false,"checkTestedTrafficActive":true,"anniversaryDay":21,"globalScript":"try {var kameleoonEventsTracker = [];var createEventTracking=function(elements,goal){ var kameleoonEventTrackerCallback=function(){ if(!Kameleoon.Internals.runtime.touchMoveEvent ){ Kameleoon.API.processConversion(goal.id); } }; for (var i=0; i < elements.length; ++i){ Kameleoon.Utils.addEventListener(elements[i], Kameleoon.Internals.runtime.mouseDownEvent, kameleoonEventTrackerCallback, true); } }; var kameleoonIntervalId = Kameleoon.Utils.setInterval(function () { for (var i = kameleoonEventsTracker.length - 1; i >= 0; --i) { var elements = Kameleoon.Utils.querySelectorAll(kameleoonEventsTracker[i].selector); if (elements.length > 0) { createEventTracking(elements, kameleoonEventsTracker[i]); kameleoonEventsTracker.splice(i, 1); } } if (kameleoonEventsTracker.length == 0) { window.clearInterval(kameleoonIntervalId); } }, 250); } catch (exception) { console.log('An error occurred in your custom JavaScript Kameleoon tracking function, please check your code.'); console.log(exception, exception.message); }","maxNumberLocalVisits":25,"staticURL":"//static.kameleoon.com/","kameleoonByteLength":57001,"trackerNodeCodes":["01","02","03","04"],"trackerNodeNumberLogParsers":[6,6,6,6],"trackingMode":"medium","trackerExcludedIPRanges":[],"scriptProduceTime":1543567266260}};
Kameleoon.Internals.configuration.Gatherer = "eyJtYXhWaXNpdElkbGVEdXJhdGlvbiI6MTgwMDAwMCwiZW5hYmxlSW1hZ2VzRGV0ZWN0aW9uQ2FjaGVUaW1lb3V0Q29tcHV0YXRpb24iOmZhbHNlLCJkaXJlY3ROb25lUmVmZXJyZXJPbmx5Rmlyc3QiOmZhbHNlLCJ0cmFjayI6dHJ1ZSwiZHJvcFJhdGUiOjAuMCwiY3VzdG9tU2NyaXB0QmVmb3JlIjoiIiwiaW50ZXJlc3RzIjpbXSwiaW50ZXJlc3RzSW1hZ2VzTGlzdHMiOltdLCJpbnRlcmVzdHNJbWFnZXNMaXN0c0ZpbGVVcmwiOm51bGwsInRpbWVab25lR3JvdXBzIjpbXSwibGFuZ3VhZ2VzIjpbXSwiYnJvd3NlcnMiOlt7Im5hbWUiOiJDSFJPTUUiLCJkaXNhYmxlZCI6ZmFsc2V9LHsibmFtZSI6IkVYUExPUkVSIiwiZGlzYWJsZWQiOmZhbHNlfSx7Im5hbWUiOiJGSVJFRk9YIiwiZGlzYWJsZWQiOmZhbHNlfSx7Im5hbWUiOiJTQUZBUkkiLCJkaXNhYmxlZCI6ZmFsc2V9LHsibmFtZSI6Ik9QRVJBIiwiZGlzYWJsZWQiOmZhbHNlfV0sIm9zcyI6W3sibmFtZSI6IldJTkRPV1MiLCJkaXNhYmxlZCI6ZmFsc2V9LHsibmFtZSI6Ik1BQyIsImRpc2FibGVkIjpmYWxzZX0seyJuYW1lIjoiSU9TIiwiZGlzYWJsZWQiOmZhbHNlfSx7Im5hbWUiOiJMSU5VWCIsImRpc2FibGVkIjpmYWxzZX0seyJuYW1lIjoiQU5EUk9JRCIsImRpc2FibGVkIjpmYWxzZX0seyJuYW1lIjoiV0lORE9XUyBQSE9ORSIsImRpc2FibGVkIjpmYWxzZX1dLCJhbGlhc1NpdGVzIjpbXSwibm9SZWZlcnJlclBhZ2VzIjpbXSwicmVmZXJyZXJzIjpbeyJuYW1lIjoiR29vZ2xlIEFkV29yZHMiLCJ0YWciOiJBZCIsInByaW9yaXR5IjowLCJkZXRlY3Rpb25zIjpbeyJhbmRNZXRob2QiOiIiLCJtZXRob2QiOiJSRUZFUlJFUl9SRUdFWCIsImFuZCI6ZmFsc2UsImFuZFBhcmFtZXRlcnMiOiIiLCJwYXJhbWV0ZXJzIjoiXi4rXFwuZ29vZ2xlKFxcLmNvbT8pP1xcLlteL1xcLl0rL2FjbGsoW1xcPyYjXS4qfCkkIn0seyJhbmRNZXRob2QiOiIiLCJtZXRob2QiOiJVUkxfUkVHRVgiLCJhbmQiOmZhbHNlLCJhbmRQYXJhbWV0ZXJzIjoiIiwicGFyYW1ldGVycyI6IltcXD8mI11nY2xpZD0ifV19LHsibmFtZSI6Ikdvb2dsZSBPcmdhbmljIFNlYXJjaCIsInRhZyI6Ik9yZ2FuaWMgU2VhcmNoIiwicHJpb3JpdHkiOjAsImRldGVjdGlvbnMiOlt7ImFuZE1ldGhvZCI6IiIsIm1ldGhvZCI6IlJFRkVSUkVSX1JFR0VYIiwiYW5kIjpmYWxzZSwiYW5kUGFyYW1ldGVycyI6IiIsInBhcmFtZXRlcnMiOiJeLitcXC5nb29nbGUoXFwuY29tPyk/XFwuW14vXFwuXSsvKD8hYWNsa3xpbWdyZXMpLipbXFw/JiNdcT0uKihbXFw/JiNdLip8KSQifSx7ImFuZE1ldGhvZCI6IiIsIm1ldGhvZCI6IlJFRkVSUkVSX1JFR0VYIiwiYW5kIjpmYWxzZSwiYW5kUGFyYW1ldGVycyI6IiIsInBhcmFtZXRlcnMiOiJeLitcXC5nb29nbGUoXFwuY29tPyk/XFwuW14vXFwuXSsvPyQifV19LHsibmFtZSI6IkJpbmcgT3JnYW5pYyBTZWFyY2giLCJ0YWciOiJPcmdhbmljIFNlYXJjaCIsInByaW9yaXR5IjowLCJkZXRlY3Rpb25zIjpbeyJhbmRNZXRob2QiOiIiLCJtZXRob2QiOiJSRUZFUlJFUl9SRUdFWCIsImFuZCI6ZmFsc2UsImFuZFBhcmFtZXRlcnMiOiIiLCJwYXJhbWV0ZXJzIjoiXi4rXFwuYmluZ1xcLlteL1xcLl0rLy4qW1xcPyYjXXE9LiooW1xcPyYjXS4qfCkkIn1dfSx7Im5hbWUiOiJZYWhvbyBPcmdhbmljIFNlYXJjaCIsInRhZyI6Ik9yZ2FuaWMgU2VhcmNoIiwicHJpb3JpdHkiOjAsImRldGVjdGlvbnMiOlt7ImFuZE1ldGhvZCI6IiIsIm1ldGhvZCI6IlJFRkVSUkVSX1JFR0VYIiwiYW5kIjpmYWxzZSwiYW5kUGFyYW1ldGVycyI6IiIsInBhcmFtZXRlcnMiOiJeLitcXC55YWhvb1xcLlteL1xcLl0rLy4qW1xcPyYjXXA9LiooW1xcPyYjXS4qfCkkIn1dfSx7Im5hbWUiOiJCYWlkdSBPcmdhbmljIFNlYXJjaCIsInRhZyI6Ik9yZ2FuaWMgU2VhcmNoIiwicHJpb3JpdHkiOjAsImRldGVjdGlvbnMiOlt7ImFuZE1ldGhvZCI6IiIsIm1ldGhvZCI6IlJFRkVSUkVSX1JFR0VYIiwiYW5kIjpmYWxzZSwiYW5kUGFyYW1ldGVycyI6IiIsInBhcmFtZXRlcnMiOiJeLitcXC5iYWlkdVxcLlteL1xcLl0rLy4qW1xcPyYjXXdkPS4qKFtcXD8mI10uKnwpJCJ9XX1dLCJrZXlQYWdlcyI6W10sImtleVdvcmRzIjpbXSwiY3VzdG9tRGF0YSI6W119";
!function(a,b){this[a]=b()}("bowser",function(){var e=true;function c(A){function s(J){var I=A.match(J);return(I&&I.length>1&&I[1])||""}function B(J){var I=A.match(J);return(I&&I.length>1&&I[2])||""}var z=s(/(ipod|iphone|ipad)/i).toLowerCase(),j=/like android/i.test(A),F=!j&&/android/i.test(A),x=/nexus\s*[0-6]\s*/i.test(A),G=!x&&/nexus\s*[0-9]+/i.test(A),v=/CrOS/.test(A),w=/silk/i.test(A),D=/sailfish/i.test(A),y=/tizen/i.test(A),i=/(web|hpw)os/i.test(A),r=/windows phone/i.test(A),C=/SamsungBrowser/i.test(A),E=!r&&/windows/i.test(A),o=!z&&!w&&/macintosh/i.test(A),t=!F&&!D&&!y&&!i&&/linux/i.test(A),m=B(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),H=s(/version\/(\d+(\.\d+)?)/i),q=/tablet/i.test(A)&&!/tablet pc/i.test(A),l=!q&&/[^-]mobi/i.test(A),p=/xbox/i.test(A),u;if(/opera/i.test(A)){u={name:"Opera",opera:e,version:H||s(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}}else{if(/opr\/|opios/i.test(A)){u={name:"Opera",opera:e,version:s(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||H}}else{if(/SamsungBrowser/i.test(A)){u={name:"Samsung Internet for Android",samsungBrowser:e,version:H||s(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}}else{if(/coast/i.test(A)){u={name:"Opera Coast",coast:e,version:H||s(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}}else{if(/yabrowser/i.test(A)){u={name:"Yandex Browser",yandexbrowser:e,version:H||s(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}}else{if(/ucbrowser/i.test(A)){u={name:"UC Browser",ucbrowser:e,version:s(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}}else{if(/mxios/i.test(A)){u={name:"Maxthon",maxthon:e,version:s(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}}else{if(/epiphany/i.test(A)){u={name:"Epiphany",epiphany:e,version:s(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}}else{if(/puffin/i.test(A)){u={name:"Puffin",puffin:e,version:s(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}}else{if(/sleipnir/i.test(A)){u={name:"Sleipnir",sleipnir:e,version:s(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}}else{if(/k-meleon/i.test(A)){u={name:"K-Meleon",kMeleon:e,version:s(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}}else{if(r){u={name:"Windows Phone",osname:"Windows Phone",windowsphone:e};if(m){u.msedge=e;u.version=m}else{u.msie=e;u.version=s(/iemobile\/(\d+(\.\d+)?)/i)}}else{if(/msie|trident/i.test(A)){u={name:"Internet Explorer",msie:e,version:s(/(?:msie |rv:)(\d+(\.\d+)?)/i)}}else{if(v){u={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:s(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else{if(/edg([ea]|ios)/i.test(A)){u={name:"Microsoft Edge",msedge:e,version:m}}else{if(/vivaldi/i.test(A)){u={name:"Vivaldi",vivaldi:e,version:s(/vivaldi\/(\d+(\.\d+)?)/i)||H}}else{if(D){u={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:s(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}}else{if(/seamonkey\//i.test(A)){u={name:"SeaMonkey",seamonkey:e,version:s(/seamonkey\/(\d+(\.\d+)?)/i)}}else{if(/firefox|iceweasel|fxios/i.test(A)){u={name:"Firefox",firefox:e,version:s(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)};if(/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(A)){u.firefoxos=e;u.osname="Firefox OS"}}else{if(w){u={name:"Amazon Silk",silk:e,version:s(/silk\/(\d+(\.\d+)?)/i)}}else{if(/phantom/i.test(A)){u={name:"PhantomJS",phantom:e,version:s(/phantomjs\/(\d+(\.\d+)?)/i)}}else{if(/slimerjs/i.test(A)){u={name:"SlimerJS",slimer:e,version:s(/slimerjs\/(\d+(\.\d+)?)/i)}}else{if(/blackberry|\bbb\d+/i.test(A)||/rim\stablet/i.test(A)){u={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:H||s(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}}else{if(i){u={name:"WebOS",osname:"WebOS",webos:e,version:H||s(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)};/touchpad\//i.test(A)&&(u.touchpad=e)}else{if(/bada/i.test(A)){u={name:"Bada",bada:e,version:s(/dolfin\/(\d+(\.\d+)?)/i)}}else{if(y){u={name:"Tizen",osname:"Tizen",tizen:e,version:s(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||H}}else{if(/qupzilla/i.test(A)){u={name:"QupZilla",qupzilla:e,version:s(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||H}}else{if(/chromium/i.test(A)){u={name:"Chromium",chromium:e,version:s(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||H}}else{if(/chrome|crios|crmo/i.test(A)){u={name:"Chrome",chrome:e,version:s(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}}else{if(F){u={name:"Android",version:H}}else{if(/safari|applewebkit/i.test(A)){u={name:"Safari",safari:e};if(H){u.version=H}}else{if(z){u={name:z=="iphone"?"iPhone":z=="ipad"?"iPad":"iPod"};if(H){u.version=H}}else{if(/googlebot/i.test(A)){u={name:"Googlebot",googlebot:e,version:s(/googlebot\/(\d+(\.\d+))/i)||H}}else{u={name:s(/^(.*)\/(.*) /),version:B(/^(.*)\/(.*) /)}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(!u.msedge&&/(apple)?webkit/i.test(A)){if(/(apple)?webkit\/537\.36/i.test(A)){u.name=u.name||"Blink";u.blink=e;u.webkit=e}else{u.name=u.name||"Webkit";u.webkit=e}if(!u.version&&H){u.version=H}}else{if(!u.opera&&/gecko\//i.test(A)){u.name=u.name||"Gecko";u.gecko=e;u.version=u.version||s(/gecko\/(\d+(\.\d+)?)/i)}else{if(u.msedge&&/(apple)?webkit/i.test(A)){if(/(apple)?webkit\/537\.36/i.test(A)){u.webkit=e}}}}if(!u.windowsphone&&!u.msedge&&(F||u.silk)){u.android=e}else{if(!u.windowsphone&&!u.msedge&&z){u[z]=e;u.ios=e}else{if(o){u.mac=e}else{if(p){u.xbox=e}else{if(E){u.windows=e}else{if(t){u.linux=e}}}}}}var k="";if(u.windowsphone){k=s(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i)}else{if(z){k=s(/os (\d+([_\s]\d+)*) like mac os x/i);k=k.replace(/[_\s]/g,".")}else{if(F){k=s(/android[ \/-](\d+(\.\d+)*)/i)}else{if(u.webos){k=s(/(?:web|hpw)os\/(\d+(\.\d+)*)/i)}else{if(u.blackberry){k=s(/rim\stablet\sos\s(\d+(\.\d+)*)/i)}else{if(u.bada){k=s(/bada\/(\d+(\.\d+)*)/i)}else{if(u.tizen){k=s(/tizen[\/\s](\d+(\.\d+)*)/i)}}}}}}}if(k){u.osversion=k}var n=k.split(".")[0];if(q||G||z=="ipad"||(F&&(n==3||(n>=4&&!l)))||u.silk){u.tablet=e}else{if(l||z=="iphone"||z=="ipod"||F||x||u.blackberry||u.webos||u.bada){u.mobile=e}}if(u.msedge||(u.msie&&u.version>=10)||(u.yandexbrowser&&u.version>=15)||(u.vivaldi&&u.version>=1)||(u.chrome&&u.version>=20)||(u.samsungBrowser&&u.version>=4)||(u.firefox&&u.version>=20)||(u.safari&&u.version>=6)||(u.opera&&u.version>=10)||(u.ios&&u.osversion&&u.osversion.split(".")[0]>=6)||(u.blackberry&&u.version>=10.1)||(u.chromium&&u.version>=20)){u.a=e}else{if((u.msie&&u.version<10)||(u.chrome&&u.version<20)||(u.firefox&&u.version<20)||(u.safari&&u.version<6)||(u.opera&&u.version<10)||(u.ios&&u.osversion&&u.osversion.split(".")[0]<6)||(u.chromium&&u.version<20)){u.c=e}else{u.x=e}}return u}var f=c(typeof navigator!=="undefined"?navigator.userAgent||"":"");f.test=function(k){for(var l=0;l<k.length;++l){var j=k[l];if(typeof j==="string"){if(j in f){return true}}}return false};function g(i){return i.split(".").length}function h(k,m){var j=[],l;if(Array.prototype.map){return Array.prototype.map.call(k,m)}for(l=0;l<k.length;l++){j.push(m(k[l]))}return j}function a(i){var j=Math.max(g(i[0]),g(i[1]));var k=h(i,function(l){var m=j-g(l);l=l+new Array(m+1).join(".0");return h(l.split("."),function(n){return new Array(20-n.length).join("0")+n}).reverse()});while(--j>=0){if(k[0][j]>k[1][j]){return 1}else{if(k[0][j]===k[1][j]){if(j===0){return 0}}else{return -1}}}}function d(n,l,k){var m=f;if(typeof l==="string"){k=l;l=void (0)}if(l===void (0)){l=false}if(k){m=c(k)}var i=""+m.version;for(var j in n){if(n.hasOwnProperty(j)){if(m[j]){return a([i,n[j]])<0}}}return l}function b(k,j,i){return !d(k,j,i)}f.isUnsupportedBrowser=d;f.compareVersions=a;f.check=b;f._detect=c;return f});this.Element&&function(a){a.matches=a.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(b){var e=this,c=(e.parentNode||e.document).querySelectorAll(b),d=-1;while(c[++d]&&c[d]!=e){}return !!c[d]}}(Element.prototype);this.Element&&function(a){a.closest=a.closest||function(b){var c=this;while(c&&c.matches&&!c.matches(b)){c=c.parentNode}return c&&c.matches?c:null}}(Element.prototype);if (window.kameleoonLightIframe){if (window.kameleoonExternalIFrameLoadedData) { eval(window.kameleoonExternalIFrameLoadedData); Kameleoon.Analyst.load();}}else{Kameleoon.Analyst.load();}}